(self.webpackChunkkontokorrent=self.webpackChunkkontokorrent||[]).push([[493],{1107:function(e,t,r){"use strict";r.d(t,{Ud:function(){return c}});const n=Symbol("Comlink.proxy"),a=Symbol("Comlink.endpoint"),i=Symbol("Comlink.releaseProxy"),s=Symbol("Comlink.thrown"),o=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>o(e)&&e[n],serialize(e){const{port1:t,port2:r}=new MessageChannel;return l(e,t),[r,[r]]},deserialize:e=>(e.start(),c(e))}],["throw",{canHandle:e=>o(e)&&s in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function l(e,t=self){t.addEventListener("message",(function r(a){if(!a||!a.data)return;const{id:i,type:o,path:u}=Object.assign({path:[]},a.data),c=(a.data.argumentList||[]).map(m);let d;try{const t=u.slice(0,-1).reduce(((e,t)=>e[t]),e),r=u.reduce(((e,t)=>e[t]),e);switch(o){case 0:d=r;break;case 1:t[u.slice(-1)[0]]=m(a.data.value),d=!0;break;case 2:d=r.apply(t,c);break;case 3:d=function(e){return Object.assign(e,{[n]:!0})}(new r(...c));break;case 4:{const{port1:t,port2:r}=new MessageChannel;l(e,r),d=function(e,t){return p.set(e,t),e}(t,[t])}break;case 5:d=void 0}}catch(e){d={value:e,[s]:0}}Promise.resolve(d).catch((e=>({value:e,[s]:0}))).then((e=>{const[n,a]=f(e);t.postMessage(Object.assign(Object.assign({},n),{id:i}),a),5===o&&(t.removeEventListener("message",r),h(t))}))})),t.start&&t.start()}function h(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function c(e,t){return g(e,[],t)}function d(e){if(e)throw new Error("Proxy has been released and is not useable")}function g(e,t=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(r,a){if(d(n),a===i)return()=>v(e,{type:5,path:t.map((e=>e.toString()))}).then((()=>{h(e),n=!0}));if("then"===a){if(0===t.length)return{then:()=>s};const r=v(e,{type:0,path:t.map((e=>e.toString()))}).then(m);return r.then.bind(r)}return g(e,[...t,a])},set(r,a,i){d(n);const[s,o]=f(i);return v(e,{type:1,path:[...t,a].map((e=>e.toString())),value:s},o).then(m)},apply(r,i,s){d(n);const o=t[t.length-1];if(o===a)return v(e,{type:4}).then(m);if("bind"===o)return g(e,t.slice(0,-1));const[u,l]=b(s);return v(e,{type:2,path:t.map((e=>e.toString())),argumentList:u},l).then(m)},construct(r,a){d(n);const[i,s]=b(a);return v(e,{type:3,path:t.map((e=>e.toString())),argumentList:i},s).then(m)}});return s}function b(e){const t=e.map(f);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const p=new WeakMap;function f(e){for(const[t,r]of u)if(r.canHandle(e)){const[n,a]=r.serialize(e);return[{type:3,name:t,value:n},a]}return[{type:0,value:e},p.get(e)||[]]}function m(e){switch(e.type){case 3:return u.get(e.name).deserialize(e.value);case 0:return e.value}}function v(e,t,r){return new Promise((n=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===a&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),r)}))}},3682:function(e,t,r){"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}r.d(t,{Z:function(){return n}})},3752:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(4327),a=r(3682);function i(e){(0,a.Z)(1,arguments);var t=(0,n.Z)(e);return t.setHours(23,59,59,999),t}},443:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9429),a=r(3682);function i(e,t){(0,a.Z)(2,arguments);var r=(0,n.Z)(e),i=(0,n.Z)(t);return r.getTime()===i.getTime()}},9429:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(4327),a=r(3682);function i(e){(0,a.Z)(1,arguments);var t=(0,n.Z)(e);return t.setHours(0,0,0,0),t}},4327:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(3682);function a(e){(0,n.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}},7464:function(e,t,r){"use strict";r.r(t),r.d(t,{BezahlungPage:function(){return c}});var n=r(4973),a=r.n(n),i=r(9773),s=r(426),o=r(7426),u=r(2204),l=r(2293),h=r(7030);class c extends HTMLElement{constructor(){super(),this.betreffVorschlagDebouncer=new h.d,this.dataLoaded=!1,this.innerHTML=a(),this.zurueckLink=this.querySelector("#zurueck-zum-kontokorrent"),this.appBar=this.querySelector(s.W),this.bezahlungEintragenForm=this.querySelector(l.R),this.bezahlungNichtGefundenError=this.querySelector("#bezahlung-nicht-gefunden-error"),this.bezahlungZwischengespeichertError=this.querySelector("#bezahlung-zwischengespeichert-error"),this.bezahlungGeloeschtError=this.querySelector("#bezahlung-geloescht-error"),this.bezahlungBearbeitetError=this.querySelector("#bezahlung-bearbeitet-error"),this.updateButton=this.querySelector("#bezahlung__update"),this.deleteButton=this.querySelector("#bezahlung__delete"),this.editingSection=this.querySelector("#bezahlung__edit"),this.updatingSection=this.querySelector("#bezahlung__updating"),this.deletingSection=this.querySelector("#bezahlung__deleting"),this.updateError=this.querySelector("#update-error"),this.deleteError=this.querySelector("#delete-error")}addServices(e){this.store=e.store,this.routingActionCreator=(0,i.b)(e),this.bezahlungActionCreator=(0,o.xN)(e),this.appBar.addServices(e)}connectedCallback(){this.kontokorrentsSubscription=this.store.subscribe("kontokorrents",(e=>this.applyStoreState(e))),this.beschreibungVorschlagSubscription=this.store.subscribe("beschreibungVorschlaege",(e=>this.beschreibungVorschlaegeChanged(e))),this.appBar.addEventListener("gotokontokorrent",(e=>{this.routingActionCreator.navigateKontokorrent(e.detail)})),(0,u.G)([this.zurueckLink],this.routingActionCreator),this.beschreibungVorschlaegeChanged(this.store.state),this.bezahlungEintragenForm.addEventListener("betreffChanged",(e=>this.betreffChanged(e.detail))),this.updateDialog=this.querySelector("#update-dialog"),this.deleteDialog=this.querySelector("#delete-dialog"),this.querySelector("#bezahlung__update").addEventListener("click",(e=>{this.bezahlungEintragenForm.validate()?this.updateDialog.show():this.formContainer.scrollTop=0,e.stopPropagation()})),this.querySelector("#confirm-update").addEventListener("click",(async()=>{this.updateDialog.hide();let e=this.bezahlungEintragenForm.getData();await this.bezahlungActionCreator.bezahlungBearbeiten(this.kontokorrentIdParameter,this.bezahlungIdParameter,e),this.routingActionCreator.navigateKontokorrent(this.kontokorrentIdParameter)})),this.querySelector("#abort-update").addEventListener("click",(()=>{this.updateDialog.hide()})),this.querySelector("#bezahlung__delete").addEventListener("click",(e=>{this.deleteDialog.show(),e.stopPropagation()})),this.querySelector("#confirm-delete").addEventListener("click",(async()=>{this.deleteDialog.hide(),await this.bezahlungActionCreator.bezahlungLoeschen(this.kontokorrentIdParameter,this.bezahlungIdParameter),this.routingActionCreator.navigateKontokorrent(this.kontokorrentIdParameter)})),this.querySelector("#abort-delete").addEventListener("click",(()=>{this.deleteDialog.hide()}))}async betreffChanged(e){try{await this.betreffVorschlagDebouncer.trigger(200)}catch(e){}await this.bezahlungActionCreator.getBeschreibungVorschlaege(this.kontokorrentIdParameter,e)}beschreibungVorschlaegeChanged(e){var t;(null===(t=e.beschreibungVorschlaege)||void 0===t?void 0:t.kontokorrentId)==this.kontokorrentIdParameter?this.bezahlungEintragenForm.beschreibungVorschlaege=e.beschreibungVorschlaege.vorschlaege.slice(0,10):this.bezahlungEintragenForm.beschreibungVorschlaege=[]}applyStoreState(e){let t=!1,r=!1,n=!1,a=!1,i=!1;if(this.kontokorrentIdParameter&&this.bezahlungIdParameter){let s=e.kontokorrents.kontokorrents[this.kontokorrentIdParameter];if(s){this.bezahlungEintragenForm.personen=s.personen;let e=s.angezeigteBezahlung[this.bezahlungIdParameter];e&&(this.bezahlungNichtGefundenError.hidden=0!=e.bearbeitungsStatus,this.bezahlungZwischengespeichertError.hidden=1!=e.bearbeitungsStatus,this.bezahlungGeloeschtError.hidden=3!=e.bearbeitungsStatus,this.bezahlungBearbeitetError.hidden=2!=e.bearbeitungsStatus,t=4==e.bearbeitungsStatus,r=0==e.updateStatus,a=2==e.updateStatus,n=0==e.deleteStatus,i=2==e.deleteStatus);let o=s.bezahlungen.find((e=>e.id==this.bezahlungIdParameter));s.personen&&s.personen.length>0&&o&&!this.dataLoaded&&(this.dataLoaded=!0,this.bezahlungEintragenForm.setData(o))}}this.updateButton.style.visibility=t?"visible":"collapse",this.deleteButton.style.visibility=t?"visible":"collapse",this.updatingSection.style.display=r?"":"none",this.deletingSection.style.display=n?"":"none",this.editingSection.style.display=r||n?"none":"",this.bezahlungEintragenForm.style.display=t?"":"none",this.updateError.hidden=!a,this.deleteError.hidden=!i}setRouteParameters(e,t){this.kontokorrentIdParameter=e,this.bezahlungIdParameter=t,this.zurueckLink.href=`kontokorrents/${e}`,this.bezahlungActionCreator.bezahlungGeoeffnet(e,t)}disconnectedCallback(){this.kontokorrentsSubscription(),this.beschreibungVorschlagSubscription()}}customElements.define("bezahlung-page",c)},7030:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});class n{constructor(){}timeout(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}aborter(){let e={aborted:!1,promise:null},t=new Promise(((t,r)=>{this.abort=()=>{e.aborted=!1,r()}}));return e.promise=t,e}async trigger(e){this.abort&&this.abort();let t=this.aborter();try{await Promise.race([this.timeout(e),t.promise])}catch(e){throw new Error("aborted")}}}},3753:function(e,t,r){"use strict";r(2109)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},4973:function(e){e.exports='<app-bar></app-bar> <div id="bezahlung__edit" class="bezahlung__edit"> <div class="bezahlung-page-menu"> <a id="zurueck-zum-kontokorrent" class="button"> <span class="material-icons"> arrow_back </span> zurück </a> <button class="button" title="speichern" id="bezahlung__delete"> <span class="material-icons"> delete </span> löschen </button> <button class="button" title="speichern" id="bezahlung__update"> <span class="material-icons"> save </span> speichern </button> </div> <div class="bezahlung__form-container" id="bezahlung__form-container"> <div id="update-error" class="alert alert--error" hidden> Zahlung konnte nicht bearbeitet werden. </div> <div id="delete-error" class="alert alert--error" hidden> Zahlung konnte nicht bearbeitet werden. </div> <div id="bezahlung-nicht-gefunden-error" class="alert alert--error" hidden> Zahlung konnte nicht gefunden werden. </div> <div id="bezahlung-zwischengespeichert-error" class="alert alert--error" hidden> Zahlung kann nicht geöffnet werden, weil sie noch synchronisiert wird. </div> <div id="bezahlung-geloescht-error" class="alert alert--error" hidden> Zahlung kann nicht verändert werden, weil sie gelöscht wurde. </div> <div id="bezahlung-bearbeitet-error" class="alert alert--error" hidden> Zahlung kann nicht verändert werden, weil sie bereits bearbeitet wurde. </div> <bezahlung-eintragen-form> </bezahlung-eintragen-form> </div> </div> <div class="bezahlung__progress" id="bezahlung__updating"> <span class="spinner"></span> <span>wird gespeichert</span> </div> <div class="bezahlung__progress" id="bezahlung__deleting"> <span class="spinner"></span> <span>wird gelöscht</span> </div> <app-popup id="update-dialog"> <div class="dialog__backdrop"></div> <div class="dialog"> <p> Geänderte Bezahlung speichern? </p> <div class="dialog__button-pane"> <button id="abort-update" class="button">Abbrechen</button> <button id="confirm-update" class="button">Speichern</button> </div> </div> </app-popup> <app-popup id="delete-dialog"> <div class="dialog__backdrop"></div> <div class="dialog"> <p> Bezahlung löschen? </p> <div class="dialog__button-pane"> <button id="abort-delete" class="button">Abbrechen</button> <button id="confirm-delete" class="button">Löschen</button> </div> </div> </app-popup>'}}]);
//# sourceMappingURL=c078ef1dee43c5c4a1ac.bundle.js.map