(self.webpackChunkkontokorrent=self.webpackChunkkontokorrent||[]).push([[259],{8766:t=>{t.exports='<div class="login-error-box"> <div id="eventMissingError" class="alert alert--error" style="display:none">Kontokorrentnamen eingeben</div> <div id="notFoundError" class="alert alert--error" style="display:none">Kontokorrent wurde nicht gefunden</div> <div id="account-creation-failed" class="alert alert--error" style="display:none">Account konnte nicht erstellt werden</div> </div> <div class="login-box" id="login-box"> <div class="login-box__event-input"> <input type="text" id="eventInput" placeholder="Kontokorrentname"> <tip-button popup-id="oeffentlicherNameExplainer" title="öffentlicher Name Erklärung"> <span class="material-icons"> info </span> </tip-button> <app-popup id="oeffentlicherNameExplainer" class="tip tip--with-input"> Gib hier den Namen des öffentlichen Kontokorrents ein. <ul> <li>frag die anderen Event-/Gruppen- Teilnehmer nach dem Namen</li> <li>such in eurem Chat</li> <li>oder lass dir einen Einladungslink schicken</li> </ul> </app-popup> </div> <div> <button id="loginButton" class="button button--raised login-box__login-button"> Login </button> <div id="processing" class="login-box__processing" style="display:none"> <span class="spinner"></span> </div> </div> <a id="createEventButton" class="button" href="create-event"> <span class="material-icons"> add </span> Gruppe erstellen </a> <a id="home-button" class="button" href=""> <span class="material-icons"> home </span> zurück </a> </div>'},1560:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Login:()=>h});var i=n(8766),o=n.n(i),s=n(9445),r=n(6699),c=n(6928);n(4414);const a="popup-id";class l extends HTMLElement{constructor(){super(),this.clickListener=this.clickListener.bind(this)}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.popupId=this.getAttribute(a)}static get observedAttributes(){return[a]}connectedCallback(){this.addEventListener("click",this.clickListener)}clickListener(t){document.querySelector(`#${this.popupId}`).toggle(),t.stopPropagation()}disconnectedCallback(){this.removeEventListener("click",this.clickListener)}}customElements.define("tip-button",l);var u=n(364);class h extends HTMLElement{constructor(){super(),this.innerHTML=o()}addServices(t){this.store=t.store,this.routingActionCreator=(0,s.b)(t),this.accountActionCreator=(0,c.gg)(t),this.kontokorrentHinzufuegenActionCreator=(0,u.Jj)(t)}connectedCallback(){let t=this;(0,r.G)(t.querySelectorAll("a"),this.routingActionCreator),this.eventInput=t.querySelector("#eventInput"),this.loginButton=t.querySelector("#loginButton"),this.homeButton=t.querySelector("#home-button"),this.loginBox=t.querySelector("#login-box"),this.eventMissingError=t.querySelector("#eventMissingError"),this.accountCreationFailed=t.querySelector("#account-creation-failed"),this.notFoundError=t.querySelector("#notFoundError"),this.processing=t.querySelector("#processing"),this.loginButton.addEventListener("click",this.loginFuerEvent.bind(this)),this.subscription=this.store.subscribe(null,(t=>this.applyStoreState(t))),this.applyStoreState(this.store.state),this.accountActionCreator.initializeAccount(),this.kontokorrentHinzufuegenActionCreator.loginPageGeoeffnet()}loginFuerEvent(){return t=this,e=void 0,i=function*(){let t=this.eventInput.value;if(this.eventMissingError.style.display=t?"none":"block",t&&(yield this.accountActionCreator.ensureAccount())){let e=yield this.kontokorrentHinzufuegenActionCreator.kontokorrentHinzufuegen(t);e&&this.routingActionCreator.navigateKontokorrent(e)}},new((n=void 0)||(n=Promise))((function(o,s){function r(t){try{a(i.next(t))}catch(t){s(t)}}function c(t){try{a(i.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}applyStoreState(t){this.accountCreationFailed.style.display=!t.account.accountCreating&&t.account.accountCreationFailed?"block":"none",this.notFoundError.style.display=!t.kontokorrents.hinzufuegen&&t.kontokorrents.hinzufuegenFailed&&t.kontokorrents.hinzufuegenFailed.kontokorrentNotFound?"block":"none";let e=t.kontokorrents.hinzufuegen||t.account.accountCreating;this.processing.style.display=e?"flex":"none",this.homeButton.style.visibility=t.account.accountCreated&&Object.keys(t.kontokorrents.kontokorrents).length?"visible":"hidden",this.loginButton.style.display=e?"none":"inline-flex"}disconnectedCallback(){this.subscription()}}customElements.define("app-login",h)},6699:(t,e,n)=>{"use strict";function i(t,e){t.forEach((t=>{t.addEventListener("click",(n=>{n.preventDefault(),e.navigate(t.getAttribute("href"))}))}))}n.d(e,{G:()=>i})},4414:(t,e,n)=>{"use strict";class i extends HTMLElement{constructor(){super(),this.popupShown=!1,this.keyListener=this.keyListener.bind(this),this.clickListener=this.clickListener.bind(this)}connectedCallback(){this.updateStyles()}keyListener(t){"Escape"==t.key&&this.hide()}clickListener(t){this.contains(event.target)||this.hide()}hide(){this.popupShown&&(document.removeEventListener("keydown",this.keyListener),document.removeEventListener("click",this.clickListener),this.popupShown=!1,this.updateStyles())}show(){this.popupShown||(document.addEventListener("keydown",this.keyListener),document.addEventListener("click",this.clickListener),this.popupShown=!0,this.updateStyles())}updateStyles(){this.style.display=this.popupShown?"block":"none"}toggle(){this.popupShown?this.hide():this.show()}disconnectedCallback(){this.hide()}}customElements.define("app-popup",i)},364:(t,e,n)=>{"use strict";n.d(e,{Jj:()=>p});var i=n(4586),o=function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{a(i.next(t))}catch(t){s(t)}}function c(t){try{a(i.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((i=i.apply(t,e||[])).next())}))};class s{constructor(t){this.exists=t,this.type=7}}class r{constructor(){this.type=8}}class c{constructor(t){this.kontokorrent=t,this.type=21}}class a{constructor(t){this.notFound=t,this.type=9}}class l{constructor(){this.type=10}}class u{constructor(t){this.kontokorrents=t,this.type=20}}class h{constructor(){this.type=18}}class d{constructor(t,e,n){this.store=t,this.apiClient=e,this.db=n}loginPageGeoeffnet(){this.store.dispatch(new h)}kontokorrentErstellen(t,e,n,a){return o(this,void 0,void 0,(function*(){let o={name:e,id:t,oeffentlicherName:n,personen:a.map((t=>({name:t,id:(0,i.Z)()})))};this.store.dispatch(new r);let l=yield this.apiClient.neuerKontokorrent(o);return l.success?(yield this.db.addKontokorrent({id:t,name:e,personen:o.personen,oeffentlicherName:n}),this.store.dispatch(new c({id:t,name:e,personen:o.personen,oeffentlicherName:n})),!0):(this.store.dispatch(new s(l.exists)),!1)}))}kontokorrentHinzufuegen(t){return o(this,void 0,void 0,(function*(){let e=yield this.db.getPerOeffentlichName(t);if(null!=e)return e.id;this.store.dispatch(new l);try{let e=yield this.apiClient.kontokorrentHinzufuegen(t,null);if(null!=e){let t=yield this.db.setKontokorrents(e.map((t=>({id:t.id,name:t.name,personen:t.personen,oeffentlicherName:t.oeffentlicherName}))));return this.store.dispatch(new u(e)),t[0]}this.store.dispatch(new a(!0))}catch(t){this.store.dispatch(new a(!1))}return!1}))}}function p(t){return t.get("KontokorrentHinzufuegenActionCreator",(t=>new d(t.store,t.apiClient,t.db)))}}}]);
//# sourceMappingURL=69f671b230c52504b30e.bundle.js.map