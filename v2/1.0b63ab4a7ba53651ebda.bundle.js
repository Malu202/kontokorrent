(self.webpackJsonp=self.webpackJsonp||[]).push([[1],Array(27).concat([function(e,t,n){"use strict";function a(e,t){e.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),t.navigate(e.getAttribute("href"))})})}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(e,t,n){this.listElement=e,this.keySelector=t,this.createElement=n,this.keyToElement=new Map,this.elementToKey=new WeakMap}update(e,t){let n=new Map,a=e=>n.get(e)||(()=>{let t=this.keySelector(e);return n.set(e,t),t})();for(let n of Array.from(this.listElement.children)){let r=n,s=e.find(e=>this.elementToKey.get(r)==a(e));s?t(r,s):this.listElement.removeChild(r)}let r=null,s=new Map;for(let n of e){let e=a(n),i=this.keyToElement.get(e);i||(i=this.createElement(n),t(i,n),this.elementToKey.set(i,e)),s.set(e,i),null==r&&i!=this.listElement.firstElementChild?this.listElement.prepend(i):null!=r&&r.nextElementSibling!=i&&r.insertAdjacentElement("afterend",i),r=i}this.keyToElement=s}}},function(e,t,n){"use strict";class a extends HTMLElement{constructor(){super(),this.popupShown=!1,this.keyListener=this.keyListener.bind(this),this.clickListener=this.clickListener.bind(this)}connectedCallback(){this.updateStyles()}keyListener(e){"Escape"==e.key&&this.hide()}clickListener(e){this.contains(event.target)||this.hide()}hide(){this.popupShown&&(document.removeEventListener("keydown",this.keyListener),document.removeEventListener("click",this.clickListener),this.popupShown=!1,this.updateStyles())}show(){this.popupShown||(document.addEventListener("keydown",this.keyListener),document.addEventListener("click",this.clickListener),this.popupShown=!0,this.updateStyles())}updateStyles(){this.style.display=this.popupShown?"block":"none"}toggle(){this.popupShown?this.hide():this.show()}disconnectedCallback(){this.hide()}}customElements.define("app-popup",a)},function(e,t){e.exports='<header class=app-bar> <kontokorrent-select class=app-bar__kontokorrent-select></kontokorrent-select> <nav class=app-bar__links> <button id=logout-button class=app-bar__link title=Logout> <span class=material-icons> exit_to_app </span> </button> <a href=info class=app-bar__link title="Informationen über diese App"> <span class=material-icons> info </span> </a> </nav> </header> <app-popup id=logout-dialog> <div class=dialog__backdrop></div> <div class=dialog> <p> Wirklich aus allen Kontokorrents ausloggen? </p> <div class=dialog__button-pane> <button id=abort-logout class=button>Abbrechen</button> <button id=confirm-logout class=button>Ausloggen</button> </div> </div> </app-popup>'},function(e,t,n){},function(e,t,n){},function(e,t){e.exports='<div class=kontokorrent-select-wrapper> <div class=kontokorrent-select> <h1 data-ref=kontokorrent-name class=kontokorrent-select__name>Kontokorrent</h1> <button class=kontokorrent-select__choose title="anderen Kontokorrent wählen"> <span class=material-icons> arrow_drop_down </span> </button> </div> <app-popup class=kontokorrent-select__popup> <kontokorrent-select-list></kontokorrent-select-list> <div class=kontokorrent-select__buttons> <button id=add-kontokorrent class=button>weiteren hinzufügen</button> </div> </app-popup> </div>'},function(e,t,n){},function(e,t){e.exports="<ol data-ref=list class=kontokorrent-select-list> </ol>"},function(e,t,n){},function(e,t){e.exports="<a data-ref=link class=kontokorrent-select-list__entry> <span data-ref=name></span> </a>"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(30),r=n.n(a),s=(n(31),n(32),n(27)),i=n(33),o=n.n(i),l=(n(34),n(35)),c=n.n(l),h=(n(36),n(2)),u=n(28),d=n(37),p=n.n(d);class b extends HTMLElement{constructor(){super(),this.innerHTML=p.a,this.name=this.querySelector('[data-ref="name"]'),this.link=this.querySelector('[data-ref="link"]'),this.clickEvent=this.clickEvent.bind(this)}connectedCallback(){this.link.addEventListener("click",this.clickEvent)}clickEvent(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("gotokontokorrent",{detail:this.kontokorrent.id,bubbles:!0}))}disconnectedCallback(){this.link.removeEventListener("click",this.clickEvent)}update(e,t){this.kontokorrent=e,this.name.innerText=e.name,this.link.href="kontokorrents/"+e.id,this.link.classList.toggle("kontokorrent-select-list__entry--active",t)}}customElements.define("kontokorrent-select-list-entry",b);class k extends HTMLElement{constructor(){super(),this.innerHTML=c.a,this.list=this.querySelector('[data-ref="list"]'),this._kontokorrents=[],this.kontokorrentsRenderer=new u.a(this.list,e=>e.id,()=>{let e=document.createElement("li");return e.appendChild(new b),e})}connectedCallback(){}disconnectedCallback(){}update(){this.kontokorrentsRenderer.update(this._kontokorrents,(e,t)=>{e.firstChild.update(t,this._activeKontokorrentId==t.id)})}set kontokorrents(e){this._kontokorrents=Object(h.a)(e,e=>e.name),this.update()}set activeKontokorrentId(e){this._activeKontokorrentId=e,this.update()}}customElements.define("kontokorrent-select-list",k);n(29);class g extends HTMLElement{constructor(){super(),this.innerHTML=o.a,this.kontokorrentName=this.querySelector('[data-ref="kontokorrent-name"]'),this.kontokorrentSelectList=this.querySelector("kontokorrent-select-list"),this.addButton=this.querySelector("#add-kontokorrent"),this._kontokorrents=null}connectedCallback(){this.popup=this.querySelector("app-popup"),this.updateAttributes(),this.addEventListener("click",e=>{this.popup.contains(event.target)||(this.popup.toggle(),e.stopPropagation())}),this.addButton.addEventListener("click",e=>{this.dispatchEvent(new CustomEvent("addkontokorrent"))}),this.kontokorrentSelectList.addEventListener("gotokontokorrent",()=>{this.popup.hide()})}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.activeKontokorrentId=this.getAttribute("active-kontokorrent-id"),this.kontokorrentSelectList.activeKontokorrentId=this.activeKontokorrentId,this.updatesStyle()}static get observedAttributes(){return["active-kontokorrent-id"]}set kontokorrents(e){this.kontokorrentSelectList.kontokorrents=e,this._kontokorrents=e,this.updatesStyle()}updatesStyle(){if(this._kontokorrents&&this._kontokorrents.length){let e=this._kontokorrents.find(e=>e.id==this.activeKontokorrentId);this.kontokorrentName.innerText=e?e.name:"(Kontokorrent wählen)"}}}customElements.define("kontokorrent-select",g);var m=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};class f extends HTMLElement{constructor(){super(),this.innerHTML=r.a,this.kontokorrentSelect=this.querySelector("kontokorrent-select"),this.logoutDialog=this.querySelector("#logout-dialog")}connectedCallback(){document.body.classList.add("body--app-bar"),this.querySelector("#logout-button").addEventListener("click",e=>{this.logoutDialog.toggle(),e.stopPropagation()}),this.querySelector("#confirm-logout").addEventListener("click",()=>m(this,void 0,void 0,(function*(){yield this.accountActionCreator.logout()}))),this.querySelector("#abort-logout").addEventListener("click",()=>{this.logoutDialog.hide()}),Object(s.a)(this.querySelectorAll("a"),this.routingActionCreator),this.subscription=this.store.subscribe(null,e=>this.applyStoreState(e)),this.applyStoreState(this.store.state),this.kontokorrentSelect.addEventListener("addkontokorrent",()=>{this.routingActionCreator.navigateLogin()}),this.kontokorrentSelect.addEventListener("gotokontokorrent",e=>{this.routingActionCreator.navigateKontokorrent(e.detail)})}applyStoreState(e){this.kontokorrentSelect.kontokorrents=Object.values(e.kontokorrents.kontokorrents),this.kontokorrentSelect.setAttribute("active-kontokorrent-id",e.kontokorrents.activeKontokorrentId)}addServices(e){this.store=e.store,this.routingActionCreator=e.routingActionCreator,this.accountActionCreator=e.accountActionCreator,this.kontokorrentsActionCreator=e.kontokorrentsActionCreator}disconnectedCallback(){document.body.classList.remove("body--app-bar"),this.subscription()}}const v="app-bar";customElements.define(v,f)},,,,,,,function(e,t){e.exports='<app-bar></app-bar> <div style=display:none id=login-expired>Google-Login abgelaufen: zum Synchronisieren neu anmelden</div> <balance-anzeige id=balance-anzeige></balance-anzeige> <div class=kontokorrentpage-menu> <a id=eintragen-desktop class="floating-action-button floating-action-button--embed"> <span class=material-icons> add </span> eintragen </a> <span class=kontokorrentpage-menu__sync-display id=spinner style=display:none> <div class=spinner></div> synchronisieren </span> </div> <bezahlungen-view id=bezahlungen-view></bezahlungen-view> <a id=eintragen-mobile class="floating-action-button floating-action-button--fixed"> <span class=material-icons> add </span> eintragen </a>'},function(e,t){e.exports="<div class=balance-anzeige-element__graphic-container> <div class=balance-anzeige-element__bar data-ref=bar></div> <div class=balance-anzeige-element__horizontal-line></div> <span class=balance-anzeige-element__balance data-ref=balance-container> <span data-ref=balance-text></span>€ </span> </div> <div class=balance-anzeige-element__text-container> <span data-ref=person-name class=balance-anzeige-element__name></span> </div>"},function(e,t,n){},function(e,t){e.exports="<div class=balance-anzeige-element__graphic-container> <div class=balance-anzeige-element__bar data-ref=bar></div> <div class=balance-anzeige-element__horizontal-line></div> <span class=balance-anzeige-element__balance data-ref=balance-container> <span data-ref=balance-text></span>€ </span> </div> <div class=balance-anzeige-element__text-container> <span data-ref=person-name class=balance-anzeige-element__name></span> </div>"},function(e,t){e.exports="<div id=bezahlungen-container> </div> <button id=show-more class=button>Mehr anzeigen</button>"},function(e,t,n){},function(e,t){e.exports="<div class=bezahlung-card__beschreibung> <div data-ref=beschreibung></div> <div class=bezahlung-card__personen> <span data-ref=bezahlende-person></span> für <span data-ref=empfaenger></span> </div> </div> <div class=bezahlung-card__wert> <span data-ref=wert></span>€ </div>"},function(e,t,n){},function(e,t){e.exports="<h3 data-ref=title class=bezahlungen-group__title>Gruppe</h3> <div class=bezahlungen-group__container data-ref=container></div>"},function(e,t,n){},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"KontokorrentPage",(function(){return x}));var a=n(45),r=n.n(a),s=n(38),i=n(46),o=n.n(i);n(47);function l(e){var t,n,a,r,s,i=""+(t=2,n=e.toString(),a=n.indexOf("E"),r=n.indexOf("e"),s=0,r>-1?(s=parseFloat(n.substring(r+1)),n=n.substring(0,r)):a>-1&&(s=parseFloat(n.substring(a+1)),n=n.substring(0,a)),Number(Math.round(Number(n+"e"+(s+t)))+"e-"+t)),o=i.toString().indexOf(".");return-1!=o&&1==i.toString().length-(o+1)&&(i+="0"),i}class c extends HTMLElement{constructor(){super(),this.innerHTML=o.a,this.personNameElement=this.querySelector('[data-ref="person-name"]'),this.balanceTextElement=this.querySelector('[data-ref="balance-text"]'),this.balanceContainerElement=this.querySelector('[data-ref="balance-container"]'),this.barElement=this.querySelector('[data-ref="bar"]')}connectedCallback(){requestAnimationFrame(()=>{this.barElement.style.transform="scaleY(0)",this.updatesStyle()})}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.personName=this.getAttribute("person-name"),this.balance=parseFloat(this.getAttribute("balance")),this.balanceRange=Math.max(2,parseFloat(this.getAttribute("balance-range"))),this.updatesStyle()}static get observedAttributes(){return["person-name","balance","balance-range"]}updatesStyle(){requestAnimationFrame(()=>{this.personNameElement.innerText=this.personName,this.balanceTextElement.innerText=l(this.balance);let e=Math.sign(this.balance)*Math.abs(this.balance)/this.balanceRange,t=1.9*e;this.barElement.style.transform=`scaleY(${e})`,this.balanceContainerElement.style.transform=Math.sign(this.balance)<0?`translateY(calc(${t}em - 150%))`:`translateY(calc(${t}em + 50%))`,e>0?(this.barElement.classList.add("balance-anzeige-element__bar--negative"),this.barElement.classList.remove("balance-anzeige-element__bar--positive")):(this.barElement.classList.remove("balance-anzeige-element__bar--negative"),this.barElement.classList.add("balance-anzeige-element__bar--positive"))})}}customElements.define("balance-anzeige-element",c);var h=n(48),u=n.n(h),d=n(28);class p extends HTMLElement{constructor(){super(),this.innerHTML=u.a,this.personenRenderer=new d.a(this,e=>e.id,e=>new c)}connectedCallback(){}disconnectedCallback(){}setBalance(e){this.personen=e,this.balanceRange=Math.max(...Object.values(e).map(e=>Math.abs(e.balance))),this.updatesStyle()}updatesStyle(){this.personenRenderer.update(this.personen,(e,t)=>{e.setAttribute("person-name",t.name),e.setAttribute("balance",""+t.balance),e.setAttribute("balance-range",""+this.balanceRange)})}}customElements.define("balance-anzeige",p);var b=n(49),k=n.n(b),g=(n(50),n(51)),m=n.n(g);n(52);class f extends HTMLElement{constructor(){super(),this.attributeStore={beschreibung:null,bezahlendePerson:null,empfaenger:null,wert:null},this.innerHTML=m.a,this.beschreibungElement=this.querySelector('[data-ref="beschreibung"]'),this.bezahlendePersonElement=this.querySelector('[data-ref="bezahlende-person"]'),this.empfaengerElement=this.querySelector('[data-ref="empfaenger"]'),this.wertElement=this.querySelector('[data-ref="wert"]')}connectedCallback(){}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}checkChanged(e,t){let n=t();return this.attributeStore[e]!=n&&(this.attributeStore[e]=n,!0)}updateAttributes(){[this.checkChanged("bezahlendePerson",()=>this.getAttribute("bezahlende-person")),this.checkChanged("beschreibung",()=>this.getAttribute("beschreibung")),this.checkChanged("wert",()=>parseFloat(this.getAttribute("wert"))),this.checkChanged("empfaenger",()=>this.getAttribute("empfaenger"))].some(e=>e)&&this.updatesStyle()}static get observedAttributes(){return["beschreibung","bezahlende-person","wert","empfaenger"]}updatesStyle(){this.beschreibungElement.innerText=this.attributeStore.beschreibung,this.bezahlendePersonElement.innerText=this.attributeStore.bezahlendePerson,this.wertElement.innerText=l(this.attributeStore.wert),this.empfaengerElement.innerText=this.attributeStore.empfaenger}}function v(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function y(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function w(e){y(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function E(e){y(1,arguments);var t=w(e);return t.setHours(0,0,0,0),t}function S(e,t){y(1,arguments);var n=t||{},a=n.locale,r=a&&a.options&&a.options.weekStartsOn,s=null==r?0:v(r),i=null==n.weekStartsOn?s:v(n.weekStartsOn);if(!(i>=0&&i<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var o=w(e),l=o.getDay(),c=(l<i?7:0)+l-i;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function _(e,t){const n=new Map;return e.forEach(e=>{const a=e[t],r=n.get(a);r?r.push(e):n.set(a,[e])}),n}customElements.define("bezahlung-card",f);var z=n(53),C=n.n(z);class L extends HTMLElement{constructor(){super(),this.innerHTML=C.a,this.container=this.querySelector('[data-ref="container"]'),this.titleElement=this.querySelector('[data-ref="title"]'),this.bezahlungenRenderer=new d.a(this.container,e=>e.id,e=>new f)}connectedCallback(){}disconnectedCallback(){}setBezahlungen(e){this.bezahlungenRenderer.update(e,(e,t)=>{e.setAttribute("beschreibung",t.beschreibung),e.setAttribute("wert",""+t.wert),e.setAttribute("bezahlende-person",t.bezahlendePersonName),e.setAttribute("empfaenger",t.empfaenger)})}set title(e){this.titleElement.innerText=e}}customElements.define("bezahlungen-group",L);class A extends HTMLElement{constructor(){super(),this.minTage=3,this.minEintraege=20,this.all=!1,this.innerHTML=k.a,this.bezahlungenContainer=this.querySelector("#bezahlungen-container"),this.showMoreButton=this.querySelector("#show-more"),this.showMoreClick=this.showMoreClick.bind(this),this.groupRenderer=new d.a(this.bezahlungenContainer,e=>""+e[0],()=>new L)}connectedCallback(){this.showMoreButton.addEventListener("click",this.showMoreClick)}disconnectedCallback(){}setShowMoreButtonDisplay(){this.bezahlungen&&(this.showMoreButton.style.display=this.bezahlungen.length>this.anzahlEintraege?"inline":"none")}showMoreClick(){let e=this.bezahlungenContainer.lastElementChild;this.anzahlEintraege+=20,e&&e.scrollIntoView(),this.setShowMoreButtonDisplay()}formatEmpfaenger(e,t){return e.empfaengerIds.length==t.length?"alle":e.empfaengerIds.map(e=>t.find(t=>t.id==e).name).join(", ")}setBezahlungen(e,t){this.bezahlungen=e,this.personen=t,this.setShowMoreButtonDisplay(),this.render()}render(){let e=this.bezahlungen.sort((e,t)=>+t.zeitpunkt-+e.zeitpunkt),t=e;this.all||(t=e.filter(e=>e.zeitpunkt>function(e,t){y(2,arguments);var n=w(e),a=v(t);return isNaN(a)?new Date(NaN):a?(n.setDate(n.getDate()+a),n):n}(E(Date.now()),-this.minTage)),t.length<this.minEintraege&&(t=e.slice(0,this.minEintraege)));let n=t.map(e=>({bezahlendePersonName:this.personen.find(t=>t.id==e.bezahlendePersonId).name,wert:e.wert,beschreibung:e.beschreibung,empfaenger:this.formatEmpfaenger(e,this.personen),tag:+E(e.zeitpunkt),id:e.id,woche:+S(e.zeitpunkt)})),a=!1,r=Array.of(..._(n,"tag").entries());r.reduce((e,t)=>e+t[1].length,0)/r.length<3&&(r=Array.of(..._(n,"woche").entries()),a=!0);let s=r.sort((e,t)=>t[0]-e[0]);this.groupRenderer.update(s,(e,t)=>{e.setBezahlungen(t[1]),e.title=a?this.formatWeek(new Date(t[0])):this.formatDay(new Date(t[0]))})}get anzahlEintraege(){return this.minEintraege}set anzahlEintraege(e){this.minEintraege=e,this.render()}formatWeek(e){let t,n=function(e,t){y(1,arguments);var n=t||{},a=n.locale,r=a&&a.options&&a.options.weekStartsOn,s=null==r?0:v(r),i=null==n.weekStartsOn?s:v(n.weekStartsOn);if(!(i>=0&&i<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var o=w(e),l=o.getDay(),c=6+(l<i?-7:0)-(l-i);return o.setDate(o.getDate()+c),o.setHours(23,59,59,999),o}(e);const a=e=>new Intl.DateTimeFormat(["de-AT"],{day:"numeric",month:"long"}).format(e);return t=n.getMonth()==e.getMonth()?`${new Intl.DateTimeFormat(["de-AT"],{day:"numeric"}).format(e)}. - ${a(n)}`:`${a(e)} - ${a(n)}`,t}formatDay(e){return new Intl.DateTimeFormat(["de-AT"],{weekday:"short",year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}customElements.define("bezahlungen-view",A);n(54);class x extends HTMLElement{constructor(){super(),this.innerHTML=r.a,this.appBar=this.querySelector(s.a),this.balanceAnzeige=this.querySelector("#balance-anzeige"),this.bezahlungenView=this.querySelector("#bezahlungen-view"),this.kontokorrentSpinner=this.querySelector("#spinner")}addServices(e){this.store=e.store,this.routingActionCreator=e.routingActionCreator,this.accountActionCreator=e.accountActionCreator,this.kontokorrentsActionCreator=e.kontokorrentsActionCreator,this.appBar.addServices(e)}connectedCallback(){this.subscription=this.store.subscribe(null,e=>this.applyStoreState(e))}applyStoreState(e){this.kontokorrent=e.kontokorrents.kontokorrents[e.kontokorrents.activeKontokorrentId],this.kontokorrent&&(document.title=this.kontokorrent.name+" - Kontokorrent",this.kontokorrent.personen&&(this.balanceAnzeige.setBalance(this.kontokorrent.personen),this.bezahlungenView.setBezahlungen(this.kontokorrent.bezahlungen,this.kontokorrent.personen)),this.kontokorrentSpinner.style.display=this.kontokorrent.synchronisieren?"flex":"none")}setKontokorrentId(e){this.kontokorrentsActionCreator.kontokorrentOeffnen(e)}disconnectedCallback(){this.subscription()}}customElements.define("kontokorrent-page",x)}])]);
//# sourceMappingURL=1.0b63ab4a7ba53651ebda.bundle.js.map