(()=>{var e={7675:(e,t,n)=>{"use strict";var r=n(3832).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},6956:(e,t,n)=>{var r=n(2521);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},9729:(e,t,n)=>{var r=n(9969),o=n(8331),a=n(1588),i=function(e){return function(t,n,i){var s,c=r(t),u=o(c.length),l=a(i,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},2849:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},4488:(e,t,n)=>{var r=n(2766),o=n(9593),a=n(8769),i=n(7455);e.exports=function(e,t){for(var n=o(t),s=i.f,c=a.f,u=0;u<n.length;u++){var l=n[u];r(e,l)||s(e,l,c(t,l))}}},1471:(e,t,n)=>{var r=n(7703),o=n(7455),a=n(5938);e.exports=r?function(e,t,n){return o.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},5938:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7703:(e,t,n)=>{var r=n(2763);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},6004:(e,t,n)=>{var r=n(6121),o=n(2521),a=r.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},4731:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},7309:(e,t,n)=>{var r=n(6121),o=n(8769).f,a=n(1471),i=n(2327),s=n(6565),c=n(4488),u=n(676);e.exports=function(e,t){var n,l,f,d,h,p=e.target,g=e.global,w=e.stat;if(n=g?r:w?r[p]||s(p,{}):(r[p]||{}).prototype)for(l in t){if(d=t[l],f=e.noTargetGet?(h=o(n,l))&&h.value:n[l],!u(g?l:p+(w?".":"#")+l,e.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(e.sham||f&&f.sham)&&a(d,"sham",!0),i(n,l,d,e)}}},2763:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},1325:(e,t,n)=>{"use strict";n.r(t),n(8494),e=n.hmd(e),n(8775);var r=n(2327),o=n(2763),a=n(1386),i=n(3546),s=n(1471),c=a("species"),u=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),l="$0"==="a".replace(/./,"$0"),f=a("replace"),d=!!/./[f]&&""===/./[f]("a","$0"),h=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,f){var p=a(e),g=!o((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),w=g&&!o((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!g||!w||"replace"===e&&(!u||!l||d)||"split"===e&&!h){var y=/./[p],v=n(p,""[e],(function(e,t,n,r,o){return t.exec===i?g&&!o?{done:!0,value:y.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),m=v[0],k=v[1];r(String.prototype,e,m),r(RegExp.prototype,p,2==t?function(e,t){return k.call(e,this,t)}:function(e){return k.call(e,this)})}f&&s(RegExp.prototype[p],"sham",!0)}},7642:(e,t,n)=>{var r=n(1035),o=n(6121),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(r[e])||a(o[e]):r[e]&&r[e][t]||o[e]&&o[e][t]}},6121:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2766:e=>{var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},2048:e=>{e.exports={}},7226:(e,t,n)=>{var r=n(7703),o=n(2763),a=n(6004);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},3169:(e,t,n)=>{var r=n(2763),o=n(2849),a="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?a.call(e,""):Object(e)}:Object},9835:(e,t,n)=>{var r=n(4682),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return o.call(e)}),e.exports=r.inspectSource},2995:(e,t,n)=>{var r,o,a,i=n(5546),s=n(6121),c=n(2521),u=n(1471),l=n(2766),f=n(4682),d=n(2562),h=n(2048),p=s.WeakMap;if(i){var g=f.state||(f.state=new p),w=g.get,y=g.has,v=g.set;r=function(e,t){return t.facade=e,v.call(g,e,t),t},o=function(e){return w.call(g,e)||{}},a=function(e){return y.call(g,e)}}else{var m=d("state");h[m]=!0,r=function(e,t){return t.facade=e,u(e,m,t),t},o=function(e){return l(e,m)?e[m]:{}},a=function(e){return l(e,m)}}e.exports={set:r,get:o,has:a,enforce:function(e){return a(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},676:(e,t,n)=>{"use strict";n.r(t),n(8494),e=n.hmd(e);var r=n(2763),o=/#|\.prototype\./,a=function(e,t){var n=s[i(e)];return n==u||n!=c&&("function"==typeof t?r(t):!!t)},i=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},s=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},2521:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},8451:e=>{e.exports=!1},4020:(e,t,n)=>{var r=n(2763);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},5546:(e,t,n)=>{var r=n(6121),o=n(9835),a=r.WeakMap;e.exports="function"==typeof a&&/native code/.test(o(a))},7455:(e,t,n)=>{var r=n(7703),o=n(7226),a=n(6956),i=n(687),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(a(e),t=i(t,!0),a(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},8769:(e,t,n)=>{var r=n(7703),o=n(7751),a=n(5938),i=n(9969),s=n(687),c=n(2766),u=n(7226),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=i(e),t=s(t,!0),u)try{return l(e,t)}catch(e){}if(c(e,t))return a(!o.f.call(e,t),e[t])}},2042:(e,t,n)=>{var r=n(3224),o=n(4731).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},2719:(e,t)=>{t.f=Object.getOwnPropertySymbols},3224:(e,t,n)=>{var r=n(2766),o=n(9969),a=n(9729).indexOf,i=n(2048);e.exports=function(e,t){var n,s=o(e),c=0,u=[];for(n in s)!r(i,n)&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~a(u,n)||u.push(n));return u}},7751:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},9593:(e,t,n)=>{var r=n(7642),o=n(2042),a=n(2719),i=n(6956);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(i(e)),n=a.f;return n?t.concat(n(e)):t}},1035:(e,t,n)=>{var r=n(6121);e.exports=r},2327:(e,t,n)=>{var r=n(6121),o=n(1471),a=n(2766),i=n(6565),s=n(9835),c=n(2995),u=c.get,l=c.enforce,f=String(String).split("String");(e.exports=function(e,t,n,s){var c,u=!!s&&!!s.unsafe,d=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||o(n,"name",t),(c=l(n)).source||(c.source=f.join("string"==typeof t?t:""))),e!==r?(u?!h&&e[t]&&(d=!0):delete e[t],d?e[t]=n:o(e,t,n)):d?e[t]=n:i(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},1750:(e,t,n)=>{var r=n(2849),o=n(3546);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var a=n.call(e,t);if("object"!=typeof a)throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},3546:(e,t,n)=>{"use strict";n.r(t),n(8494),e=n.hmd(e);var r,o,a=n(1346),i=n(5443),s=RegExp.prototype.exec,c=String.prototype.replace,u=s,l=(r=/a/,o=/b*/g,s.call(r,"a"),s.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),f=i.UNSUPPORTED_Y||i.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(l||d||f)&&(u=function(e){var t,n,r,o,i=this,u=f&&i.sticky,h=a.call(i),p=i.source,g=0,w=e;return u&&(-1===(h=h.replace("y","")).indexOf("g")&&(h+="g"),w=String(e).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==e[i.lastIndex-1])&&(p="(?: "+p+")",w=" "+w,g++),n=new RegExp("^(?:"+p+")",h)),d&&(n=new RegExp("^"+p+"$(?!\\s)",h)),l&&(t=i.lastIndex),r=s.call(u?n:i,w),u?r?(r.input=r.input.slice(g),r[0]=r[0].slice(g),r.index=i.lastIndex,i.lastIndex+=r[0].length):i.lastIndex=0:l&&r&&(i.lastIndex=i.global?r.index+r[0].length:t),d&&r&&r.length>1&&c.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),e.exports=u},1346:(e,t,n)=>{"use strict";var r=n(6956);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},5443:(e,t,n)=>{"use strict";var r=n(2763);function o(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},7263:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},6565:(e,t,n)=>{var r=n(6121),o=n(1471);e.exports=function(e,t){try{o(r,e,t)}catch(n){r[e]=t}return t}},2562:(e,t,n)=>{var r=n(896),o=n(1735),a=r("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},4682:(e,t,n)=>{var r=n(6121),o=n(6565),a="__core-js_shared__",i=r[a]||o(a,{});e.exports=i},896:(e,t,n)=>{var r=n(8451),o=n(4682);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},3832:(e,t,n)=>{var r=n(5623),o=n(7263),a=function(e){return function(t,n){var a,i,s=String(o(t)),c=r(n),u=s.length;return c<0||c>=u?e?"":void 0:(a=s.charCodeAt(c))<55296||a>56319||c+1===u||(i=s.charCodeAt(c+1))<56320||i>57343?e?s.charAt(c):a:e?s.slice(c,c+2):i-56320+(a-55296<<10)+65536}};e.exports={codeAt:a(!1),charAt:a(!0)}},1588:(e,t,n)=>{var r=n(5623),o=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):a(n,t)}},9969:(e,t,n)=>{var r=n(3169),o=n(7263);e.exports=function(e){return r(o(e))}},5623:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},8331:(e,t,n)=>{var r=n(5623),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},4766:(e,t,n)=>{var r=n(7263);e.exports=function(e){return Object(r(e))}},687:(e,t,n)=>{var r=n(2521);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},1735:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},2020:(e,t,n)=>{var r=n(4020);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1386:(e,t,n)=>{var r=n(6121),o=n(896),a=n(2766),i=n(1735),s=n(4020),c=n(2020),u=o("wks"),l=r.Symbol,f=c?l:l&&l.withoutSetter||i;e.exports=function(e){return a(u,e)||(s&&a(l,e)?u[e]=l[e]:u[e]=f("Symbol."+e)),u[e]}},8775:(e,t,n)=>{"use strict";var r=n(7309),o=n(3546);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},8494:(e,t,n)=>{"use strict";var r=n(1325),o=n(6956),a=n(4766),i=n(8331),s=n(5623),c=n(7263),u=n(7675),l=n(1750),f=Math.max,d=Math.min,h=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(e,t,n,r){var w=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=r.REPLACE_KEEPS_$0,v=w?"$":"$0";return[function(n,r){var o=c(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,o,r):t.call(String(o),n,r)},function(e,r){if(!w&&y||"string"==typeof r&&-1===r.indexOf(v)){var a=n(t,e,this,r);if(a.done)return a.value}var c=o(e),h=String(this),p="function"==typeof r;p||(r=String(r));var g=c.global;if(g){var k=c.unicode;c.lastIndex=0}for(var b=[];;){var x=l(c,h);if(null===x)break;if(b.push(x),!g)break;""===String(x[0])&&(c.lastIndex=u(h,i(c.lastIndex),k))}for(var I,S="",E=0,A=0;A<b.length;A++){x=b[A];for(var z=String(x[0]),j=f(d(s(x.index),h.length),0),O=[],T=1;T<x.length;T++)O.push(void 0===(I=x[T])?I:String(I));var P=x.groups;if(p){var N=[z].concat(O,j,h);void 0!==P&&N.push(P);var B=String(r.apply(void 0,N))}else B=m(z,h,j,O,P,r);j>=E&&(S+=h.slice(E,j)+B,E=j+z.length)}return S+h.slice(E)}];function m(e,n,r,o,i,s){var c=r+e.length,u=o.length,l=g;return void 0!==i&&(i=a(i),l=p),t.call(s,l,(function(t,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=i[a.slice(1,-1)];break;default:var l=+a;if(0===l)return t;if(l>u){var f=h(l/10);return 0===f?t:f<=u?void 0===o[f-1]?a.charAt(1):o[f-1]+a.charAt(1):t}s=o[l-1]}return void 0===s?"":s}))}}))}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r](o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";async function e(e,t,n){let r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)};return n&&(r.headers=Object.assign(Object.assign({},r.headers),{Authorization:`Bearer ${n}`})),await fetch(e,r)}var t;!function(e){e.google="google",e.anonym="anonym"}(t||(t={}));class r{constructor(e){this.networkError=e}}class o{}class a{}let i;i="https://kontokorrent.azurewebsites.net";const s="https://kontokorrent.azurewebsites.net";class c{}const u=s;class l{constructor(e){this.accountInfoStore=e}async neuerBenutzer(t,n){try{return(await e(`${u}/api/v2/accounts`,{id:t,secret:n})).ok?{success:!0}:{success:!1}}catch(e){return{success:!1}}}async getUserInfo(){let e=await fetch(`${u}/api/v2/userinfo`,{headers:await this.getAuthHeader()});return await e.json()}async getAuthHeader(){return{Authorization:`Bearer ${await this.getAccessToken()}`}}async kontokorrentHinzufuegen(e,t){let n="";n=e?`oeffentlicherName=${encodeURIComponent(e)}`:`einladungsCode=${encodeURIComponent(t)}`;let r=await this.getAuthHeader(),o=await fetch(`${u}/api/v2/kontokorrents?${n}`,{method:"PUT",headers:r});return 404==o.status?null:await o.json()}async kontokorrentsAuflisten(){let e=await fetch(`${u}/api/v2/kontokorrents`,{headers:await this.getAuthHeader()});if(!e.ok)throw new a;return await e.json()}async neuerKontokorrent(t){let n=await e(`${u}/api/v2/kontokorrents`,t,await this.getAccessToken());return 422==n.status?{success:!1,exists:!0}:n.ok?{success:!0}:{success:!1}}async getAktionen(e,t){let n=t?`?ab=${t}`:"",r=await fetch(`${u}/api/v2/kontokorrents/${e}/aktionen${n}`,{headers:await this.getAuthHeader()});if(404==r.status)return{success:!1,notfound:!0};if(r.ok){let e=await r.json();return{success:!0,aktionen:this.mapAktionen(e)}}}mapAktionen(e){for(let t of e)t.bezahlung&&(t.bezahlung.zeitpunkt=new Date(t.bezahlung.zeitpunkt));return e}async neueBezahlung(e,t){let n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/vnd+kontokorrent.hinzufuegenaktion+json",Authorization:`Bearer ${await this.getAccessToken()}`},body:JSON.stringify(t)},r=await fetch(`${u}/api/v2/kontokorrents/${e}/aktionen`,n);if(r.ok){let e=await r.json();return this.mapAktionen([e])[0]}throw new c}async getAccessToken(){let n=await this.accountInfoStore.get();if(null==n)throw new Error("Keine Account Information gespeichert.");if(n.type==t.anonym){let t,o=await this.accountInfoStore.getAccessToken("anonymous");if(null!=o){let{token:e,expires:t}=JSON.parse(o.value);if(e&&t&&t>=+new Date)return e}try{let o=await e(`${u}/api/v2/token`,{id:n.id,secret:n.secret});if(!o.ok)throw new r(!1);t=await o.json()}catch(e){throw new r(!0)}return await this.accountInfoStore.updateAccessTokenIfNewer("anonymous",JSON.stringify(t),null==o?void 0:o.timestamp),t.token}throw n.type==t.google?new o:new Error(`Account Typ ${n.type} unbekannt`)}}class f{constructor(e){this.db=e}async set(e){await this.db.setAccountInfo(e)}async get(){return await this.db.getAccountInfo()}async clear(){await this.db.clearAccountInfo()}async getAccessToken(e){return await this.db.getAccessToken(e)}async updateAccessTokenIfNewer(e,t,n){return await this.db.updateAccessTokenIfNewer(e,t,n)}}let d,h;n(8494);const p=new WeakMap,g=new WeakMap,w=new WeakMap,y=new WeakMap,v=new WeakMap;let m={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return g.get(e);if("objectStoreNames"===t)return e.objectStoreNames||w.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return b(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function k(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(h||(h=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(x(this),e),b(p.get(this))}:function(...e){return b(t.apply(x(this),e))}:function(e,...n){const r=t.call(x(this),e,...n);return w.set(r,e.sort?e.sort():[e]),b(r)}:(e instanceof IDBTransaction&&function(e){if(g.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)}));g.set(e,t)}(e),n=e,(d||(d=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,m):e);var t,n}function b(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{t(b(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&p.set(t,e)})).catch((()=>{})),v.set(t,e),t}(e);if(y.has(e))return y.get(e);const t=k(e);return t!==e&&(y.set(e,t),v.set(t,e)),t}const x=e=>v.get(e),I=["get","getKey","getAll","getAllKeys","count"],S=["put","add","delete","clear"],E=new Map;function A(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(E.get(t))return E.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=S.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!I.includes(n))return;const a=async function(e,...t){const a=this.transaction(e,o?"readwrite":"readonly");let i=a.store;r&&(i=i.index(t.shift()));const s=await i[n](...t);return o&&await a.done,s};return E.set(t,a),a}var z;z=m,m={...z,get:(e,t,n)=>A(e,t)||z.get(e,t,n),has:(e,t)=>!!A(e,t)||z.has(e,t)};const j="KontokorrentsStore",O="AppStateStore",T="AktionenStore",P="NeueBezahlungenStore";class N{async withInitialized(e){let t=await function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:a}={}){const i=indexedDB.open(e,t),s=b(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(b(i.result),e.oldVersion,e.newVersion,b(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),s.then((e=>{a&&e.addEventListener("close",(()=>a())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),s}("kontokorrent-db",5,{upgrade(e,t,n){t<1&&e.createObjectStore(j,{keyPath:"id"}).createIndex("oeffentlicherName","oeffentlicherName"),t<2&&e.createObjectStore(O,{keyPath:"id"}).put({id:0,zuletztGesehenerKontokorrentId:null,accesstokens:[],accountinfo:null}),t<3&&e.createObjectStore(T,{keyPath:["laufendeNummer","kontokorrentId"]}).createIndex("kontokorrentId","kontokorrentId"),t<5&&(e.objectStoreNames.contains(P)&&e.deleteObjectStore(P),e.createObjectStore(P,{keyPath:"id"}).createIndex("kontokorrentId","kontokorrentId"))}});try{return await e(t)}finally{t.close()}}async getKontokorrents(){return await this.withInitialized((async e=>{return t=await e.getAll(j),n=e=>e.name,t.sort(((e,t)=>n(e).toLowerCase().localeCompare(n(t).toLowerCase())));var t,n}))}async addAktionen(e,t){if(!t.length)return;let n=t.map((t=>Object.assign(Object.assign({},t),{kontokorrentId:e})));return await this.withInitialized((t=>{const r=x(t);return new Promise(((t,o)=>{const a=r.transaction(T,"readwrite");a.onerror=e=>{console.error("addAktionen failed",e,a.error),o(a.error)},a.oncomplete=()=>{t()};for(let t of n){let n=a.objectStore(T).add(t);n.onerror=r=>{"ConstraintError"==n.error.name?(console.log(`Aktion ${t.laufendeNummer} für Kontokorrent ${e} bereits gespeichert.`,r,n.error),r.preventDefault(),r.stopPropagation()):console.error(`Aktion ${t.laufendeNummer} für Kontokorrent ${e} konnte nicht gespeichert werden.`,r,n.error)}}}))}))}async getZuletztGesehenerKontokorrentId(){return await this.withInitialized((async e=>{let t=await e.get(O,0);if(t.zuletztGesehenerKontokorrentId)return t.zuletztGesehenerKontokorrentId;{let e=await await this.getKontokorrents();return e.length?e[0].id:null}}))}async setZuletztGesehenerKontokorrentId(e){return await this.withInitialized((async t=>{let n=await t.get(O,0);n.zuletztGesehenerKontokorrentId=e,await t.put(O,n)}))}async setKontokorrents(e){return await this.withInitialized((async t=>{let n=await t.getAll(j);for(let r of n.filter((t=>!e.some((e=>t.id===e.id)))))await t.delete(j,r.id);let r=[];for(let o of e){let e=n.find((e=>e.id==o.id));e||r.push(o.id);let a=Object.assign(Object.assign({},e),{name:o.name,personen:o.personen,id:o.id,oeffentlicherName:o.oeffentlicherName});await t.put(j,a)}return r}))}async addKontokorrent(e){return await this.withInitialized((async t=>{await t.get(j,e.id)||await t.add(j,e)}))}async getKontokorrent(e){return await this.withInitialized((async t=>await t.get(j,e)))}async getPerOeffentlichName(e){return await this.withInitialized((async t=>await t.getFromIndex(j,"oeffentlicherName",e)))}async getAktionen(e){return await this.withInitialized((async t=>await t.getAllFromIndex(T,"kontokorrentId",e)))}async clear(){return await this.withInitialized((async e=>{await e.clear(T),await e.clear(j),await e.put(O,{id:0,zuletztGesehenerKontokorrentId:null,accesstokens:[],accountinfo:null})}))}async getAccessToken(e){return await this.withInitialized((async t=>((await t.get(O,0)).accesstokens||[]).find((t=>t.type===e))))}async updateAccessTokenIfNewer(e,t,n){return await this.withInitialized((async r=>{const o=r.transaction(O,"readwrite",{durability:"strict"});let a=await o.store.get(0);a.accesstokens||(a.accesstokens=[]);let i=a.accesstokens.find((t=>t.type===e));if(i){if(i.timestamp!=n)return console.error(`The accesstoken of type ${e} was already updated since reading.`),await o.done,!1;i.value=t,i.timestamp++}else a.accesstokens.push({timestamp:1,type:e,value:t});return await o.store.put(a),await o.done,!0}))}async setAccountInfo(e){return await this.withInitialized((async t=>{const n=t.transaction(O,"readwrite");let r=await n.store.get(0);r.accountinfo=e,await n.store.put(r),await n.done}))}async getAccountInfo(){return await this.withInitialized((async e=>{const t=e.transaction(O,"readonly");let n=await t.store.get(0);return null==n?void 0:n.accountinfo}))}async clearAccountInfo(){return await this.withInitialized((async e=>{const t=e.transaction(O,"readwrite");let n=await t.store.get(0);n.accountinfo=null,n.accesstokens=[],await t.store.put(n),await t.done}))}async getZwischengespeicherteBezahlungen(){return await this.withInitialized((async e=>e.getAll(P)))}async getZwischengespeicherteBezahlungenForKontokorrent(e){return await this.withInitialized((async t=>await t.getAllFromIndex(P,"kontokorrentId",e)))}async bezahlungZwischenspeichern(e){return await this.withInitialized((async t=>{t.add(P,e)}))}async zwischengespeicherteBezahlungErledigt(e){await this.withInitialized((async t=>{t.delete(P,e)}))}}class B{constructor(e,t){this.apiClient=e,this.db=t}async bezahlungAnlegen(e,t){let n=await this.apiClient.neueBezahlung(e,t);return this.db.addAktionen(e,[n]),n}}class ${constructor(e,t){this.kontokorrentId=e,this.bezahlungId=t,this.type=25}}class D{constructor(e,t){this.kontokorrentId=e,this.bezahlungId=t,this.type=26}}let C={code:"code-852a8887bdabdd46593598f7da3212cd573d337a",asset:"asset-v1",webfont:"webfont"};async function L(e){const t=await self.clients.matchAll();for(const n of t)n.postMessage({type:"statedispatch",msg:e})}self.addEventListener("install",(function(e){let t=[{'revision':null,'url':'/v2/02c8c00b316b413a8cd6.bundle.js'},{'revision':null,'url':'/v2/0bf656565374155d7fd7.bundle.js'},{'revision':null,'url':'/v2/300.7fcb6c68e63193f4ac69.css'},{'revision':null,'url':'/v2/429.8183d5c789173875438b.css'},{'revision':null,'url':'/v2/4c24048b5f5f7b513d45.bundle.js'},{'revision':null,'url':'/v2/4fc85e32c1143fba93bf.bundle.js'},{'revision':null,'url':'/v2/7bad8131ce3edb18031b.bundle.js'},{'revision':null,'url':'/v2/83.df3dc72b4f4eb00a746c.css'},{'revision':null,'url':'/v2/9c187ba7720c4ea2dbc1.bundle.js'},{'revision':null,'url':'/v2/a54cd8c09c26fa7f6dcc.bundle.js'},{'revision':null,'url':'/v2/d55c37664edab0b5cd07.bundle.js'},{'revision':null,'url':'/v2/f6a428c00f767150e9bc.bundle.js'},{'revision':'3a57114c3ee13bc721c2d0415b49cc6a','url':'/v2/favicons/android-chrome-192x192.png'},{'revision':'ed824703c3c9876c64c2431f643a9874','url':'/v2/favicons/android-chrome-512x512.png'},{'revision':'c6d41b85647148e1957cef99b4906ea9','url':'/v2/favicons/apple-touch-icon.png'},{'revision':'dd5464d9de3e53bfb4dd122f57acba9e','url':'/v2/favicons/browserconfig.xml'},{'revision':'ac90a4af152a3faa919137053a51ef59','url':'/v2/favicons/favicon-16x16.png'},{'revision':'d215721a665ba9d25238477b9022f4a2','url':'/v2/favicons/favicon-32x32.png'},{'revision':'ecf16b928d22f9f9904b6fe5098f9818','url':'/v2/favicons/favicon.ico'},{'revision':'b95dc058d8d8aab47821b20aa12efc87','url':'/v2/favicons/mstile-144x144.png'},{'revision':'7b4269725276411f8f2317464308e535','url':'/v2/favicons/mstile-150x150.png'},{'revision':'bcd915cfb20f6dc9a1d9e6ec57f771bf','url':'/v2/favicons/mstile-310x150.png'},{'revision':'a6282f67b088fec98fdb90a08e9b8c11','url':'/v2/favicons/mstile-310x310.png'},{'revision':'a551b4b2f361416feaa1dfdc67ba18be','url':'/v2/favicons/mstile-70x70.png'},{'revision':'82aeb37c560455a1565fbf71310aa90b','url':'/v2/favicons/safari-pinned-tab.svg'},{'revision':null,'url':'/v2/index.3300620b5806e76bbea4.css'},{'revision':'a08d9730043326173e53bc316095535b','url':'/v2/licenses.txt'},{'revision':'5c887ce87efbde41b424f7bea08267c3','url':'/v2/site.webmanifest'}].reduce(((e,t)=>(t.url.indexOf("favicons/")>-1?e.asset.push(t.url):e.code.push(t.url),e)),{asset:[],code:[]}),n=[{name:C.code,assets:[...t.code,"index.html"]},{name:C.asset,assets:t.asset},{name:C.webfont,assets:["https://fonts.googleapis.com/icon?family=Material+Icons","https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap"]}];e.waitUntil((async()=>{let e=n.map((async e=>{let t=await caches.open(e.name);await t.addAll(e.assets)}));await Promise.all(e)})())})),self.addEventListener("activate",(e=>{e.waitUntil((async()=>{let e=await caches.keys(),t=Object.values(C),n=e.filter((e=>t.indexOf(e)<0)).map((async e=>{await caches.delete(e)}));await Promise.all(n)})())})),self.addEventListener("fetch",(function(e){if("navigate"!==e.request.mode)e.respondWith(caches.match(e.request).then((function(t){return t||fetch(e.request)})));else{if("GET"!==e.request.method)return;e.respondWith(caches.match("index.html",{cacheName:C.code}).then((t=>t||fetch(e.request))))}}));class R{constructor(e,t){this.db=e,this.neueBezahlungenService=t}async zwischengespeicherteZahlungenAnlegen(){let e=await this.db.getZwischengespeicherteBezahlungen();for(let t of e){await L(new $(t.kontokorrentId,t.id));try{let e=await this.neueBezahlungenService.bezahlungAnlegen(t.kontokorrentId,t);await this.db.zwischengespeicherteBezahlungErledigt(e.bezahlung.id),await L(new D(t.kontokorrentId,t.id))}catch(e){console.error("Fehler beim Anlegen der Zahlung",e)}}}}self.addEventListener("sync",(function(e){"NeueBezahlungBackgroundSync"==e.tag&&e.waitUntil((async()=>{let e=new N,t=new f(e),n=new l(t),r=new B(n,e),o=new R(e,r);await o.zwischengespeicherteZahlungenAnlegen()})())}))})()})();
//# sourceMappingURL=sw.js.map