(self.webpackChunkkontokorrent=self.webpackChunkkontokorrent||[]).push([[630],{3682:function(t,e,n){"use strict";function o(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}n.d(e,{Z:function(){return o}})},9429:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var o=n(4327),s=n(3682);function r(t){(0,s.Z)(1,arguments);var e=(0,o.Z)(t);return e.setHours(0,0,0,0),e}},4327:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var o=n(3682);function s(t){(0,o.Z)(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}},426:function(t,e,n){"use strict";n.d(e,{W:function(){return S}});var o=n(5097),s=n.n(o),r=n(9773),i=n(2204),a=n(5777),c=n.n(a),l=n(5088),u=n.n(l),h=n(1173),d=n(6029),p=n(2255),k=n.n(p);class m extends HTMLElement{constructor(){super(),this.innerHTML=k(),this.name=this.querySelector('[data-ref="name"]'),this.link=this.querySelector('[data-ref="link"]'),this.clickEvent=this.clickEvent.bind(this)}connectedCallback(){this.link.addEventListener("click",this.clickEvent)}clickEvent(t){t.preventDefault(),this.dispatchEvent(new CustomEvent("gotokontokorrent",{detail:this.kontokorrent.id,bubbles:!0}))}disconnectedCallback(){this.link.removeEventListener("click",this.clickEvent)}update(t,e){this.kontokorrent=t,this.name.innerText=t.name,this.link.href=`kontokorrents/${t.id}`,this.link.classList.toggle("kontokorrent-select-list__entry--active",e)}}customElements.define("kontokorrent-select-list-entry",m);class f extends HTMLElement{constructor(){super(),this.innerHTML=u(),this.list=this.querySelector('[data-ref="list"]'),this._kontokorrents=[],this.kontokorrentsRenderer=new d.T(this.list,(t=>t.id),(()=>{let t=document.createElement("li");return t.appendChild(new m),t}))}connectedCallback(){}disconnectedCallback(){}update(){this.kontokorrentsRenderer.update(this._kontokorrents,((t,e)=>{t.firstChild.update(e,this._activeKontokorrentId==e.id)}))}set kontokorrents(t){this._kontokorrents=(0,h.T)(t,(t=>t.name)),this.update()}set activeKontokorrentId(t){this._activeKontokorrentId=t,this.update()}}const g="kontokorrent-select-list";customElements.define(g,f),n(4227);class v extends HTMLElement{constructor(){super(),this.innerHTML=c(),this.kontokorrentName=this.querySelector('[data-ref="kontokorrent-name"]'),this.kontokorrentSelectList=this.querySelector(g),this.addButton=this.querySelector("#add-kontokorrent"),this._kontokorrents=null}connectedCallback(){this.popup=this.querySelector("app-popup"),this.updateAttributes(),this.addEventListener("click",(t=>{this.popup.contains(event.target)||(this.popup.toggle(),t.stopPropagation())})),this.addButton.addEventListener("click",(t=>{this.dispatchEvent(new CustomEvent("addkontokorrent"))})),this.kontokorrentSelectList.addEventListener("gotokontokorrent",(()=>{this.popup.hide()}))}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.activeKontokorrentId=this.getAttribute("active-kontokorrent-id"),this.kontokorrentSelectList.activeKontokorrentId=this.activeKontokorrentId,this.updatesStyle()}static get observedAttributes(){return["active-kontokorrent-id"]}set kontokorrents(t){this.kontokorrentSelectList.kontokorrents=t,this._kontokorrents=t,this.updatesStyle()}updatesStyle(){if(this._kontokorrents&&this._kontokorrents.length){let t=this._kontokorrents.find((t=>t.id==this.activeKontokorrentId));this.kontokorrentName.innerText=t?t.name:"(Kontokorrent wÃ¤hlen)"}}}const b="kontokorrent-select";customElements.define(b,v);var y=n(2887);class E extends HTMLElement{constructor(){super(),this.innerHTML=s(),this.kontokorrentSelect=this.querySelector(b),this.logoutDialog=this.querySelector("#logout-dialog")}connectedCallback(){this.querySelector("#logout-button").addEventListener("click",(t=>{this.logoutDialog.toggle(),t.stopPropagation()})),this.querySelector("#confirm-logout").addEventListener("click",(async()=>{await this.accountActionCreator.logout()})),this.querySelector("#abort-logout").addEventListener("click",(()=>{this.logoutDialog.hide()})),(0,i.G)(this.querySelectorAll("a"),this.routingActionCreator),this.subscription=this.store.subscribe(null,(t=>this.applyStoreState(t))),this.applyStoreState(this.store.state),this.kontokorrentSelect.addEventListener("addkontokorrent",(()=>{this.routingActionCreator.navigateLogin()}))}applyStoreState(t){this.kontokorrentSelect.kontokorrents=Object.values(t.kontokorrents.kontokorrents),this.kontokorrentSelect.setAttribute("active-kontokorrent-id",t.kontokorrents.activeKontokorrentId)}addServices(t){this.store=t.store,this.routingActionCreator=(0,r.b)(t),this.accountActionCreator=(0,y.gg)(t)}disconnectedCallback(){this.subscription()}}const S="app-bar";customElements.define(S,E)},2204:function(t,e,n){"use strict";function o(t,e){t.forEach((t=>{t.addEventListener("click",(n=>{n.preventDefault(),e.navigate(t.getAttribute("href"))}))}))}n.d(e,{G:function(){return o}})},4227:function(t,e,n){"use strict";class o extends HTMLElement{constructor(){super(),this.popupShown=!1,this.keyListener=this.keyListener.bind(this),this.clickListener=this.clickListener.bind(this)}connectedCallback(){this.updateStyles()}keyListener(t){"Escape"==t.key&&this.hide()}clickListener(t){this.contains(event.target)||this.hide()}hide(){this.popupShown&&(document.removeEventListener("keydown",this.keyListener),document.removeEventListener("click",this.clickListener),this.popupShown=!1,this.updateStyles())}show(){this.popupShown||(document.addEventListener("keydown",this.keyListener),document.addEventListener("click",this.clickListener),this.popupShown=!0,this.updateStyles())}updateStyles(){this.style.display=this.popupShown?"block":"none"}toggle(){this.popupShown?this.hide():this.show()}disconnectedCallback(){this.hide()}}customElements.define("app-popup",o)},2390:function(t,e,n){"use strict";n.d(e,{G:function(){return y}}),n(285);const o=Symbol("Comlink.proxy"),s=Symbol("Comlink.endpoint"),r=Symbol("Comlink.releaseProxy"),i=Symbol("Comlink.thrown"),a=t=>"object"==typeof t&&null!==t||"function"==typeof t,c=new Map([["proxy",{canHandle:t=>a(t)&&t[o],serialize(t){const{port1:e,port2:n}=new MessageChannel;return l(t,e),[n,[n]]},deserialize:t=>(t.start(),h(t))}],["throw",{canHandle:t=>a(t)&&i in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function l(t,e=self){e.addEventListener("message",(function n(s){if(!s||!s.data)return;const{id:r,type:a,path:c}=Object.assign({path:[]},s.data),h=(s.data.argumentList||[]).map(g);let d;try{const e=c.slice(0,-1).reduce(((t,e)=>t[e]),t),n=c.reduce(((t,e)=>t[e]),t);switch(a){case 0:d=n;break;case 1:e[c.slice(-1)[0]]=g(s.data.value),d=!0;break;case 2:d=n.apply(e,h);break;case 3:d=function(t){return Object.assign(t,{[o]:!0})}(new n(...h));break;case 4:{const{port1:e,port2:n}=new MessageChannel;l(t,n),d=function(t,e){return m.set(t,e),t}(e,[e])}break;case 5:d=void 0}}catch(t){d={value:t,[i]:0}}Promise.resolve(d).catch((t=>({value:t,[i]:0}))).then((t=>{const[o,s]=f(t);e.postMessage(Object.assign(Object.assign({},o),{id:r}),s),5===a&&(e.removeEventListener("message",n),u(e))}))})),e.start&&e.start()}function u(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function h(t,e){return p(t,[],e)}function d(t){if(t)throw new Error("Proxy has been released and is not useable")}function p(t,e=[],n=function(){}){let o=!1;const i=new Proxy(n,{get(n,s){if(d(o),s===r)return()=>v(t,{type:5,path:e.map((t=>t.toString()))}).then((()=>{u(t),o=!0}));if("then"===s){if(0===e.length)return{then:()=>i};const n=v(t,{type:0,path:e.map((t=>t.toString()))}).then(g);return n.then.bind(n)}return p(t,[...e,s])},set(n,s,r){d(o);const[i,a]=f(r);return v(t,{type:1,path:[...e,s].map((t=>t.toString())),value:i},a).then(g)},apply(n,r,i){d(o);const a=e[e.length-1];if(a===s)return v(t,{type:4}).then(g);if("bind"===a)return p(t,e.slice(0,-1));const[c,l]=k(i);return v(t,{type:2,path:e.map((t=>t.toString())),argumentList:c},l).then(g)},construct(n,s){d(o);const[r,i]=k(s);return v(t,{type:3,path:e.map((t=>t.toString())),argumentList:r},i).then(g)}});return i}function k(t){const e=t.map(f);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const m=new WeakMap;function f(t){for(const[e,n]of c)if(n.canHandle(t)){const[o,s]=n.serialize(t);return[{type:3,name:e,value:o},s]}return[{type:0,value:t},m.get(t)||[]]}function g(t){switch(t.type){case 3:return c.get(t.name).deserialize(t.value);case 0:return t.value}}function v(t,e,n){return new Promise((o=>{const s=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===s&&(t.removeEventListener("message",e),o(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:s},e),n)}))}class b{constructor(t){this.store=t}async getWorker(){if(this.workerApi)return this.workerApi;const t=new Worker(new URL(n.p+n.u(458),n.b));return t.addEventListener("message",(t=>{var e;if("statedispatch"==(null===(e=t.data)||void 0===e?void 0:e.type)){let e=t.data.msg;this.store.dispatch(e)}})),this.workerApi=h(t),this.workerApi}}function y(t){return t.get("WorkerService",(t=>new b(t.store)))}},6029:function(t,e,n){"use strict";n.d(e,{T:function(){return o}});class o{constructor(t,e,n){this.listElement=t,this.keySelector=e,this.createElement=n,this.keyToElement=new Map,this.elementToKey=new WeakMap}update(t,e){let n=new Map,o=t=>n.get(t)||(()=>{let e=this.keySelector(t);return n.set(t,e),e})();for(let n of Array.from(this.listElement.children)){let s=n,r=t.find((t=>this.elementToKey.get(s)==o(t)));r?e(s,r):this.listElement.removeChild(s)}let s=null,r=new Map;for(let n of t){let t=o(n),i=this.keyToElement.get(t);i||(i=this.createElement(n),e(i,n),this.elementToKey.set(i,t)),r.set(t,i),null==s&&i!=this.listElement.firstElementChild?this.listElement.prepend(i):null!=s&&s.nextElementSibling!=i&&s.insertAdjacentElement("afterend",i),s=i}this.keyToElement=r}}},5022:function(t,e,n){"use strict";n.d(e,{a:function(){return o}});class o{constructor(t){this.template=t}get(){return null==this.instance&&(this.instance=document.createElement("template"),this.instance.innerHTML=this.template),document.importNode(this.instance.content,!0)}}},5097:function(t){t.exports='<header class="app-bar"> <kontokorrent-select class="app-bar__kontokorrent-select"></kontokorrent-select> <nav class="app-bar__links"> <button id="logout-button" class="app-bar__link" title="Logout"> <span class="material-icons"> exit_to_app </span> </button> <a href="info" class="app-bar__link" title="Informationen Ã¼ber diese App"> <span class="material-icons"> info </span> </a> </nav> </header> <app-popup id="logout-dialog"> <div class="dialog__backdrop"></div> <div class="dialog"> <p> Wirklich aus allen Kontokorrents ausloggen? </p> <div class="dialog__button-pane"> <button id="abort-logout" class="button">Abbrechen</button> <button id="confirm-logout" class="button">Ausloggen</button> </div> </div> </app-popup>'},5777:function(t){t.exports='<div class="kontokorrent-select-wrapper"> <div class="kontokorrent-select"> <h1 data-ref="kontokorrent-name" class="kontokorrent-select__name">Kontokorrent</h1> <button class="kontokorrent-select__choose" title="anderen Kontokorrent wÃ¤hlen"> <span class="material-icons"> arrow_drop_down </span> </button> </div> <app-popup class="kontokorrent-select__popup"> <kontokorrent-select-list></kontokorrent-select-list> <div class="kontokorrent-select__buttons"> <button id="add-kontokorrent" class="button">weiteren hinzufÃ¼gen</button> </div> </app-popup> </div>'},5088:function(t){t.exports='<ol data-ref="list" class="kontokorrent-select-list"> </ol>'},2255:function(t){t.exports='<a data-ref="link" class="kontokorrent-select-list__entry"> <span data-ref="name"></span> </a>'}}]);
//# sourceMappingURL=572c33f78379e4900687.bundle.js.map