{"version":3,"file":"a289aa1a426c68461b4f.bundle.js","mappings":"6BAAIA,ECAAC,EACAC,ECwCAC,EASAC,E,wDClDE,MAAOC,K,qDCAP,MAAOC,EACTC,YAA4BC,GAAA,KAAAA,aAAAA,K,qDCE1B,MAAOC,UCWP,MAIFF,YAAYG,GACRC,KAAKC,cAAgB,GACrBD,KAAKE,qBAAuB,GAC5BF,KAAKG,MAAQJ,IAEjBK,UAAkCC,EAAgBC,GAC9C,IAAIC,EAAM,CAAEF,KAAAA,EAAMC,KAAAA,GAElB,OADAN,KAAKC,cAAcO,KAAKD,GACjB,KACHP,KAAKC,cAAcQ,OAAOT,KAAKC,cAAcS,QAAQH,GAAM,IAGnEI,WAAmCN,EAAgBO,GAC/CZ,KAAKE,qBAAqBM,KAAK,CAAEH,KAAAA,EAAMO,QAAAA,IAE3CC,SAASC,GACL,IAAIC,EAAsC,GAC1C,IAAK,IAAIC,KAAKhB,KAAKE,qBAAsB,CACrC,IAAIe,EAEAA,EADAD,EAAEX,KACea,IACPlB,KAAKG,MAAMa,EAAEX,MAASa,EAAGlB,KAAKG,MAAMa,EAAEX,OAC5CU,EAAaP,KAAKQ,EAAEX,OAIPa,IACblB,KAAKG,MAAQe,EAAGlB,KAAKG,OACrBY,EAAaP,KAAK,KAG1B,IACIQ,EAAEJ,QAAQO,WAAWL,EAAQG,GAEjC,MAAOG,GACHC,QAAQC,MAAR,kCAAyCR,EAAOS,KAAhD,KAAyDH,IAGjE,GAAIL,EAAaS,OACb,IAAK,IAAIR,KAAKhB,KAAKC,cACf,IAAKe,EAAEX,MAAQU,EAAaL,QAAQM,EAAEX,OAAS,EAC3C,IACIW,EAAEV,KAAKN,KAAKG,OAEhB,MAAOiB,GACHC,QAAQC,MAAR,kCAAyCN,EAAEX,MAAQ,SAAnD,kBAAqES,EAAOS,KAA5E,KAAqFH,OCzDvG,MAAOK,EAET7B,YAAmB8B,EACRC,EACAC,EACAC,EACAC,GAJQ,KAAAJ,MAAAA,EACR,KAAAC,OAAAA,EACA,KAAAC,UAAAA,EACA,KAAAC,GAAAA,EACA,KAAAC,iBAAAA,EACP9B,KAAK+B,SAAW,GAGpBC,IAAOC,EAAcC,GAIjB,OAHKlC,KAAK+B,SAASE,KACfjC,KAAK+B,SAASE,GAAQC,EAAgBlC,OAEnCA,KAAK+B,SAASE,ICjBvB,MAAOE,EACTvC,YAAoBiC,GAAA,KAAAA,GAAAA,EAIX,UAACO,SACApC,KAAK6B,GAAGQ,eAAeD,GAExB,YACL,aAAapC,KAAK6B,GAAGS,iBAEd,oBACDtC,KAAK6B,GAAGU,mBAGE,qBAACC,GACjB,aAAaxC,KAAK6B,GAAGY,eAAeD,GAGV,+BAACA,EAAmCE,EAAeC,GAC7E,aAAa3C,KAAK6B,GAAGe,yBAAyBJ,EAAWE,EAAOC,ICvBjEE,eAAeC,EAASC,EAAaC,EAAWC,GACnD,IAAIC,EAAoB,CACpBC,OAAQ,OACRC,QAAS,CACL,OAAU,mBACV,eAAgB,oBAEpBJ,KAAMK,KAAKC,UAAUN,IAKzB,OAHIC,IACAC,EAAKE,QAAO,+BAAQF,EAAKE,SAAO,CAAE,+BAA2BH,YAEpDM,MAAMR,EAAKG,G,kCCXtB,MAAOM,GCDb,IAAIC,EAQAA,EAAU,yCAMP,MAAMC,EANC,yCCPR,MAAOC,GCAP,MAAOC,GCAP,MAAOC,GCeb,MAAMC,EAAUJ,EAEV,MAAOK,EAETnE,YAAoBkC,GAAA,KAAAA,iBAAAA,EAID,oBAACkC,EAAYC,GAC5B,IAEI,aADgBnB,EAAS,GAAD,OAAIgB,EAAJ,oBAA+B,CAAEE,GAAAA,EAAIC,OAAAA,KACpDC,GAGF,CAAEC,SAAS,GAFP,CAAEA,SAAS,GAI1B,MAAM/C,GACF,MAAO,CAAE+C,SAAS,IAIT,oBACb,IAAIC,QAAYb,MAAM,GAAD,OAAIO,EAAJ,oBAA+B,CAAEV,cAAepD,KAAKqE,kBAC1E,aAAaD,EAAIE,OAGM,sBACvB,MAAO,CAAE,qCAAiCtE,KAAKyC,mBAGtB,8BAAC8B,EAA2BC,GACrD,IAAIC,EAAS,GAETA,EADAF,EACS,qBAAH,OAAwBG,mBAAmBH,IAGxC,kBAAH,OAAqBG,mBAAmBF,IAElD,IAAIpB,QAAgBpD,KAAKqE,gBACrBD,QAAYb,MAAM,GAAD,OAAIO,EAAJ,iCAAoCW,GAAU,CAAEtB,OAAQ,MAAOC,QAASA,IAC7F,OAAkB,KAAdgB,EAAIO,OACG,WAEsBP,EAAIE,OAGb,+BACxB,IAAIF,QAAYb,MAAM,GAAD,OAAIO,EAAJ,yBAAoC,CAAEV,cAAepD,KAAKqE,kBAC/E,IAAKD,EAAIF,GACL,MAAM,IAAIV,EAEd,aAAiCY,EAAIE,OAIlB,wBAACM,GACpB,IAAIR,QAAYtB,EAAS,GAAD,OAAIgB,EAAJ,yBAAoCc,QAAe5E,KAAKyC,kBAChF,OAAkB,KAAd2B,EAAIO,OACG,CAAER,SAAS,EAAOU,QAAQ,GAE5BT,EAAIF,GACF,CAAEC,SAAS,GAEf,CAAEA,SAAS,GAGL,kBAACW,EAAwBC,GACtC,IAAIC,EAAQD,EAAK,OAAH,OAAUA,GAAO,GAC3BX,QAAYb,MAAM,GAAD,OAAIO,EAAJ,iCAAoCgB,EAApC,oBAA8DE,GAAS,CAAE5B,cAAepD,KAAKqE,kBAClH,GAAkB,KAAdD,EAAIO,OACJ,MAAO,CACHR,SAAS,EACTc,UAAU,GAGb,GAAIb,EAAIF,GAAI,CACb,IAAIgB,QAA2Bd,EAAIE,OACnC,MAAO,CACHH,SAAS,EACTe,SAAUlF,KAAKmF,YAAYD,KAK/BC,YAAYD,GAChB,IAAK,IAAIE,KAAKF,EACNE,EAAEC,YACFD,EAAEC,UAAUC,UAAY,IAAIC,KAAKH,EAAEC,UAAUC,YAGrD,OAAOJ,EAGQ,oBAACJ,EAAwBF,GACxC,IAAI1B,EAAoB,CACpBC,OAAQ,OACRC,QAAS,CACL,OAAU,mBACV,eAAgB,sDAChB,qCAAiCpD,KAAKyC,mBAE1CO,KAAMK,KAAKC,UAAUsB,IAErBR,QAAYb,MAAM,GAAD,OAAIO,EAAJ,iCAAoCgB,EAApC,aAA+D5B,GACpF,GAAIkB,EAAIF,GAAI,CACR,IAAIsB,QAAwBpB,EAAIE,OAChC,OAAOtE,KAAKmF,YAAY,CAACK,IAAS,GAEtC,MAAM,IAAI7B,EAGS,wBAACmB,EAAwBW,GAC5C,IAAIvC,EAAoB,CACpBC,OAAQ,OACRC,QAAS,CACL,OAAU,mBACV,eAAgB,mDAChB,qCAAiCpD,KAAKyC,mBAE1CO,KAAMK,KAAKC,UAAU,CAACU,GAAGyB,KAEzBrB,QAAYb,MAAM,GAAD,OAAIO,EAAJ,iCAAoCgB,EAApC,aAA+D5B,GACpF,GAAIkB,EAAIF,GAAI,CACR,IAAIsB,QAAwBpB,EAAIE,OAChC,OAAOtE,KAAKmF,YAAY,CAACK,IAAS,GAEtC,MAAM,IAAI3B,EAGW,0BAACiB,EAAwBF,GAC9C,IAAI1B,EAAoB,CACpBC,OAAQ,OACRC,QAAS,CACL,OAAU,mBACV,eAAgB,qDAChB,qCAAiCpD,KAAKyC,mBAE1CO,KAAMK,KAAKC,UAAUsB,IAErBR,QAAYb,MAAM,GAAD,OAAIO,EAAJ,iCAAoCgB,EAApC,aAA+D5B,GACpF,GAAIkB,EAAIF,GAAI,CACR,IAAIsB,QAAwBpB,EAAIE,OAChC,OAAOtE,KAAKmF,YAAY,CAACK,IAAS,GAEtC,MAAM,IAAI5B,EAIc,uBACxB,IAAI8B,QAAa1F,KAAK8B,iBAAiBE,MACvC,GAAI,MAAQ0D,EACR,MAAM,IAAIC,MAAM,0CAEpB,GAAID,EAAKnE,MAAQqE,EAAA,SAAoB,CACjC,IAOIC,EAPAC,QAAkB9F,KAAK8B,iBAAiBW,eAAe,aAC3D,GAAI,MAAQqD,EAAW,CACnB,IAAI,MAAE7C,EAAF,QAAS8C,GAAY1C,KAAK2C,MAAMF,EAAUpD,OAC9C,GAAIO,GAAS8C,GAAWA,IAAY,IAAIR,KACpC,OAAOtC,EAIf,IACI,IAAImB,QAAYtB,EAAS,GAAD,OAAIgB,EAAJ,iBAA4B,CAAEE,GAAI0B,EAAK1B,GAAIC,OAAQyB,EAAKzB,SAChF,IAAKG,EAAIF,GACL,MAAM,IAAIvE,EAAA,GAA0B,GAExCkG,QAAsBzB,EAAIE,OAE9B,MAAMlD,GACF,MAAM,IAAIzB,EAAA,GAA0B,GAGxC,aADMK,KAAK8B,iBAAiBc,yBAAyB,YAAaS,KAAKC,UAAUuC,GAAgBC,MAAAA,OAAS,EAATA,EAAWG,WACrGJ,EAAc5C,MAEpB,MAAIyC,EAAKnE,MAAQqE,EAAA,SACZ,IAAIlG,EAAA,EAaJ,IAAIiG,MAAJ,sBAAyBD,EAAKnE,KAA9B,gBCvMZ,MAAO2E,EACT/E,WAAWL,EAAoDqF,GAC3D,OAAQrF,EAAOS,MACX,OACI4E,GAAYnF,GACR,+BACOA,GAAC,CACJoF,iBAAiB,EACjBC,uBAAuB,MAI/B,MACJ,OACIF,GAAYnF,GACR,+BACOA,GAAC,CAAEoF,iBAAiB,EACvBE,gBAAgB,EAChBlE,YAAatB,EAAO4E,SAI5B,MACJ,OACIS,GAAYnF,GACR,+BACOA,GAAC,CAAEqF,uBAAuB,EAC7BD,iBAAiB,EACjBE,gBAAgB,MAIxB,MACJ,OACIH,GAAYnF,GACR,+BACOA,GAAC,CACJsF,gBAAgB,EAChBlE,YAAatB,EAAO4E,SAI5B,MACJ,OACIS,GAAYnF,GACR,+BACOA,GAAC,CACJsF,gBAAgB,MAIxB,MACJ,OAEQH,GAAYnF,GACR,+BACOA,GAAC,CACJuF,cAAc,MAI1B,MACJ,QACQzF,EAAO0F,qBACPL,GAAYnF,GACR,+BACOA,GAAC,CACJuF,cAAc,Q,cCrDpC,MAAOE,EACTtF,WAAWL,EAAiBqF,GACxB,OAAQrF,EAAOS,MACX,QACI4E,GAAYnF,GACR,+BACOA,GAAC,CACJ0F,YAAY,MAGpB,MAEJ,QACIP,GAAYnF,GACR,+BACOA,GAAC,CACJ0F,YAAY,MAGpB,MAEJ,QACIP,GAAYnF,GACR,+BACOA,GAAC,CACJ2F,cAAe3G,KAAK4G,UAAU5F,EAAE2F,cAAe7F,EAAO6F,mBAG9D,MAEJ,QACIR,GAAYnF,GACR,+BACOA,GAAC,CACJ6F,aAAa,MAGrB,MAEJ,OACIV,GAAYnF,GACR,+BACOA,GAAC,CACJ6F,aAAa,EACbC,kBAAmB,CAAEC,qBAAsBjG,EAAOkG,cAG1D,MAEJ,QACIb,GAAYnF,GAER,+BACOA,GAAC,CACJ6F,aAAa,EACbF,cAAe3G,KAAK4G,UAAU5F,EAAE2F,cAAe7F,EAAO6F,mBAG9D,MAEJ,OACIR,GAAYnF,GACR,+BACOA,GAAC,CACJiG,UAAU,EACVC,eAAgB,SAGxB,MAEJ,OACIf,GAAYnF,GACR,+BACOA,GAAC,CACJiG,UAAU,EACVC,eAAgB,CACZrC,OAAQ/D,EAAO+D,YAI3B,MAEJ,QACIsB,GAAYnF,GACR,+BACOA,GAAC,CACJmG,cAAe,CACX5C,kBAAmBzD,EAAOyD,uBAItC,MAEJ,QACI4B,GAAYnF,GACR,+BACOA,GAAC,CACJmG,cAAe,SAGvB,MAEJ,QACIhB,GAAYnF,GACR,+BACOA,GAAC,CACJiG,UAAU,EACVN,cAAe,OAAF,wBACN3F,EAAE2F,eAAa,CAAE,CAAC7F,EAAOsG,aAAapD,IAAK,CAC1CA,GAAIlD,EAAOsG,aAAapD,GACxB/B,KAAMnB,EAAOsG,aAAanF,KAC1BsC,kBAAmBzD,EAAOsG,aAAa7C,kBACvC8C,iBAAiB,EACjBC,SAAUxG,EAAOsG,aAAaE,SAASC,KAAIC,GACvC,eACIC,QAAS,GACND,KAGXE,YAAa,GACbC,iBAAkB,KAClBC,oBAAqB,GACrBC,UAAW,KACXC,oBAAoB,SAKpC,MAEJ,QACI3B,GAAYnF,GACR,+BACOA,GAAC,CACJ+G,qBAAsBjH,EAAOkD,OAGrC,MAEJ,QACImC,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAE4C,YAAa5G,EAAO4G,gBAC/F,MAEJ,QACIvB,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAEuC,iBAAiB,MAC5F,MAEJ,QACIlB,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAEuC,iBAAiB,MAC5F,MAEJ,QACIlB,GAAYnF,IACRA,EAAI,OAAH,wBAAQA,GAAC,CAAE+G,qBAAsBjH,EAAOgE,iBACzC9E,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAEgD,oBAAoB,IACvE9G,KAEX,MAEJ,QACImF,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAEgD,oBAAoB,EAAOD,UAAW/G,EAAO+G,cACxH,MAEJ,QACI1B,GAAYnF,GAAKhB,KAAKiI,mBAAmBjH,EAAGF,EAAOgE,eAAgBoD,OAAOC,QAAQrH,EAAO2G,SAASF,KAAIa,IAC3F,CAAEpE,GAAIoE,EAAE,GAAIX,QAASW,EAAE,UAElC,MAEJ,QACIjC,GAAYnF,GACR,+BACOA,GAAC,CACJ6F,aAAa,EACbC,kBAAmB,KACnBK,cAAe,SAGvB,MAEJ,QACIhB,GAAYnF,GACR,+BACOA,GAAC,CACJ6F,aAAa,EACbC,kBAAmB,KACnBiB,qBAAsB,KACtBZ,cAAe,SAGvB,MAEJ,OACIhB,GAAYnF,GACR,+BACOA,GAAC,CACJ+G,qBAAsB,KACtBpB,cAAe,OAGvB,MAEJ,OACIR,GAAYnF,GAAKhB,KAAKgI,yBAAwB,+BACvChH,GAAC,CACJ+G,qBAAsBjH,EAAOgE,iBAC9BhE,EAAOgE,eAAgB,CAAE6C,iBAAkB,SAC9C,MAEJ,QACIxB,GAAYnF,IACRA,EAAI,OAAH,wBACMA,GAAC,CACJ+G,qBAAsBjH,EAAOgE,iBAEjC9D,EAAIhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2E,YAAa,CAC7E6C,mBAAoBxH,EAAOwH,qBAE3BxH,EAAOuE,YACPrE,EAAIhB,KAAKuI,gBAAgBvH,EAAGF,EAAOgE,eAAgBhE,EAAOuE,YAEvDrE,KAEX,MAEJ,QACImF,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAE6C,iBAAkB,MAC7F,MAEJ,QACIxB,GAAYnF,GAAKhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAE6C,iBAAkB,MAC7F,MAEJ,QACIxB,GAAYnF,IACRA,EAAIhB,KAAKgI,yBAAyBhH,EAAGF,EAAOgE,eAAgB,CAAE6C,iBAAkB,IACzE3H,KAAKuI,gBAAgBvH,EAAGF,EAAOgE,eAAgBhE,EAAOuE,cAEjE,MAEJ,QACIc,GAAYnF,GAAKhB,KAAKuI,gBAAgBvH,EAAGF,EAAOgE,eAAgB,CAAEH,OAAQ,cAA2BX,GAAIlD,EAAO2E,gBAChH,MAEJ,QACIU,GAAYnF,GAAKhB,KAAKuI,gBAAgBvH,EAAGF,EAAOgE,eAAgB,CAAEH,OAAQ,gBAA6BX,GAAIlD,EAAO2E,gBAClH,MAEJ,QACIU,GAAYnF,GAAKhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2E,YAAa,CAAE+C,aAAc,MAC9G,MAEJ,QACIrC,GAAYnF,GAAKhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2E,YAAa,CAAE+C,aAAc,MAC9G,MAEJ,QACIrC,GAAYnF,IACRA,EAAIhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2H,uBAAwB,CAAED,aAAc,IAC5GxH,EAAIhB,KAAK0I,gBAAgB1H,EAAGF,EAAOgE,eAAgBhE,EAAO2H,wBACnDzI,KAAKuI,gBAAgBvH,EAAGF,EAAOgE,eAAgBhE,EAAOuE,cAEjE,MAEJ,QACIc,GAAYnF,GAAKhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2E,YAAa,CAAEkD,aAAc,MAC9G,MAEJ,QACIxC,GAAYnF,GAAKhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO2E,YAAa,CAAEkD,aAAc,MAC9G,MAEJ,QACIxC,GAAYnF,IACRA,EAAIhB,KAAKqI,0BAA0BrH,EAAGF,EAAOgE,eAAgBhE,EAAO8H,sBAAuB,CAAED,aAAc,IACpG3I,KAAK0I,gBAAgB1H,EAAGF,EAAOgE,eAAgBhE,EAAO8H,2BAOrEZ,yBAAyBhH,EAAuB8D,EAAwB3E,GAC5E,OAAOH,KAAK6I,2BAA2B7H,EAAG8D,GAAgBgE,GAAQ,+BAAYA,GAAO3I,KAGjF0I,2BAA2B7H,EAAuB8D,EAAwBiE,GAC9E,sCACO/H,GAAC,CACJ2F,cAAe,OAAF,wBACN3F,EAAE2F,eAAa,CAAE,CAAC7B,GAAiBiE,EAAO/H,EAAE2F,cAAc7B,QAKjEuD,0BAA0BrH,EAAuB8D,EAAwBW,EAAqBtF,GAClG,OAAOH,KAAK6I,2BAA2B7H,EAAG8D,GAAgBgE,GACtD,+BACOA,GAAE,CACLlB,oBAAqB,OAAF,wBACZkB,EAAGlB,qBAAmB,CACzB,CAACnC,GAAY,gCACLqD,EAAGlB,qBAAuB,IAAInC,IAC/BtF,SAOfoI,gBAAgBvH,EAAuB8D,EAAwBkE,G,MAEnE,IAAItB,GAA6C,QAA/B,EAAA1G,EAAE2F,cAAc7B,UAAe,eAAE4C,cAAe,GAC9DuB,EAAWvB,EAAYwB,MAAKC,GAAKH,EAAEhF,IAAMmF,EAAEnF,KAK/C,OAJIiF,GACAvB,EAAYjH,OAAOiH,EAAYhH,QAAQuI,GAAW,GAEtDvB,EAAYlH,KAAI,+BAAMyI,GAAaD,IACnC,+BACOhI,GAAC,CACJ2F,cAAe,OAAF,wBACN3F,EAAE2F,eAAa,CAAE,CAAC7B,GAAe,+BAC7B9D,EAAE2F,cAAc7B,IAAe,CAClC4C,YAAaA,QAMrBgB,gBAAgB1H,EAAuB8D,EAAwBW,G,MAEnE,IAAIiC,GAA6C,QAA/B,EAAA1G,EAAE2F,cAAc7B,UAAe,eAAE4C,cAAe,GAC9DuB,EAAWvB,EAAYwB,MAAKC,GAAK1D,GAAe0D,EAAEnF,KAEtD,OADA0D,EAAYjH,OAAOiH,EAAYhH,QAAQuI,GAAW,GAClD,+BACOjI,GAAC,CACJ2F,cAAe,OAAF,wBACN3F,EAAE2F,eAAa,CAAE,CAAC7B,GAAe,+BAC7B9D,EAAE2F,cAAc7B,IAAe,CAClC4C,YAAaA,QAMrBO,mBAAmBjH,EAAuB8D,EAAwBsE,G,MAEtE,IAAIC,EAAc,IAAIC,MAAoC,QAA/B,EAAAtI,EAAE2F,cAAc7B,UAAe,eAAEwC,WAAY,IAAIC,KAAIC,GAAK,CAACA,EAAExD,GAAIwD,MAC5F,IAAK,IAAI9B,KAAQ0D,EACbC,EAAYE,IAAI7D,EAAK1B,GAAE,+BAAOqF,EAAYrH,IAAI0D,EAAK1B,KAAQ0B,IAE/D,sCACO1E,GAAC,CACJ2F,cAAe,OAAF,wBACN3F,EAAE2F,eAAa,CAAE,CAAC7B,GAAe,+BAC7B9D,EAAE2F,cAAc7B,IAAe,CAClCwC,SAAUkC,MAAMC,KAAKJ,EAAYK,gBAMzC9C,UAAUW,EAA0CoC,GACxD,IAAIhD,EAAqD,GACzD,IAAK,IAAIiD,KAAKD,EAAI,CACd,IAAIvC,EAAY,2DACTwC,GAAC,CAEJvC,iBAAiB,EACjBK,YAA0B,GAC1BE,oBAAqB,GACrBE,oBAAoB,IAEjBP,EAAIqC,EAAE5F,KAAG,CACZsD,SAAUsC,EAAEtC,SAASC,KAAIsC,I,QACrB,IAAIrC,EAAuB,QAAnB,EAAS,QAAT,EAAAD,EAAIqC,EAAE5F,WAAG,eAAEsD,gBAAQ,eAAE4B,MAAK1B,GAAKA,EAAExD,IAAM6F,EAAE7F,KACjD,oDACO6F,GAAC,CACJpC,QAAS,IACND,QAIfb,EAAciD,EAAE5F,IAAMoD,EAE1B,OAAOT,G,wBC3Yf,MAAMmD,EAAqB,qBACrBC,EAAgB,gBAChBC,EAAgB,gBAChBC,EAAuB,uBAuCvB,MAAOC,EAEoB,sBAAIhJ,GAC7B,IAAIW,QAAW,QAA6B,kBAAmB,EAAG,CAC9DsI,QAAQtI,EAAIuI,EAAoBC,GACxBD,EAAa,GACDvI,EAAGyI,kBAAkBR,EAAoB,CAAES,QAAS,OAC1DC,YAAY,oBAAqB,qBAEvCJ,EAAa,GACDvI,EAAGyI,kBAAkBP,EAAe,CAAEQ,QAAS,OACrDE,IAZkC,CAAEzG,GAAI,EAAG0G,+BAAgC,KAAMC,aAAc,GAAIC,YAAa,OActHR,EAAa,GACDvI,EAAGyI,kBAAkBN,EAAe,CAAEO,QAAS,CAAC,iBAAkB,oBACxEC,YAAY,iBAAkB,kBAEpCJ,EAAa,IACTvI,EAAGgJ,iBAAiBC,SAASb,IAC7BpI,EAAGkJ,kBAAkBd,GAEbpI,EAAGyI,kBAAkBL,EAAsB,CAAEM,QAAS,OAC5DC,YAAY,iBAAkB,sBAIhD,IACI,aAAatJ,EAAGW,GADpB,QAIIA,EAAGmJ,SAIW,yBAClB,aAAahL,KAAKiL,iBAAgBpI,MAAAA,IACvB,EAAAqI,EAAA,SAA4BrJ,EAAGsJ,OAAOrB,IAAsBF,GAAKA,EAAE3H,SAIjE,kBAAC+B,EAAYkB,GAC1B,IAAKA,EAAS1D,OACV,OAEJ,IAAI4J,EAASlG,EACRqC,KAAIsC,GACI,+BACEA,GAAC,CACJ/E,eAAgBd,MAI5B,aAAahE,KAAKiL,iBAAgBpJ,IAC9B,MAAMwJ,GAAY,QAAqBxJ,GACvC,OAAO,IAAIyJ,SAAQ,CAACC,EAASC,KACzB,MAAMC,EAAKJ,EAAUK,YAAY1B,EAAe,aAChDyB,EAAGE,QAAUvK,IACTC,QAAQC,MAAM,qBAAsBF,EAAKqK,EAAGnK,OAC5CkK,EAAOC,EAAGnK,QAEdmK,EAAGG,WAAa,KACZL,KAEJ,IAAK,IAAInG,KAAKgG,EAAQ,CAClB,IAAIxG,EAAU6G,EAAGI,YAAY7B,GAAe8B,IAAI1G,GAChDR,EAAQ+G,QAAUI,IACY,mBAAtBnH,EAAQtD,MAAMW,MACdZ,QAAQ2K,IAAR,iBAAsB5G,EAAE6G,eAAxB,6BAA2DjI,EAA3D,yBAAsF+H,EAAInH,EAAQtD,OAClGyK,EAAGG,iBACHH,EAAGI,mBAEH9K,QAAQC,MAAR,iBAAwB8D,EAAE6G,eAA1B,6BAA6DjI,EAA7D,qCAAoG+H,EAAInH,EAAQtD,eAQjG,0CACnC,aAAatB,KAAKiL,iBAAgBpI,MAAAA,IAC9B,IAAIuJ,QAAiBvK,EAAGG,IAAI+H,EAAe,GAC3C,GAAIqC,EAAS1B,+BACT,OAAO0B,EAAS1B,+BAEf,CACD,IAAI2B,cAAmBrM,KAAKsM,mBAC5B,OAAID,EAAI7K,OACG6K,EAAI,GAAGrI,GAEX,SAKoB,wCAACA,GACpC,aAAahE,KAAKiL,iBAAgBpI,MAAAA,IAC9B,IAAIuJ,QAAiBvK,EAAGG,IAAI+H,EAAe,GAC3CqC,EAAS1B,+BAAiC1G,QACpCnC,EAAG4I,IAAIV,EAAeqC,MAId,uBAACzF,GAInB,aAAa3G,KAAKiL,iBAAgBpI,MAAAA,IAC9B,IAAIoG,QAAyCpH,EAAGsJ,OAAOrB,GACvD,IAAK,IAAID,KAAKZ,EAASsD,QAAOnE,IAAMzB,EAAc6F,MAAKrD,GAAKf,EAAEpE,KAAOmF,EAAEnF,aAC7DnC,EAAG4K,OAAO3C,EAAoBD,EAAE7F,IAE1C,IAAI0I,EAAmB,GACvB,IAAK,IAAI7C,KAAKlD,EAAe,CACzB,IAAIgG,EAAK1D,EAASC,MAAKC,GAAKA,EAAEnF,IAAM6F,EAAE7F,KACjC2I,GACDD,EAAOlM,KAAKqJ,EAAE7F,IAElB,IAAI4I,EAAW,OAAH,wBACLD,GAAE,CAAE1K,KAAM4H,EAAE5H,KAAMqF,SAAUuC,EAAEvC,SAAUtD,GAAI6F,EAAE7F,GACjDO,kBAAmBsF,EAAEtF,0BAEnB1C,EAAG4I,IAAIX,EAAoB8C,GAErC,OAAOF,KAIM,sBAAC/C,GAClB,aAAa3J,KAAKiL,iBAAgBpI,MAAAA,UACnBhB,EAAGG,IAAI8H,EAAoBH,EAAG3F,WAC/BnC,EAAGiK,IAAIhC,EAAoBH,MAKxB,sBAAC3F,GAClB,aAAahE,KAAKiL,iBAAgBpI,MAAAA,SACIhB,EAAGG,IAAI8H,EAAoB9F,KAI1C,4BAACA,GACxB,aAAahE,KAAKiL,iBAAgBpI,MAAAA,SACIhB,EAAGgL,aAAa/C,EAAoB,oBAAqB9F,KAIlF,kBAACA,GACd,aAAahE,KAAKiL,iBAAgBpI,MAAAA,SACjBhB,EAAGiL,gBAAgB9C,EAAe,iBAAkBhG,KAI9D,cACP,aAAahE,KAAKiL,iBAAgBpI,MAAAA,UACxBhB,EAAGkL,MAAM/C,SACTnI,EAAGkL,MAAMjD,SACTjI,EAAG4I,IAAIV,EA/JmC,CAAE/F,GAAI,EAAG0G,+BAAgC,KAAMC,aAAc,GAAIC,YAAa,UAmKlH,qBAACpI,GACjB,aAAaxC,KAAKiL,iBAAgBpI,MAAAA,WACThB,EAAGG,IAAI+H,EAAe,IAC1BY,cAAgB,IAAIzB,MAAK8D,GAAKA,EAAEzL,OAASiB,MAIpC,+BAACA,EAAmCE,EAAeC,GAC7E,aAAa3C,KAAKiL,iBAAgBpI,MAAAA,IAC9B,MAAM4I,EAAK5J,EAAG6J,YAAY3B,EAAe,YAAa,CAAEkD,WAAY,WACpE,IAAIb,QAAiBX,EAAG/J,MAAMM,IAAI,GAC7BoK,EAASzB,eACVyB,EAASzB,aAAe,IAE5B,IAAI1B,EAAWmD,EAASzB,aAAazB,MAAK8D,GAAKA,EAAEzL,OAASiB,IAC1D,GAAKyG,EAME,IAAIA,EAAShD,WAAatD,EAO7B,OAFAtB,QAAQC,MAAR,kCAAyCkB,EAAzC,8CACMiJ,EAAGyB,MACF,EANPjE,EAASvG,MAAQA,EACjBuG,EAAShD,iBAPTmG,EAASzB,aAAanK,KAAK,CACvByF,UAAW,EACX1E,KAAMiB,EACNE,MAAOA,IAaf,aAFM+I,EAAG/J,MAAM+I,IAAI2B,SACbX,EAAGyB,MACF,KAIK,qBAAC9K,GACjB,aAAapC,KAAKiL,iBAAgBpI,MAAAA,IAC9B,MAAM4I,EAAK5J,EAAG6J,YAAY3B,EAAe,aACzC,IAAIqC,QAAiBX,EAAG/J,MAAMM,IAAI,GAClCoK,EAASxB,YAAcxI,QACjBqJ,EAAG/J,MAAM+I,IAAI2B,SACbX,EAAGyB,QAIG,uBAChB,aAAalN,KAAKiL,iBAAgBpI,MAAAA,IAC9B,MAAM4I,EAAK5J,EAAG6J,YAAY3B,EAAe,YACzC,IAAIqC,QAAiBX,EAAG/J,MAAMM,IAAI,GAClC,OAAOoK,MAAAA,OAAQ,EAARA,EAAUxB,eAIH,yBAClB,aAAa5K,KAAKiL,iBAAgBpI,MAAAA,IAC9B,MAAM4I,EAAK5J,EAAG6J,YAAY3B,EAAe,aACzC,IAAIqC,QAAiBX,EAAG/J,MAAMM,IAAI,GAClCoK,EAASxB,YAAc,KACvBwB,EAASzB,aAAe,SAClBc,EAAG/J,MAAM+I,IAAI2B,SACbX,EAAGyB,QAIuB,2CACpC,aAAalN,KAAKiL,iBAAgBpI,MAAAA,SAChBhB,EAAGsJ,OAAOlB,KAIR,yBAACnF,EAAwBW,GAC7C,aAAazF,KAAKiL,iBAAgBpI,MAAAA,IAC9B,IAAIqC,EAAWrD,EAAGiL,gBAAgB9C,EAAe,iBAAkBlF,GACnE,aAAcI,GAAUgE,MAAK9D,GAAKA,EAAEC,WAAaD,EAAEC,UAAUrB,IAAMyB,OAIhD,4BAACX,EAAwBW,GAChD,aAAazF,KAAKiL,iBAAgBpI,MAAAA,IAC9B,IAAIqC,QAAkCrD,EAAGiL,gBAAgB9C,EAAe,iBAAkBlF,GACtFU,EAASN,EAASgE,MAAK9D,GAAKA,EAAEC,WAAaD,EAAEC,UAAUrB,IAAMyB,IACjE,OAAKD,EASD,MADqBN,EAASgE,MAAK9D,GAAKA,EAAEqD,wBAA0BhD,IAE7D,CAAED,OAAQA,EAAQb,OAAQ,GAGjC,MADmBO,EAASgE,MAAK9D,GAAKA,EAAEwD,uBAAyBnD,IAE1D,CAAED,OAAQA,EAAQb,OAAQ,GAE9B,CAAEa,OAAQA,EAAQb,OAAQ,UAfuB9C,EAAGiL,gBAAgB7C,EAAsB,iBAAkBnF,IAC3EoE,MAAK9D,GAAKA,EAAEpB,IAAMyB,IAE3C,CAAED,OAAQ,KAAMb,OAAQ,GAE5B,CAAEa,OAAQ,KAAMb,OAAQ,MAcY,wDAACG,GACpD,aAAa9E,KAAKiL,iBAAgBpI,MAAAA,SACjBhB,EAAGiL,gBAAgB7C,EAAsB,iBAAkBnF,KAIhD,iCAACqI,GAC7B,aAAanN,KAAKiL,iBAAgBpI,MAAAA,IAC9BhB,EAAGiK,IAAI7B,EAAsBkD,MAIM,4CAACnJ,SAClChE,KAAKiL,iBAAgBpI,MAAAA,IACvBhB,EAAG4K,OAAOxC,EAAsBjG,O,sDC/TtC,MAAOoJ,EAETxN,YAAoB8B,EACRG,EACAwL,EACAC,EACAC,EACA5L,GALQ,KAAAD,MAAAA,EACR,KAAAG,GAAAA,EACA,KAAAwL,qBAAAA,EACA,KAAAC,qBAAAA,EACA,KAAAC,2BAAAA,EACA,KAAA5L,OAAAA,EAIe,8BACvB,WAAY,EAAA6L,EAAA,MAAgBC,UAGxB,OAFAzN,KAAK2B,OAAO+L,WACZ1N,KAAKqN,qBAAqBM,2BAG9B,IAAIC,QAAoB5N,KAAKsN,qBAAqBO,oBAClD7N,KAAK2B,OAAO+L,MACRE,UACM5N,KAAKuN,2BAA2BO,wBAClC,wBAAyBC,OACzBA,OAAOC,qBAAoB,KACvBhO,KAAKiO,yCAITjO,KAAKiO,uCAKqC,iDAClD,GAAI,kBAAmBC,WAAa,gBAAiBH,OAAQ,CACzD,IAAII,QAAYD,UAAUE,cAAcC,aAC7BrO,KAAK6B,GAAGyM,sCAAsC9M,eAC/C2M,EAAII,KAAKC,SAAS,KACxBnN,QAAQ2K,IAAI,+BAKhBiC,sCACJjO,KAAKyO,2CACAC,OAAMtN,GAAOC,QAAQC,MAAMF,MClDlC,MAAOuN,EACTxN,WAAWL,EAAsCqF,GAC7C,OAAQrF,EAAOS,MACX,QACI4E,GAAYnF,GACR,+BACOA,GAAC,CACJ8D,eAAgBhE,EAAOgE,eACvB8J,YAAa9N,EAAO8N,kBCExC,kBAAmBV,WACnBH,OAAOc,iBAAiB,QAAQhM,UAC5BqL,UAAUE,cAAcI,SAAS,WAAWM,MAAKC,QAC9CL,OAAMM,IACL3N,QAAQ2K,IAAI,2BAA4BgD,SAKpDnM,iBACI,MAAMnB,EAAQ,IAAI5B,GAAM,KACb,CACHmP,QAAS,CACL3I,gBAAgB,EAChBF,iBAAiB,EACjBC,uBAAuB,EACvBE,cAAc,EACdnE,YAAa,MAEjBuE,cAAe,CACXE,aAAa,EACbC,kBAAmB,KACnBG,UAAU,EACVC,eAAgB,KAChBP,cAAe,GACfD,YAAY,EACZqB,qBAAsB,KACtBZ,cAAe,MAEnB+H,wBAAyB,CACrBN,YAAa,GACb9J,eAAgB,UAIxB,kBAAmBoJ,WACnBA,UAAUE,cAAcS,iBAAiB,WAAW9C,I,MAChD,GAAqB,kBAAV,QAAP,EAAAA,EAAGoD,YAAI,eAAE5N,MAAyB,CAClC,IAAI6N,EAAMrD,EAAGoD,KAAKC,IAClB1N,EAAMb,SAASuO,OAI3B,MAAMC,EAAgB,IAAIC,EAAA,GAA0B5N,GAC9CC,EAAS,IAAI,KAAO0N,EAAkD,IAAI,MAC1ExN,EAAK,IAAIqI,EACfxI,EAAMf,WAAW,UAAW,IAAIuF,GAChCxE,EAAMf,WAAW,gBAAiB,IAAI8F,GACtC/E,EAAMf,WAAW,0BAA2B,IAAIgO,GAEhD,MAAM7M,EAAmB,IAAIK,EAAiBN,GACxCD,EAAY,IAAImC,EAAUjC,GAE1ByN,EAAiB,IAAI9N,EAAeC,EACtCC,EACAC,EACAC,EACAC,GACJuN,EAAcG,kBAAkBD,SFd9B,SAA6CA,GAC/C,OAAOA,EAAevN,IAAI,+BACtBuN,GAAkB,IAAInC,EAA4BmC,EAAe7N,MAC7D6N,EAAe1N,IACf,OAA4B0N,IAC5B,QAA4BA,IAC5B,QAAuCA,GACvCA,EAAe5N,UESjB8N,CAAmCF,GAAgBG,wBAG7DhC,GAAMgB,OAAMtN,GAAOC,QAAQC,MAAMF,M,qBC9EjC,IAAYwE,E,gCAAZ,SAAYA,GACR,kBACA,kBAFJ,CAAYA,IAAAA,EAAW,M,kECIjB,SAAU4H,IACZ,OAAO,IAAIlC,SAAQ,CAACC,EAASC,KAEzB,GADuB,cAAeuC,OAChB,CAClB,MAAM4B,GAAa,SACnB,IAAIvL,EAAM2J,OAAO6B,UAAUC,KAAKF,EAAY,GAC5CvL,EAAI0L,UAAY,KACZvE,EAAQ,CACJkC,WAAW,IAEfrJ,EAAI2L,OAAO/E,QACX+C,OAAO6B,UAAUI,eAAeL,IAEpCvL,EAAIuH,QAAU,KACVJ,EAAQ,CACJkC,WAAW,UAInBlC,EAAQ,CACJkC,WAAW,S,6ICpBrB,MAAOwC,UAAyBC,YAGlCtQ,cACIuQ,QAGJC,YAAYb,GACRvP,KAAKqN,sBAAuB,OAA4BkC,GAG5Dc,oBACIrQ,KAAKsQ,UCfF,mcDgBH,EAAA9C,EAAA,KAAesB,MAAK9B,IACZA,EAAES,WACFzN,KAAKqN,qBAAqBkD,iCAMtCC,yBAIJC,eAAeC,OAAO,wBAAyBT,GEtBxC,MAAMU,EAAyB,oBAGtC,IAAYC,EAYZ,SAASC,EAAoCC,GACzC,IAAIC,EAAiC,uCAAuCC,KAAKF,GACjF,OAAIC,EAEO,CACHxM,kBAF4BwM,EAA+B,IAK5D,MApBX,SAAYH,GACR,gBACA,cACA,UACA,uCACA,6BACA,iCACA,4CACA,iCACA,iCATJ,CAAYA,IAAAA,EAAK,KAkCX,MAAOtB,EACT1P,YAAoB8B,GAAA,KAAAA,MAAAA,EAIpB8N,kBAAkBD,GACdvP,KAAKuP,eAAiBA,EAGgB,qCACtC,MAAM,iBAAE0B,SAA2B,sDACnC,IAAIC,EAAY,IAAID,EAEpB,OADAC,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAGE,cAACC,EAAmBC,EAAsBzP,GACnD,OAAQyP,GACJ,KAAKR,EAAMS,KACP,MAAM,KAAEA,SAAe,6BACvB,IAAIH,EAAY,IAAIG,EAEpB,OADAH,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EACX,KAAKN,EAAMX,iBAAkB,CACzB,IAAIiB,EAAY,IAAIjB,EAEpB,OADAiB,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAEX,KAAKN,EAAMU,MAAO,CACd,MAAM,MAAEA,SAAgB,8BACxB,IAAIJ,EAAY,IAAII,EAEpB,OADAJ,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAEX,KAAKN,EAAMW,YAAa,CACpB,MAAM,mBAAEC,SAA6B,8BACrC,IAAIN,EAAY,IAAIM,EAEpB,OADAN,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,GAGf,IAAKlR,KAAK0B,MAAMvB,MAAM8O,QAAQ3I,eAAgB,CAC1C,IAAImL,EAAgBZ,EAAoCO,GACxD,GAAIK,EAAe,CACf,IAAIjK,EAAI,IAAIkK,gBACZlK,EAAE+B,IAAIoH,EAAwBc,EAAclN,mBAC5C5C,EAAOgQ,SAAP,UAAmBf,EAAMU,MAAzB,YAAkC9J,GAAK,MAAM,QAG7C7F,EAAOgQ,SAAP,UAAmBf,EAAMU,OAAS,MAAM,GAE5C,OAAO,EAEX,OAAQF,GACJ,KAAKR,EAAMgB,mBAAoB,CAC3B,MAAM,uBAAEC,SAAiC,8DACzC,IAAIX,EAAY,IAAIW,EAEpB,OADAX,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAEX,KAAKN,EAAMkB,wBAAyB,CAChC,MAAM,4BAAEC,SAAsC,uEAC9C,IAAIb,EAAY,IAAIa,EAEpB,OADAb,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAEX,KAAKN,EAAMoB,cAAe,CACtB,MAAM,cAAEA,SAAwB,6BAChC,IAAId,EAAY,IAAIc,EAEpB,OADAd,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,GAGf,GAAIE,EAAaa,WAAWrB,EAAMsB,eAAgB,CAC9C,MAAM,0BAAEC,SAAoC,sDAC5C,IAAIjB,EAAY,IAAIiB,EAEpB,OADAjB,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,EAEX,IAAIkB,EAAsCvB,EAAoCO,GAC9E,GAAIgB,EAAqC,CACrC,IAAIlB,QAAkBlR,KAAKqS,+BAE3B,OADAnB,EAAUoB,mBAAmBF,EAAoC7N,mBAC1D2M,EAEX,IAAIqB,EAhGZ,SAAsDzB,GAClD,IAAI0B,EAAe,4DAA4DxB,KAAKF,GACpF,OAAI0B,EAEO,CACHjO,kBAF4BiO,EAAa,IAK1C,KAwFkBC,CAA6CrB,GAClE,GAAImB,EAAgB,CAChB,MAAM,mBAAEG,SAA6B,qDACrC,IAAIxB,EAAY,IAAIwB,EAGpB,OAFAxB,EAAUd,YAAYpQ,KAAKuP,gBAC3B2B,EAAUoB,mBAAmBC,EAAehO,mBACrC2M,EAEX,IAAIyB,EAA0C,sEAAsE3B,KAAKI,GACzH,GAAIuB,EAAyC,CACzC,IAAIpO,EAAoBoO,EAAwC,GAC5DlN,EAAckN,EAAwC,GAC1D,MAAM,cAAEC,SAAwB,8DAChC,IAAI1B,EAAY,IAAI0B,EAGpB,OAFA1B,EAAUd,YAAYpQ,KAAKuP,gBAC3B2B,EAAUoB,mBAAmB/N,EAAmBkB,GACzCyL,EAEX,IAAIA,QAAkBlR,KAAKqS,+BAE3B,OADAnB,EAAUd,YAAYpQ,KAAKuP,gBACpB2B,K,qBCpHf,IAAY2B,E,gCAAZ,SAAYA,GACR,4CACA,wBACA,4BAHJ,CAAYA,IAAAA,EAAe,M,2GClBrB,MAAOC,EAETlT,cADS,KAAA2B,KAAI,GAMX,MAAOwR,EAETnT,cADS,KAAA2B,KAAI,GAMX,MAAOyR,EAETpT,YAAmB8F,GAAA,KAAAA,KAAAA,EADV,KAAAnE,KAAI,GAMX,MAAO0R,EAETrT,YAAmB8F,GAAA,KAAAA,KAAAA,EADV,KAAAnE,KAAI,GAMX,MAAO2R,EAETtT,cADS,KAAA2B,KAAI,GAMX,MAAO4R,EAETvT,cADS,KAAA2B,KAAI,GAaX,MAAO6R,EAETxT,YAAoB8B,EACRE,EACAE,EACAuL,EACAxL,GAJQ,KAAAH,MAAAA,EACR,KAAAE,UAAAA,EACA,KAAAE,iBAAAA,EACA,KAAAuL,qBAAAA,EACA,KAAAxL,GAAAA,EAGW,0BACnB,IAAI6D,QAAa1F,KAAK8B,iBAAiBE,MACvC,QAAK0D,IAGL1F,KAAK0B,MAAMb,SAAS,IAAIoS,EAAmBvN,IAC3C1F,KAAKqT,eACE,GAGM,oBACb,UACyBrT,KAAK4B,UAAUyR,cAExC,MAAOjL,GACH,GAAIA,aAAa,IAA2B,CACxC,IAAIhG,QAAoBpC,KAAK8B,iBAAiBE,MACzCoG,EAAEvI,cAAgBuC,EAAYb,MAAQ,mBAGjCvB,KAAK8B,iBAAiBiL,QAC5BgB,OAAOuF,SAASC,eAGfnL,aAAa,KAClBpI,KAAK0B,MAAMb,SAAS,IAAIsS,IAKjB,sBACf,IAAKnT,KAAK0B,MAAMvB,MAAM8O,QAAQ3I,eAAgB,CAC1C,IAAIlE,EAAc,CACd4B,IAAI,SACJC,QAAQ,SACR1C,KAAM,YAEVvB,KAAK0B,MAAMb,SAAS,IAAIiS,GACxB,IAAI1O,QAAYpE,KAAK4B,UAAU4R,cAAcpR,EAAY4B,GAAI5B,EAAY6B,QAQzE,OAPKG,EAAID,SAILnE,KAAK0B,MAAMb,SAAS,IAAImS,EAAe5Q,UACjCpC,KAAK8B,iBAAiByH,IAAInH,IAJhCpC,KAAK0B,MAAMb,SAAS,IAAIkS,GAMrB3O,EAAID,QAEf,OAAO,EAGC,qBACFnE,KAAK8B,iBAAiBiL,cACtB/M,KAAK6B,GAAGkL,QACd/M,KAAK0B,MAAMb,SAAS,IAAIqS,GACxBlT,KAAKqN,qBAAqBoG,iBAI5B,SAAUC,EAA4BnE,GACxC,OAAOA,EAAevN,IAAI,wBACtBuN,GAAkB,IAAI6D,EAAqB7D,EAAe7N,MACtD6N,EAAe3N,UACf2N,EAAezN,kBACf,OAA4ByN,GAC5BA,EAAe1N,Q,8EChIrB,MAAO8R,EAET/T,cADS,KAAA2B,KAAI,IAMX,MAAOqS,EAEThU,YAAmB+G,GAAA,KAAAA,cAAAA,EADV,KAAApF,KAAI,IAMX,MAAOsS,EAETjU,YAAmB4G,GAAA,KAAAA,oBAAAA,EADV,KAAAjF,KAAI,IAWX,MAAOuS,EACTlU,YAAoB8B,EACRE,EACAyL,EACAxL,GAHQ,KAAAH,MAAAA,EACR,KAAAE,UAAAA,EACA,KAAAyL,qBAAAA,EACA,KAAAxL,GAAAA,EAImB,gCAACkS,GAC5B,IAAI/P,QAAWhE,KAAK6B,GAAGmS,oCACvB,QAAIhQ,UACMhE,KAAKqN,qBAAqB4G,yBAAyBjQ,EAAI+P,IACtD,GAKY,8BACvB/T,KAAK0B,MAAMb,SAAS,IAAI8S,GACxB,MAAMO,EAAalU,KAAK4B,UAAUuS,yBAElC,IAAIxN,QAAsB3G,KAAK6B,GAAGyK,mBAClCtM,KAAK0B,MAAMb,SAAS,IAAI+S,EAAkBjN,IAC1C,IACI,IAAIyN,QAAcF,QACZlU,KAAK6B,GAAGwS,iBAAiBD,EAAM7M,KAAIa,IAC9B,CACHpE,GAAIoE,EAAEpE,GACN/B,KAAMmG,EAAEnG,KACRqF,SAAUc,EAAEd,SACZ/C,kBAAmB6D,EAAE7D,uBAG7BvE,KAAK0B,MAAMb,SAAS,IAAI+S,EAAkBQ,IAE9C,MAAOhM,GACCA,aAAa,IACbpI,KAAK0B,MAAMb,SAAS,IAAIgT,GAA6B,IAGrD7T,KAAK0B,MAAMb,SAAS,IAAIgT,GAA6B,MAM/D,SAAUS,EAAuC/E,GACnD,OAAOA,EAAevN,IAAI,mCACtBuN,GAAkB,IAAIuE,EAClBvE,EAAe7N,MACf6N,EAAe3N,WACf,OAA4B2N,GAC5BA,EAAe1N,Q,kFCnFrB,MAAO0S,EACT3U,YAAoB+B,EAAqCE,EAC7CH,GADQ,KAAAC,OAAAA,EAAqC,KAAAE,GAAAA,EAC7C,KAAAH,MAAAA,EAGZ6O,8BACIvQ,KAAK2B,OAAO6S,UACZzG,OAAOuF,SAASmB,KAAO,GAG3BC,eACI1U,KAAK2B,OAAOgQ,SAAS,UAAY,MAErC8B,cAAcM,GACV/T,KAAK2B,OAAOgQ,SAAS,WAAa,KAAMoC,GAE5CY,sBAAsBpQ,GAClB,IAAIiD,EAAI,IAAIkK,gBACZlK,EAAE+B,IAAI,KAAwBhF,GAC9BvE,KAAK2B,OAAOgQ,SAAZ,UAAwB,mBAAxB,YAA+CnK,GAAK,MAAM,GAE9DmG,2BACI3N,KAAK2B,OAAOgQ,SAAS,sBAAwB,MAEjDA,SAASiD,GACL5U,KAAK2B,OAAOgQ,SAASiD,EAAM,MAED,+BAAC5Q,EAAY+P,GACvC,IAAIpK,QAAW3J,KAAK6B,GAAGgT,gBAAgB7Q,GACvC,IAAI2F,EAAGpF,kBAIP,MAAM,IAAIoB,MAAM,gEAHZ3F,KAAK8U,wCAAwCnL,EAAGpF,kBAAmBwP,GAM3Ee,wCAAwCvQ,EAA2BwP,GAC/D/T,KAAK2B,OAAOgQ,SAAZ,0BAAwCpN,GAAqB,KAAMwP,GAGvEgB,kBAAkBjQ,EAAwBd,EAAY+P,GAClD,IAAIpK,EAAK3J,KAAK0B,MAAMvB,MAAMwG,cAAcA,cAAc7B,GACtD,IAAI6E,EAAGpF,kBAIP,MAAM,IAAIoB,MAAM,0EAHZ3F,KAAK2B,OAAOgQ,SAAZ,0BAAwChI,EAAGpF,kBAA3C,wBAA4EP,GAAM,KAAM+P,IAO9F,SAAUiB,EAA4BzF,GACxC,OAAOA,EAAevN,IAAI,wBACtBuN,GAAkB,IAAIgF,EAAqBhF,EAAe5N,OAAQ4N,EAAe1N,GAAI0N,EAAe7N,W,qDCzDrG,MAAMuT,EAAiC,+B,qBCAxC,SAAUC,EAA2CC,EAAiBC,GACxE,OAAOD,EAAWE,MAAK,CAACjQ,EAAG4D,IAAMoM,EAAYhQ,GAAGkQ,cAAcC,cAAcH,EAAYpM,GAAGsM,iB,kCCA3FE,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,IAOV,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,QAIfJ,EAAoBtI,EAAI4I,EjCzBpB1W,EAAW,GACfoW,EAAoBO,EAAI,SAASjG,EAAQkG,EAAUC,EAAIC,GACtD,IAAGF,EAAH,CAMA,IAAIG,EAAeC,EAAAA,EACnB,IAASC,EAAI,EAAGA,EAAIjX,EAASmC,OAAQ8U,IAAK,CACrCL,EAAW5W,EAASiX,GAAG,GACvBJ,EAAK7W,EAASiX,GAAG,GACjBH,EAAW9W,EAASiX,GAAG,GAE3B,IAJA,IAGIC,GAAY,EACPC,EAAI,EAAGA,EAAIP,EAASzU,OAAQgV,MACpB,EAAXL,GAAsBC,GAAgBD,IAAajO,OAAOuO,KAAKhB,EAAoBO,GAAGU,OAAM,SAASC,GAAO,OAAOlB,EAAoBO,EAAEW,GAAKV,EAASO,OAC3JP,EAASxV,OAAO+V,IAAK,IAErBD,GAAY,EACTJ,EAAWC,IAAcA,EAAeD,IAG7C,GAAGI,EAAW,CACblX,EAASoB,OAAO6V,IAAK,GACrB,IAAIM,EAAIV,SACEN,IAANgB,IAAiB7G,EAAS6G,IAGhC,OAAO7G,EAzBNoG,EAAWA,GAAY,EACvB,IAAI,IAAIG,EAAIjX,EAASmC,OAAQ8U,EAAI,GAAKjX,EAASiX,EAAI,GAAG,GAAKH,EAAUG,IAAKjX,EAASiX,GAAKjX,EAASiX,EAAI,GACrGjX,EAASiX,GAAK,CAACL,EAAUC,EAAIC,IkCJ/BV,EAAoBoB,EAAI,SAASf,GAChC,IAAIgB,EAAShB,GAAUA,EAAOiB,WAC7B,WAAa,OAAOjB,EAAgB,SACpC,WAAa,OAAOA,GAErB,OADAL,EAAoBtM,EAAE2N,EAAQ,CAAE1R,EAAG0R,IAC5BA,GCLRrB,EAAoBtM,EAAI,SAAS0M,EAASmB,GACzC,IAAI,IAAIL,KAAOK,EACXvB,EAAoBwB,EAAED,EAAYL,KAASlB,EAAoBwB,EAAEpB,EAASc,IAC5EzO,OAAOgP,eAAerB,EAASc,EAAK,CAAEQ,YAAY,EAAMnV,IAAKgV,EAAWL,MCJ3ElB,EAAoB2B,EAAI,GAGxB3B,EAAoBrN,EAAI,SAASiP,GAChC,OAAO/L,QAAQgM,IAAIpP,OAAOuO,KAAKhB,EAAoB2B,GAAGG,QAAO,SAASC,EAAUb,GAE/E,OADAlB,EAAoB2B,EAAET,GAAKU,EAASG,GAC7BA,IACL,MCNJ/B,EAAoBgC,EAAI,SAASJ,GAEhC,MAAY,CAAC,GAAK,uBAAuB,GAAK,uBAAuB,GAAK,uBAAuB,GAAK,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,wBAAwBA,GAAW,cCF5a5B,EAAoBiC,SAAW,SAASL,GAEvC,OAAYA,EAAU,IAAM,CAAC,GAAK,uBAAuB,GAAK,uBAAuB,GAAK,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,uBAAuB,IAAM,wBAAwBA,GAAW,QCHzU5B,EAAoBkC,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAO5X,MAAQ,IAAI6X,SAAS,cAAb,GACd,MAAOzP,GACR,GAAsB,iBAAX2F,OAAqB,OAAOA,QALjB,GCAxB0H,EAAoBwB,EAAI,SAASa,EAAKC,GAAQ,OAAO7P,OAAO8P,UAAUC,eAAe3X,KAAKwX,EAAKC,IvCA3FzY,EAAa,GACbC,EAAoB,gBAExBkW,EAAoByC,EAAI,SAASnV,EAAKmK,EAAMyJ,EAAKU,GAChD,GAAG/X,EAAWyD,GAAQzD,EAAWyD,GAAKvC,KAAK0M,OAA3C,CACA,IAAIiL,EAAQC,EACZ,QAAWxC,IAARe,EAEF,IADA,IAAI0B,EAAUC,SAASC,qBAAqB,UACpCjC,EAAI,EAAGA,EAAI+B,EAAQ7W,OAAQ8U,IAAK,CACvC,IAAItV,EAAIqX,EAAQ/B,GAChB,GAAGtV,EAAEwX,aAAa,QAAUzV,GAAO/B,EAAEwX,aAAa,iBAAmBjZ,EAAoBoX,EAAK,CAAEwB,EAASnX,EAAG,OAG1GmX,IACHC,GAAa,GACbD,EAASG,SAASG,cAAc,WAEzBC,QAAU,QACjBP,EAAOQ,QAAU,IACblD,EAAoBmD,IACvBT,EAAOU,aAAa,QAASpD,EAAoBmD,IAElDT,EAAOU,aAAa,eAAgBtZ,EAAoBoX,GACxDwB,EAAOW,IAAM/V,GAEdzD,EAAWyD,GAAO,CAACmK,GACnB,IAAI6L,EAAmB,SAASC,EAAMC,GAErCd,EAAOxM,QAAUwM,EAAOe,OAAS,KACjCC,aAAaR,GACb,IAAIS,EAAU9Z,EAAWyD,GAIzB,UAHOzD,EAAWyD,GAClBoV,EAAOkB,YAAclB,EAAOkB,WAAWC,YAAYnB,GACnDiB,GAAWA,EAAQG,SAAQ,SAASrD,GAAM,OAAOA,EAAG+C,MACjDD,EAAM,OAAOA,EAAKC,IAGlBN,EAAUa,WAAWT,EAAiBU,KAAK,UAAM7D,EAAW,CAAErU,KAAM,UAAWmY,OAAQvB,IAAW,MACtGA,EAAOxM,QAAUoN,EAAiBU,KAAK,KAAMtB,EAAOxM,SACpDwM,EAAOe,OAASH,EAAiBU,KAAK,KAAMtB,EAAOe,QACnDd,GAAcE,SAASqB,KAAKC,YAAYzB,KwCvCzC1C,EAAoBmB,EAAI,SAASf,GACX,oBAAXgE,QAA0BA,OAAOC,aAC1C5R,OAAOgP,eAAerB,EAASgE,OAAOC,YAAa,CAAEpX,MAAO,WAE7DwF,OAAOgP,eAAerB,EAAS,aAAc,CAAEnT,OAAO,KCLvD+S,EAAoBjO,EAAI,OxCyCpBhI,EAAiB,SAAS6X,GAC7B,OAAO,IAAI/L,SAAQ,SAASC,EAASC,GACpC,IAAIiJ,EAAOgB,EAAoBiC,SAASL,GACpC0C,EAAWtE,EAAoBjO,EAAIiN,EACvC,GAlBmB,SAASA,EAAMsF,GAEnC,IADA,IAAIC,EAAmB1B,SAASC,qBAAqB,QAC7CjC,EAAI,EAAGA,EAAI0D,EAAiBxY,OAAQ8U,IAAK,CAChD,IACI2D,GADAC,EAAMF,EAAiB1D,IACRkC,aAAa,cAAgB0B,EAAI1B,aAAa,QACjE,GAAe,eAAZ0B,EAAIC,MAAyBF,IAAaxF,GAAQwF,IAAaF,GAAW,OAAOG,EAErF,IAAIE,EAAoB9B,SAASC,qBAAqB,SACtD,IAAQjC,EAAI,EAAGA,EAAI8D,EAAkB5Y,OAAQ8U,IAAK,CACjD,IAAI4D,EAEJ,IADID,GADAC,EAAME,EAAkB9D,IACTkC,aAAa,gBAChB/D,GAAQwF,IAAaF,EAAU,OAAOG,GAOnDG,CAAe5F,EAAMsF,GAAW,OAAOxO,KA7CrB,SAAS8L,EAAS0C,EAAUxO,EAASC,GAC3D,IAAI8O,EAAUhC,SAASG,cAAc,QAErC6B,EAAQH,IAAM,aACdG,EAAQ/Y,KAAO,WAiBf+Y,EAAQ3O,QAAU2O,EAAQpB,OAhBL,SAASD,GAG7B,GADAqB,EAAQ3O,QAAU2O,EAAQpB,OAAS,KAChB,SAAfD,EAAM1X,KACTgK,QACM,CACN,IAAIgP,EAAYtB,IAAyB,SAAfA,EAAM1X,KAAkB,UAAY0X,EAAM1X,MAChEiZ,EAAWvB,GAASA,EAAMS,QAAUT,EAAMS,OAAOjF,MAAQsF,EACzD3Y,EAAM,IAAIuE,MAAM,qBAAuB0R,EAAU,cAAgBmD,EAAW,KAChFpZ,EAAIqZ,KAAO,wBACXrZ,EAAIG,KAAOgZ,EACXnZ,EAAIwD,QAAU4V,EACdF,EAAQjB,WAAWC,YAAYgB,GAC/B9O,EAAOpK,KAITkZ,EAAQ7F,KAAOsF,EAEfzB,SAASqB,KAAKC,YAAYU,GAsBzBI,CAAiBrD,EAAS0C,EAAUxO,EAASC,OAI3C/L,EAAqB,CACxB,IAAK,GAGNgW,EAAoB2B,EAAEuD,QAAU,SAAStD,EAASG,GAE9C/X,EAAmB4X,GAAUG,EAAShX,KAAKf,EAAmB4X,IACzB,IAAhC5X,EAAmB4X,IAFX,CAAC,GAAK,EAAE,GAAK,EAAE,GAAK,EAAE,IAAM,EAAE,IAAM,EAAE,IAAM,EAAE,IAAM,EAAE,IAAM,EAAE,IAAM,EAAE,IAAM,GAErCA,IACtDG,EAAShX,KAAKf,EAAmB4X,GAAW7X,EAAe6X,GAASvI,MAAK,WACxErP,EAAmB4X,GAAW,KAC5B,SAASjP,GAEX,aADO3I,EAAmB4X,GACpBjP,O,WyC9DTqN,EAAoBzM,EAAIsP,SAASsC,SAAWC,KAAKvH,SAASmB,KAK1D,IAAIqG,EAAkB,CACrB,IAAK,GAGNrF,EAAoB2B,EAAEZ,EAAI,SAASa,EAASG,GAE1C,IAAIuD,EAAqBtF,EAAoBwB,EAAE6D,EAAiBzD,GAAWyD,EAAgBzD,QAAWzB,EACtG,GAA0B,IAAvBmF,EAGF,GAAGA,EACFvD,EAAShX,KAAKua,EAAmB,QAC3B,CAGL,IAAIC,EAAU,IAAI1P,SAAQ,SAASC,EAASC,GAAUuP,EAAqBD,EAAgBzD,GAAW,CAAC9L,EAASC,MAChHgM,EAAShX,KAAKua,EAAmB,GAAKC,GAGtC,IAAIjY,EAAM0S,EAAoBjO,EAAIiO,EAAoBgC,EAAEJ,GAEpD/V,EAAQ,IAAIqE,MAgBhB8P,EAAoByC,EAAEnV,GAfH,SAASkW,GAC3B,GAAGxD,EAAoBwB,EAAE6D,EAAiBzD,KAEf,KAD1B0D,EAAqBD,EAAgBzD,MACRyD,EAAgBzD,QAAWzB,GACrDmF,GAAoB,CACtB,IAAIR,EAAYtB,IAAyB,SAAfA,EAAM1X,KAAkB,UAAY0X,EAAM1X,MAChE0Z,EAAUhC,GAASA,EAAMS,QAAUT,EAAMS,OAAOZ,IACpDxX,EAAM4Z,QAAU,iBAAmB7D,EAAU,cAAgBkD,EAAY,KAAOU,EAAU,IAC1F3Z,EAAMW,KAAO,iBACbX,EAAMC,KAAOgZ,EACbjZ,EAAMsD,QAAUqW,EAChBF,EAAmB,GAAGzZ,MAIgB,SAAW+V,EAASA,KAclE5B,EAAoBO,EAAEQ,EAAI,SAASa,GAAW,OAAoC,IAA7ByD,EAAgBzD,IAGrE,IAAI8D,EAAuB,SAASC,EAA4BjM,GAC/D,IAKIuG,EAAU2B,EALVpB,EAAW9G,EAAK,GAChBkM,EAAclM,EAAK,GACnBmM,EAAUnM,EAAK,GAGImH,EAAI,EAC3B,IAAIZ,KAAY2F,EACZ5F,EAAoBwB,EAAEoE,EAAa3F,KACrCD,EAAoBtI,EAAEuI,GAAY2F,EAAY3F,IAGhD,GAAG4F,EAAS,IAAIvL,EAASuL,EAAQ7F,GAEjC,IADG2F,GAA4BA,EAA2BjM,GACrDmH,EAAIL,EAASzU,OAAQ8U,IACzBe,EAAUpB,EAASK,GAChBb,EAAoBwB,EAAE6D,EAAiBzD,IAAYyD,EAAgBzD,IACrEyD,EAAgBzD,GAAS,KAE1ByD,EAAgB7E,EAASK,IAAM,EAEhC,OAAOb,EAAoBO,EAAEjG,IAG1BwL,EAAqBV,KAA+B,yBAAIA,KAA+B,0BAAK,GAChGU,EAAmBhC,QAAQ4B,EAAqB1B,KAAK,KAAM,IAC3D8B,EAAmB/a,KAAO2a,EAAqB1B,KAAK,KAAM8B,EAAmB/a,KAAKiZ,KAAK8B,I,GClFvF,IAAIC,EAAsB/F,EAAoBO,OAAEJ,EAAW,CAAC,IAAI,MAAM,WAAa,OAAOH,EAAoB,SAC9G+F,EAAsB/F,EAAoBO,EAAEwF,G","sources":["webpack://kontokorrent/webpack/runtime/chunk loaded","webpack://kontokorrent/webpack/runtime/load script","webpack://kontokorrent/webpack/runtime/css loading","webpack://kontokorrent/./src/api/InteractionRequiredException.ts","webpack://kontokorrent/./src/api/TokenRenewFailedException.ts","webpack://kontokorrent/./src/state/Store.ts","webpack://kontokorrent/./src/state/lib/BaseStore.ts","webpack://kontokorrent/./src/ServiceLocator.ts","webpack://kontokorrent/./src/lib/AccountInfoStore.ts","webpack://kontokorrent/./src/api/postJson.ts","webpack://kontokorrent/./src/api/ApiException.ts","webpack://kontokorrent/./src/environment.ts","webpack://kontokorrent/./src/api/NeueBezahlungFailedException.ts","webpack://kontokorrent/./src/api/BezahlungBearbeitenFailedException.ts","webpack://kontokorrent/./src/api/BezahlungLoeschenFailedException.ts","webpack://kontokorrent/./src/api/ApiClient.ts","webpack://kontokorrent/./src/state/reducers/AccountReducer.ts","webpack://kontokorrent/./src/state/reducers/KontokorrentsReducer.ts","webpack://kontokorrent/./src/lib/KontokorrentDatabase.ts","webpack://kontokorrent/./src/state/actions/InitializationActionCreator.ts","webpack://kontokorrent/./src/state/reducers/BeschreibungVorschlaegeReducer.ts","webpack://kontokorrent/./src/index.ts","webpack://kontokorrent/./src/lib/AccountType.ts","webpack://kontokorrent/./src/lib/testFeatures.ts","webpack://kontokorrent/./src/components/FeaturesRequired/FeaturesRequired.ts","webpack://kontokorrent/./src/components/FeaturesRequired/FeaturesRequired.html","webpack://kontokorrent/./src/routing/KontokorrentRouteResolver.ts","webpack://kontokorrent/./src/state/State.ts","webpack://kontokorrent/./src/state/actions/AccountActionCreator.ts","webpack://kontokorrent/./src/state/actions/KontokorrentListenActionCreator.ts","webpack://kontokorrent/./src/state/actions/RoutingActionCreator.ts","webpack://kontokorrent/./src/sw.constants.ts","webpack://kontokorrent/./src/utils/sortBy.ts","webpack://kontokorrent/webpack/bootstrap","webpack://kontokorrent/webpack/runtime/compat get default export","webpack://kontokorrent/webpack/runtime/define property getters","webpack://kontokorrent/webpack/runtime/ensure chunk","webpack://kontokorrent/webpack/runtime/get javascript chunk filename","webpack://kontokorrent/webpack/runtime/get mini-css chunk filename","webpack://kontokorrent/webpack/runtime/global","webpack://kontokorrent/webpack/runtime/hasOwnProperty shorthand","webpack://kontokorrent/webpack/runtime/make namespace object","webpack://kontokorrent/webpack/runtime/publicPath","webpack://kontokorrent/webpack/runtime/jsonp chunk loading","webpack://kontokorrent/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"kontokorrent:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var createStylesheet = function(chunkId, fullhref, resolve, reject) {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tvar onLinkComplete = function(event) {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + realHref + \")\");\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tlinkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\tdocument.head.appendChild(linkTag);\n\treturn linkTag;\n};\nvar findStylesheet = function(href, fullhref) {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = function(chunkId) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t826: 0\n};\n\n__webpack_require__.f.miniCss = function(chunkId, promises) {\n\tvar cssChunks = {\"41\":1,\"57\":1,\"90\":1,\"182\":1,\"215\":1,\"426\":1,\"468\":1,\"502\":1,\"539\":1,\"895\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(function() {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, function(e) {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr","export class InteractionRequiredException {\n\n}\n\n","export class TokenRenewFailedException {\n    constructor(public readonly networkError: boolean) {\n\n    }\n}","import { State } from \"./State\";\nimport { BaseStore } from \"./lib/BaseStore\";\n\nexport class Store extends BaseStore<State> {\n    \n};","import { Reducer } from \"./Reducer\";\nimport { Action } from \"./Action\";\nimport { Store } from \"./Store\";\n\ninterface Subscription<TState> {\n    call(a: TState): void;\n    area: keyof TState | \"\";\n}\n\ninterface ReducerSubscription<TState> {\n    reducer: Reducer<any, any>;\n    area: keyof TState | null;\n}\n\nexport class BaseStore<TState> implements Store {\n    public state: TState;\n    private subscriptions: Subscription<TState>[];\n    private reducerSubscriptions: ReducerSubscription<TState>[];\n    constructor(initState: () => TState) {\n        this.subscriptions = [];\n        this.reducerSubscriptions = [];\n        this.state = initState();\n    }\n    subscribe<K extends keyof TState>(area: K | null, call: (a: TState) => void) {\n        let sub = { area, call };\n        this.subscriptions.push(sub);\n        return () => {\n            this.subscriptions.splice(this.subscriptions.indexOf(sub), 1);\n        };\n    }\n    addReducer<K extends keyof TState>(area: K | null, reducer: Reducer<TState[K] | TState, any>) {\n        this.reducerSubscriptions.push({ area, reducer });\n    }\n    dispatch(action: Action) {\n        let updatedAreas: (keyof TState | \"\")[] = [];\n        for (let s of this.reducerSubscriptions) {\n            let applyUpdateFn;\n            if (s.area) {\n                applyUpdateFn = (cb: (a: any) => any) => {\n                    (<any>this.state[s.area]) = cb(this.state[s.area]);\n                    updatedAreas.push(s.area);\n                };\n            }\n            else {\n                applyUpdateFn = (cb: (a: any) => any) => {\n                    this.state = cb(this.state);\n                    updatedAreas.push(\"\");\n                };\n            }\n            try {\n                s.reducer.onDispatch(action, applyUpdateFn);\n            }\n            catch (err) {\n                console.error(`Error while dispatching ${action.type}.`, err);\n            }\n        }\n        if (updatedAreas.length) {\n            for (let s of this.subscriptions) {\n                if (!s.area || updatedAreas.indexOf(s.area) > -1) {\n                    try {\n                        s.call(this.state);\n                    }\n                    catch (err) {\n                        console.error(`Error while updating on ${s.area || \"global\"} after ${action.type}.`, err);\n                    }\n                }\n            }\n        }\n    }\n}","import { Store } from \"./state/Store\";\nimport { Router } from \"route-it\";\nimport { ApiClient } from \"./api/ApiClient\";\nimport { KontokorrentDatabase } from \"./lib/KontokorrentDatabase\";\nimport { AccountInfoStore } from \"./lib/AccountInfoStore\";\n\nexport class ServiceLocator {\n    private services: { [name: string]: any };\n    constructor(public store: Store,\n        public router: Router<HTMLElement>,\n        public apiClient: ApiClient,\n        public db: KontokorrentDatabase,\n        public accountInfoStore: AccountInfoStore) {\n        this.services = {};\n    }\n\n    get<T>(name: string, factoryFunction: (serviceLocator: ServiceLocator) => T) {\n        if (!this.services[name]) {\n            this.services[name] = factoryFunction(this);\n        }\n        return this.services[name];\n    }\n}\n\n\n","import { AccountInfo } from \"./AccountInfo\";\nimport { KontokorrentDatabase } from \"./KontokorrentDatabase\";\n\nexport class AccountInfoStore {\n    constructor(private db: KontokorrentDatabase) {\n\n    }\n\n    async set(accountInfo: AccountInfo): Promise<void> {\n        await this.db.setAccountInfo(accountInfo);\n    }\n    async get(): Promise<AccountInfo> {\n        return await this.db.getAccountInfo();\n    }\n    async clear(): Promise<void> {\n        await this.db.clearAccountInfo();\n    }\n\n    async getAccessToken(tokenType: \"google\" | \"anonymous\"): Promise<{ timestamp: number, value: string }> {\n        return await this.db.getAccessToken(tokenType);\n    }\n\n    async updateAccessTokenIfNewer(tokenType: \"anonymous\" | \"google\", value: string, lastTimeStamp: number) {\n        return await this.db.updateAccessTokenIfNewer(tokenType, value, lastTimeStamp);\n    }\n}\n\n","export async function postJson(url: string, body: any, token?: string) {\n    let init: RequestInit = {\n        method: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n    };\n    if (token) {\n        init.headers = { ...init.headers, \"Authorization\": `Bearer ${token}` };\n    }\n    return await fetch(url, init);\n}","\nexport class ApiException {\n}\n","let API_URL;\nif (__ENVIRONMENT == \"local\") {\n    API_URL = \"https://kontokorrent.azurewebsites.net\";\n}\nelse if (__ENVIRONMENT == \"gh-pages\") {\n    API_URL = \"https://kontokorrent.azurewebsites.net\";\n}\nelse if (__ENVIRONMENT == \"gh-pagesv2\") {\n    API_URL = \"https://kontokorrent.azurewebsites.net\";\n}\nelse {\n    API_URL = \"https://kontokorrent.azurewebsites.net\";\n}\n\nexport const environment = {\n    API_URL: API_URL\n};\n","\nexport class NeueBezahlungFailedException {\n}\n\n\n","\nexport class BezahlungBearbeitenFailedException {\n}\n","\nexport class BezahlungLoeschenFailedException {\n}\n","import { postJson } from \"./postJson\";\nimport { AccountType } from \"../lib/AccountType\";\nimport { AccountInfoStore } from \"../lib/AccountInfoStore\";\nimport { KontokorrentInfo } from \"./KontokorrentInfo\";\nimport { NeuerKontokorrentRequest } from \"./NeuerKontokorrentRequest\";\nimport { TokenRenewFailedException } from \"./TokenRenewFailedException\";\nimport { InteractionRequiredException } from \"./InteractionRequiredException\";\nimport { ApiException } from \"./ApiException\";\nimport { Aktion } from \"./Aktion\";\nimport { environment } from \"../environment\";\nimport { NeueBezahlungRequest } from \"./NeueBezahlungRequest\";\nimport { NeueBezahlungFailedException } from \"./NeueBezahlungFailedException\";\nimport { BezahlungBearbeitenRequest } from \"./BezahlungBearbeitenRequest\";\nimport { BezahlungBearbeitenFailedException } from \"./BezahlungBearbeitenFailedException\";\nimport { BezahlungLoeschenFailedException } from \"./BezahlungLoeschenFailedException\";\n\nconst baseUrl = environment.API_URL;\n\nexport class ApiClient {\n\n    constructor(private accountInfoStore: AccountInfoStore) {\n\n    }\n\n    async neuerBenutzer(id: string, secret: string) {\n        try {\n            let res = await postJson(`${baseUrl}/api/v2/accounts`, { id, secret });\n            if (!res.ok) {\n                return { success: false };\n            }\n            return { success: true };\n        }\n        catch(err) {\n            return { success: false };\n        }\n    }\n\n    async getUserInfo() {\n        let res = await fetch(`${baseUrl}/api/v2/userinfo`, { headers: await this.getAuthHeader() });\n        return await res.json();\n    }\n\n    private async getAuthHeader() {\n        return { \"Authorization\": `Bearer ${await this.getAccessToken()}` };\n    }\n\n    async kontokorrentHinzufuegen(oeffentlicherName: string, einladungsCode: string) {\n        let params = \"\";\n        if (oeffentlicherName) {\n            params = `oeffentlicherName=${encodeURIComponent(oeffentlicherName)}`;\n        }\n        else {\n            params = `einladungsCode=${encodeURIComponent(einladungsCode)}`;\n        }\n        let headers = await this.getAuthHeader();\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents?${params}`, { method: \"PUT\", headers: headers });\n        if (res.status == 404) {\n            return null;\n        }\n        return <KontokorrentInfo[]>await res.json();\n    }\n\n    async kontokorrentsAuflisten() {\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents`, { headers: await this.getAuthHeader() });\n        if (!res.ok) {\n            throw new ApiException();\n        }\n        return <KontokorrentInfo[]>await res.json();\n    }\n\n\n    async neuerKontokorrent(request: NeuerKontokorrentRequest) {\n        let res = await postJson(`${baseUrl}/api/v2/kontokorrents`, request, await this.getAccessToken());\n        if (res.status == 422) {\n            return { success: false, exists: true };\n        }\n        else if (res.ok) {\n            return { success: true };\n        }\n        return { success: false };\n    }\n\n    async getAktionen(kontokorrentId: string, ab?: number) {\n        let query = ab ? `?ab=${ab}` : \"\";\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents/${kontokorrentId}/aktionen${query}`, { headers: await this.getAuthHeader() });\n        if (res.status == 404) {\n            return {\n                success: false,\n                notfound: true\n            };\n        }\n        else if (res.ok) {\n            let aktionen: Aktion[] = await res.json();\n            return {\n                success: true,\n                aktionen: this.mapAktionen(aktionen)\n            }\n        }\n    }\n\n    private mapAktionen(aktionen : Aktion[]) : Aktion[] {\n        for (let a of aktionen) {\n            if (a.bezahlung) {\n                a.bezahlung.zeitpunkt = new Date(a.bezahlung.zeitpunkt);\n            }\n        }\n        return aktionen;\n    }\n\n    async neueBezahlung(kontokorrentId: string, request: NeueBezahlungRequest) {\n        let init: RequestInit = {\n            method: \"POST\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"application/vnd+kontokorrent.hinzufuegenaktion+json\",\n                \"Authorization\": `Bearer ${await this.getAccessToken()}`\n            },\n            body: JSON.stringify(request)\n        };\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents/${kontokorrentId}/aktionen`, init);\n        if (res.ok) {\n            let aktion = <Aktion>(await res.json());\n            return this.mapAktionen([aktion])[0];\n        }\n        throw new NeueBezahlungFailedException();\n    }\n\n    async bezahlungLoeschen(kontokorrentId: string, bezahlungId:string) {\n        let init: RequestInit = {\n            method: \"POST\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"application/vnd+kontokorrent.loeschenaktion+json\",\n                \"Authorization\": `Bearer ${await this.getAccessToken()}`\n            },\n            body: JSON.stringify({id:bezahlungId})\n        };\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents/${kontokorrentId}/aktionen`, init);\n        if (res.ok) {\n            let aktion = <Aktion>(await res.json());\n            return this.mapAktionen([aktion])[0];\n        }\n        throw new BezahlungLoeschenFailedException();\n    }\n\n    async bezahlungBearbeiten(kontokorrentId: string, request: BezahlungBearbeitenRequest) {\n        let init: RequestInit = {\n            method: \"POST\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"application/vnd+kontokorrent.bearbeitenaktion+json\",\n                \"Authorization\": `Bearer ${await this.getAccessToken()}`\n            },\n            body: JSON.stringify(request)\n        };\n        let res = await fetch(`${baseUrl}/api/v2/kontokorrents/${kontokorrentId}/aktionen`, init);\n        if (res.ok) {\n            let aktion = <Aktion>(await res.json());\n            return this.mapAktionen([aktion])[0];\n        }\n        throw new BezahlungBearbeitenFailedException();\n    }\n\n\n    private async getAccessToken() {\n        let info = await this.accountInfoStore.get();\n        if (null == info) {\n            throw new Error(\"Keine Account Information gespeichert.\");\n        }\n        if (info.type == AccountType.anonym) {\n            let tokenInfo = await this.accountInfoStore.getAccessToken(\"anonymous\");\n            if (null != tokenInfo) {\n                let { token, expires } = JSON.parse(tokenInfo.value);\n                if (token && expires && expires >= +new Date()) {\n                    return token;\n                }\n            }\n            let tokenResponse;\n            try {\n                let res = await postJson(`${baseUrl}/api/v2/token`, { id: info.id, secret: info.secret });\n                if (!res.ok) {\n                    throw new TokenRenewFailedException(false);\n                }\n                tokenResponse = await res.json();\n            }\n            catch(err) {\n                throw new TokenRenewFailedException(true);\n            }\n            await this.accountInfoStore.updateAccessTokenIfNewer(\"anonymous\", JSON.stringify(tokenResponse), tokenInfo?.timestamp);\n            return tokenResponse.token;\n        }\n        else if (info.type == AccountType.google) {\n            throw new InteractionRequiredException();\n            // let flow = new OAuth2PopupFlow({\n            //     authorizationUri: \"https://accounts.google.com/o/oauth2/v2/auth/.well-known/openid-configuration\",\n            //     clientId: \"82890837151-n0e81vsn3ns2qn1ksh7bdohmnlau468k.apps.googleusercontent.com\",\n            //     redirectUri: \"http://localhost:4200\",\n            //     scope: \"openid\",\n            //     responseType: \"id_token\",\n            //     additionalAuthorizationParameters: { \"login_hint\": info.id },\n            //     accessTokenStorageKey: \"access_token_google\"\n            // });\n            // return await flow.token();\n        }\n        else {\n            throw new Error(`Account Typ ${info.type} unbekannt`);\n        }\n    }\n}","import { Reducer } from \"../lib/Reducer\";\nimport { State, AccountState } from \"../State\";\nimport { AccountActions } from \"../actions/AccountActionCreator\";\nimport { KontokorrentListenActions } from \"../actions/KontokorrentListenActionCreator\";\nimport { ActionNames } from \"../actions/ActionNames\";\n\nexport class AccountReducer implements Reducer<AccountState, AccountActions | KontokorrentListenActions> {\n    onDispatch(action: AccountActions | KontokorrentListenActions, updateStore: (a: (s: AccountState) => AccountState) => void): void {\n        switch (action.type) {\n            case ActionNames.AccountCreating: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        accountCreating: true,\n                        accountCreationFailed: false\n                    };\n                })\n            }\n                break;\n            case ActionNames.AccountCreated: {\n                updateStore(s => {\n                    return {\n                        ...s, accountCreating: false,\n                        accountCreated: true,\n                        accountInfo: action.info\n                    };\n                })\n            }\n                break;\n            case ActionNames.AccountCreationFailed: {\n                updateStore(s => {\n                    return {\n                        ...s, accountCreationFailed: true,\n                        accountCreating: false,\n                        accountCreated: false\n                    };\n                })\n            }\n                break;\n            case ActionNames.AccountInitialized: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        accountCreated: true,\n                        accountInfo: action.info\n                    };\n                })\n            }\n                break;\n            case ActionNames.LoggedOut: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        accountCreated: false\n                    };\n                })\n            }\n                break;\n            case ActionNames.LoginExpired:\n                {\n                    updateStore(s => {\n                        return {\n                            ...s,\n                            loginExpired: true\n                        };\n                    })\n                }\n                break;\n            case ActionNames.KontokorrentListeLadenFailed: {\n                if (action.interactionRequired) {\n                    updateStore(s => {\n                        return {\n                            ...s,\n                            loginExpired: true\n                        };\n                    })\n                }\n            }\n                break;\n        }\n    }\n}","import { Reducer } from \"../lib/Reducer\";\nimport { KontokorrentsState, KontokorrentState, Bezahlung, Person, RequestStatus, BezahlungStatus, AngezeigteBezahlungState } from \"../State\";\nimport { KontokorrentListenActions } from \"../actions/KontokorrentListenActionCreator\";\nimport { KontokorrentInfo } from \"../../api/KontokorrentInfo\";\nimport { AccountActions } from \"../actions/AccountActionCreator\";\nimport { BezahlungActions } from \"../actions/BezahlungActionCreator\";\nimport { ActionNames } from \"../actions/ActionNames\";\nimport { KontokorrentHinzufuegenActions } from \"../actions/KontokorrentHinzufuegenActionCreator\";\nimport { ServiceWorkerActions } from \"../actions/ServiceWorkerActions\";\nimport { KontokorrentSyncActions } from \"../actions/KontokorrentSyncActionCreator\";\n\ntype Actions = KontokorrentListenActions\n    | AccountActions\n    | BezahlungActions\n    | KontokorrentHinzufuegenActions\n    | KontokorrentSyncActions\n    | ServiceWorkerActions;\ntype PersonOptional = Partial<Omit<Person, \"id\">> & { id: string };\ntype BezhalungOptional = Partial<Omit<Bezahlung, \"id\">> & { id: string };\n\nexport class KontokorrentsReducer implements Reducer<KontokorrentsState, Actions> {\n    onDispatch(action: Actions, updateStore: (a: (s: KontokorrentsState) => KontokorrentsState) => void): void {\n        switch (action.type) {\n            case ActionNames.KontokorrentListeLaden: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        listeLaden: true\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentListeLadenFailed: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        listeLaden: false\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentListe: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        kontokorrents: this.extendMap(s.kontokorrents, action.kontokorrents)\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentHinzufuegen: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        hinzufuegen: true\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentHinzufuegenFailed: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        hinzufuegen: false,\n                        hinzufuegenFailed: { kontokorrentNotFound: action.notFound },\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentHinzufuegenSuccess: {\n                updateStore(s => {\n\n                    return {\n                        ...s,\n                        hinzufuegen: false,\n                        kontokorrents: this.extendMap(s.kontokorrents, action.kontokorrents)\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentCreating: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        creating: true,\n                        creationFailed: null\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentCreationFailed: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        creating: false,\n                        creationFailed: {\n                            exists: action.exists\n                        }\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentNichtGefunden: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        nichtGefunden: {\n                            oeffentlicherName: action.oeffentlicherName\n                        }\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentOeffnen: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        nichtGefunden: null\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentCreated: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        creating: false,\n                        kontokorrents: {\n                            ...s.kontokorrents, [action.kontokorrent.id]: {\n                                id: action.kontokorrent.id,\n                                name: action.kontokorrent.name,\n                                oeffentlicherName: action.kontokorrent.oeffentlicherName,\n                                synchronisieren: false,\n                                personen: action.kontokorrent.personen.map(p => {\n                                    return {\n                                        balance: 0,\n                                        ...p\n                                    }\n                                }),\n                                bezahlungen: [],\n                                bezahlungAnlegen: null,\n                                angezeigteBezahlung: {},\n                                ausgleich: null,\n                                ausgleichBerechnen: false\n                            }\n                        }\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentGeoeffnet: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        activeKontokorrentId: action.id\n                    };\n                });\n                break;\n            }\n            case ActionNames.KontokorrentBezahlungen: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { bezahlungen: action.bezahlungen }));\n                break;\n            }\n            case ActionNames.KontokorrentSynchronisieren: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { synchronisieren: true }));\n                break;\n            }\n            case ActionNames.KontokorrentSynchronisiert: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { synchronisieren: false }));\n                break;\n            }\n            case ActionNames.AusgleichBerechnen: {\n                updateStore(s => {\n                    s = { ...s, activeKontokorrentId: action.kontokorrentId };\n                    this.updateKontokorrentStatus(s, action.kontokorrentId, { ausgleichBerechnen: true });\n                    return s;\n                });\n                break;\n            }\n            case ActionNames.AusgleichBerechnet: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { ausgleichBerechnen: false, ausgleich: action.ausgleich }));\n                break;\n            }\n            case ActionNames.KontokorrentBalanceAktualisiert: {\n                updateStore(s => this.extendPersonenInfo(s, action.kontokorrentId, Object.entries(action.balance).map(e => {\n                    return { id: e[0], balance: e[1] };\n                })));\n                break;\n            }\n            case ActionNames.LoginPageGeoeffnet: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        hinzufuegen: false,\n                        hinzufuegenFailed: null,\n                        nichtGefunden: null\n                    };\n                });\n                break;\n            }\n            case ActionNames.NichtGefundenPageGeoeffnet: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        hinzufuegen: false,\n                        hinzufuegenFailed: null,\n                        activeKontokorrentId: null,\n                        nichtGefunden: null\n                    };\n                });\n                break;\n            }\n            case ActionNames.LoggedOut: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        activeKontokorrentId: null,\n                        kontokorrents: {}\n                    };\n                });\n                break;\n            }\n            case ActionNames.BezahlungEintragenKontokorrentGeandert: {\n                updateStore(s => this.updateKontokorrentStatus({\n                    ...s,\n                    activeKontokorrentId: action.kontokorrentId\n                }, action.kontokorrentId, { bezahlungAnlegen: null }));\n                break;\n            }\n            case ActionNames.BezahlungGeoeffnet: {\n                updateStore(s => {\n                    s = {\n                        ...s,\n                        activeKontokorrentId: action.kontokorrentId,\n                    };\n                    s = this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bezahlungId, {\n                        bearbeitungsStatus: action.bearbeitungsStatus\n                    });\n                    if (action.bezahlung) {\n                        s = this.upsertBezahlung(s, action.kontokorrentId, action.bezahlung);\n                    }\n                    return s;\n                });\n                break;\n            }\n            case ActionNames.NeueBezahlungAnlegen: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { bezahlungAnlegen: RequestStatus.InProgress }));\n                break;\n            }\n            case ActionNames.NeueBezahlungAnlegenFailed: {\n                updateStore(s => this.updateKontokorrentStatus(s, action.kontokorrentId, { bezahlungAnlegen: RequestStatus.Failed }));\n                break;\n            }\n            case ActionNames.NeueBezahlungAngelegt: {\n                updateStore(s => {\n                    s = this.updateKontokorrentStatus(s, action.kontokorrentId, { bezahlungAnlegen: RequestStatus.Success });\n                    return this.upsertBezahlung(s, action.kontokorrentId, action.bezahlung);\n                });\n                break;\n            }\n            case ActionNames.ServiceWorkerBezahlungAnlegen: {\n                updateStore(s => this.upsertBezahlung(s, action.kontokorrentId, { status: BezahlungStatus.Speichern, id: action.bezahlungId }));\n                break;\n            }\n            case ActionNames.ServiceWorkerBezahlungAngelegt: {\n                updateStore(s => this.upsertBezahlung(s, action.kontokorrentId, { status: BezahlungStatus.Gespeichert, id: action.bezahlungId }));\n                break;\n            }\n            case ActionNames.BezahlungBearbeiten: {\n                updateStore(s => this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bezahlungId, { updateStatus: RequestStatus.InProgress }));\n                break;\n            }\n            case ActionNames.BezahlungBearbeitenFailed: {\n                updateStore(s => this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bezahlungId, { updateStatus: RequestStatus.Failed }));\n                break;\n            }\n            case ActionNames.BezahlungBearbeitet: {\n                updateStore(s => {\n                    s = this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bearbeiteteBezahlungId, { updateStatus: RequestStatus.Success });\n                    s = this.removeBezahlung(s, action.kontokorrentId, action.bearbeiteteBezahlungId);\n                    return this.upsertBezahlung(s, action.kontokorrentId, action.bezahlung);\n                });\n                break;\n            }\n            case ActionNames.BezahlungLoeschen: {\n                updateStore(s => this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bezahlungId, { deleteStatus: RequestStatus.InProgress }));\n                break;\n            }\n            case ActionNames.BezahlungLoeschenFailed: {\n                updateStore(s => this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.bezahlungId, { deleteStatus: RequestStatus.Failed }));\n                break;\n            }\n            case ActionNames.BezahlungGeloescht: {\n                updateStore(s => {\n                    s = this.updateAngezeigteBezahlung(s, action.kontokorrentId, action.geloeschteBezahlungId, { deleteStatus: RequestStatus.Success });\n                    return this.removeBezahlung(s, action.kontokorrentId, action.geloeschteBezahlungId);\n                });\n                break;\n            }\n        }\n    }\n\n    private updateKontokorrentStatus(s: KontokorrentsState, kontokorrentId: string, state: Partial<KontokorrentState>) {\n        return this.updateKontokorrentStatusFn(s, kontokorrentId, ks => { return { ...ks, ...state } });\n    }\n\n    private updateKontokorrentStatusFn(s: KontokorrentsState, kontokorrentId: string, update: (ks: KontokorrentState) => KontokorrentState) {\n        return {\n            ...s,\n            kontokorrents: {\n                ...s.kontokorrents, [kontokorrentId]: update(s.kontokorrents[kontokorrentId])\n            }\n        };\n    }\n\n    private updateAngezeigteBezahlung(s: KontokorrentsState, kontokorrentId: string, bezahlungId: string, state: Partial<AngezeigteBezahlungState>) {\n        return this.updateKontokorrentStatusFn(s, kontokorrentId, ks => {\n            return {\n                ...ks,\n                angezeigteBezahlung: {\n                    ...ks.angezeigteBezahlung,\n                    [bezahlungId]: {\n                        ...(ks.angezeigteBezahlung || {})[bezahlungId],\n                        ...state\n                    }\n                }\n            }\n        })\n    }\n\n    private upsertBezahlung(s: KontokorrentsState, kontokorrentId: string, b: BezhalungOptional):\n        KontokorrentsState {\n        let bezahlungen = s.kontokorrents[kontokorrentId]?.bezahlungen || [];\n        let existing = bezahlungen.find(d => b.id == d.id);\n        if (existing) {\n            bezahlungen.splice(bezahlungen.indexOf(existing), 1);\n        }\n        bezahlungen.push({ ...existing, ...b });\n        return {\n            ...s,\n            kontokorrents: {\n                ...s.kontokorrents, [kontokorrentId]: {\n                    ...s.kontokorrents[kontokorrentId],\n                    bezahlungen: bezahlungen\n                }\n            }\n        }\n    }\n\n    private removeBezahlung(s: KontokorrentsState, kontokorrentId: string, bezahlungId: string):\n        KontokorrentsState {\n        let bezahlungen = s.kontokorrents[kontokorrentId]?.bezahlungen || [];\n        let existing = bezahlungen.find(d => bezahlungId == d.id);\n        bezahlungen.splice(bezahlungen.indexOf(existing), 1);\n        return {\n            ...s,\n            kontokorrents: {\n                ...s.kontokorrents, [kontokorrentId]: {\n                    ...s.kontokorrents[kontokorrentId],\n                    bezahlungen: bezahlungen\n                }\n            }\n        }\n    }\n\n    private extendPersonenInfo(s: KontokorrentsState, kontokorrentId: string, personenInfo: PersonOptional[]):\n        KontokorrentsState {\n        let personenMap = new Map((s.kontokorrents[kontokorrentId]?.personen || []).map(p => [p.id, p]));\n        for (let info of personenInfo) {\n            personenMap.set(info.id, { ...personenMap.get(info.id), ...info });\n        }\n        return {\n            ...s,\n            kontokorrents: {\n                ...s.kontokorrents, [kontokorrentId]: {\n                    ...s.kontokorrents[kontokorrentId],\n                    personen: Array.from(personenMap.values())\n                }\n            }\n        }\n    }\n\n    private extendMap(map: { [id: string]: KontokorrentState }, kk: KontokorrentInfo[]) {\n        let kontokorrents: { [id: string]: KontokorrentState } = {};\n        for (let k of kk) {\n            let kontokorrent: KontokorrentState = {\n                ...k,\n                // default props\n                synchronisieren: false,\n                bezahlungen: <Bezahlung[]>[],\n                angezeigteBezahlung: {},\n                ausgleichBerechnen: false,\n                // old model\n                ...map[k.id],\n                personen: k.personen.map(v => {\n                    let p = map[k.id]?.personen?.find(p => p.id == v.id);\n                    return {\n                        ...v,\n                        balance: 0,\n                        ...p\n                    }\n                })\n            };\n            kontokorrents[k.id] = kontokorrent;\n        }\n        return kontokorrents;\n    }\n}","import { openDB, IDBPDatabase, DBSchema, unwrap } from \"idb\";\nimport { KontokorrentDbModel } from \"./KontokorrentDbModel\";\nimport { sortByAlphabetically } from \"../utils/sortBy\";\nimport { Aktion } from \"../api/Aktion\";\nimport { AktionDbModel } from \"./AktionDbModel\";\nimport { AccountInfo } from \"./AccountInfo\";\nimport { NeueBezahlungDbModel } from \"./NeueBezahlungDbModel\";\nimport { BearbeitungsStatus } from \"./BearbeitungsStatus\";\n\n\nconst KontokorrentsStore = \"KontokorrentsStore\";\nconst AppStateStore = \"AppStateStore\";\nconst AktionenStore = \"AktionenStore\";\nconst NeueBezahlungenStore = \"NeueBezahlungenStore\";\n\ninterface AccessTokenInfo {\n    timestamp: number;\n    value: string;\n    type: \"google\" | \"anonymous\";\n}\n\ninterface AppSettings {\n    id: number;\n    zuletztGesehenerKontokorrentId: string\n    accesstokens: AccessTokenInfo[];\n    accountinfo: AccountInfo;\n}\n\ninterface KontokorrentDbSchema extends DBSchema {\n    KontokorrentsStore: {\n        key: string;\n        value: KontokorrentDbModel;\n        indexes: { \"oeffentlicherName\": string };\n    };\n    AppStateStore: {\n        value: AppSettings;\n        key: number;\n    };\n    AktionenStore: {\n        key: [number, string],\n        value: AktionDbModel,\n        indexes: { \"kontokorrentId\": string };\n    };\n    NeueBezahlungenStore: {\n        key: string,\n        value: NeueBezahlungDbModel,\n        indexes: { \"kontokorrentId\": string };\n    }\n}\n\n\nconst initialSettings: (() => AppSettings) = () => { return { id: 0, zuletztGesehenerKontokorrentId: null, accesstokens: [], accountinfo: null } };\nexport class KontokorrentDatabase {\n\n    private async withInitialized<T>(cb: (db: IDBPDatabase<KontokorrentDbSchema>) => Promise<T>) {\n        let db = await openDB<KontokorrentDbSchema>(\"kontokorrent-db\", 5, {\n            upgrade(db, oldVersion: number, newVersion: number) {\n                if (oldVersion < 1) {\n                    let store = db.createObjectStore(KontokorrentsStore, { keyPath: \"id\" });\n                    store.createIndex(\"oeffentlicherName\", \"oeffentlicherName\");\n                }\n                if (oldVersion < 2) {\n                    let store = db.createObjectStore(AppStateStore, { keyPath: \"id\" });\n                    store.put(initialSettings());\n                }\n                if (oldVersion < 3) {\n                    let store = db.createObjectStore(AktionenStore, { keyPath: [\"laufendeNummer\", \"kontokorrentId\"] });\n                    store.createIndex(\"kontokorrentId\", \"kontokorrentId\");\n                }\n                if (oldVersion < 5) {\n                    if (db.objectStoreNames.contains(NeueBezahlungenStore)) {\n                        db.deleteObjectStore(NeueBezahlungenStore)\n                    }\n                    let store = db.createObjectStore(NeueBezahlungenStore, { keyPath: \"id\" });\n                    store.createIndex(\"kontokorrentId\", \"kontokorrentId\");\n                }\n            },\n        });\n        try {\n            return await cb(db);\n        }\n        finally {\n            db.close();\n        }\n    }\n\n    async getKontokorrents(): Promise<KontokorrentDbModel[]> {\n        return await this.withInitialized(async db => {\n            return sortByAlphabetically((await db.getAll(KontokorrentsStore)), k => k.name);\n        });\n    }\n\n    async addAktionen(id: string, aktionen: Aktion[]): Promise<void> {\n        if (!aktionen.length) {\n            return;\n        }\n        let mapped = aktionen\n            .map(v => {\n                let a: AktionDbModel = {\n                    ...v,\n                    kontokorrentId: id\n                };\n                return a;\n            });\n        return await this.withInitialized(db => {\n            const unwrapped = unwrap(<IDBPDatabase>db);\n            return new Promise((resolve, reject) => {\n                const tx = unwrapped.transaction(AktionenStore, \"readwrite\");\n                tx.onerror = err => {\n                    console.error(\"addAktionen failed\", err, tx.error);\n                    reject(tx.error);\n                };\n                tx.oncomplete = () => {\n                    resolve();\n                }\n                for (let a of mapped) {\n                    let request = tx.objectStore(AktionenStore).add(a);\n                    request.onerror = ev => {\n                        if (request.error.name == \"ConstraintError\") {\n                            console.log(`Aktion ${a.laufendeNummer} für Kontokorrent ${id} bereits gespeichert.`, ev, request.error);\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                        } else {\n                            console.error(`Aktion ${a.laufendeNummer} für Kontokorrent ${id} konnte nicht gespeichert werden.`, ev, request.error);\n                        }\n                    }\n                }\n            });\n        });\n    }\n\n    async getZuletztGesehenerKontokorrentId(): Promise<string> {\n        return await this.withInitialized(async db => {\n            let appState = await db.get(AppStateStore, 0);\n            if (appState.zuletztGesehenerKontokorrentId) {\n                return appState.zuletztGesehenerKontokorrentId;\n            }\n            else {\n                let kks = await (await this.getKontokorrents());\n                if (kks.length) {\n                    return kks[0].id;\n                }\n                return null;\n            }\n        });\n    }\n\n    async setZuletztGesehenerKontokorrentId(id: string): Promise<void> {\n        return await this.withInitialized(async db => {\n            let appState = await db.get(AppStateStore, 0);\n            appState.zuletztGesehenerKontokorrentId = id;\n            await db.put(AppStateStore, appState);\n        });\n    }\n\n    async setKontokorrents(kontokorrents: {\n        name: string, id: string, personen: { name: string, id: string }[],\n        oeffentlicherName: string\n    }[]): Promise<string[]> {\n        return await this.withInitialized(async db => {\n            let existing: KontokorrentDbModel[] = (await db.getAll(KontokorrentsStore));\n            for (let v of existing.filter(e => !kontokorrents.some(d => e.id === d.id))) {\n                await db.delete(KontokorrentsStore, v.id);\n            }\n            let newIds: string[] = [];\n            for (let v of kontokorrents) {\n                let ex = existing.find(d => d.id == v.id);\n                if (!ex) {\n                    newIds.push(v.id);\n                }\n                let combined = {\n                    ...ex, name: v.name, personen: v.personen, id: v.id,\n                    oeffentlicherName: v.oeffentlicherName\n                };\n                await db.put(KontokorrentsStore, combined);\n            }\n            return newIds;\n        });\n    }\n\n    async addKontokorrent(kk: KontokorrentDbModel): Promise<void> {\n        return await this.withInitialized(async db => {\n            if (!await db.get(KontokorrentsStore, kk.id)) {\n                await db.add(KontokorrentsStore, kk);\n            }\n        });\n    }\n\n    async getKontokorrent(id: string): Promise<KontokorrentDbModel> {\n        return await this.withInitialized(async db => {\n            return <KontokorrentDbModel>await db.get(KontokorrentsStore, id);\n        });\n    }\n\n    async getPerOeffentlichName(id: string): Promise<KontokorrentDbModel> {\n        return await this.withInitialized(async db => {\n            return <KontokorrentDbModel>await db.getFromIndex(KontokorrentsStore, \"oeffentlicherName\", id);\n        });\n    }\n\n    async getAktionen(id: string): Promise<AktionDbModel[]> {\n        return await this.withInitialized(async db => {\n            return await db.getAllFromIndex(AktionenStore, \"kontokorrentId\", id);\n        });\n    }\n\n    async clear() {\n        return await this.withInitialized(async db => {\n            await db.clear(AktionenStore);\n            await db.clear(KontokorrentsStore);\n            await db.put(AppStateStore, initialSettings());\n        });\n    }\n\n    async getAccessToken(tokenType: \"anonymous\" | \"google\"): Promise<AccessTokenInfo> {\n        return await this.withInitialized(async db => {\n            let appState = await db.get(AppStateStore, 0);\n            return (appState.accesstokens || []).find(t => t.type === tokenType);\n        });\n    }\n\n    async updateAccessTokenIfNewer(tokenType: \"anonymous\" | \"google\", value: string, lastTimeStamp: number): Promise<boolean> {\n        return await this.withInitialized(async db => {\n            const tx = db.transaction(AppStateStore, \"readwrite\", { durability: \"strict\" });\n            let appState = await tx.store.get(0);\n            if (!appState.accesstokens) {\n                appState.accesstokens = [];\n            }\n            let existing = appState.accesstokens.find(t => t.type === tokenType);\n            if (!existing) {\n                appState.accesstokens.push({\n                    timestamp: 1,\n                    type: tokenType,\n                    value: value\n                });\n            } else if (existing.timestamp == lastTimeStamp) {\n                existing.value = value;\n                existing.timestamp++;\n            }\n            else {\n                console.error(`The accesstoken of type ${tokenType} was already updated since reading.`);\n                await tx.done;\n                return false;\n            }\n            await tx.store.put(appState);\n            await tx.done;\n            return true;\n        });\n    }\n\n    async setAccountInfo(accountInfo: AccountInfo): Promise<void> {\n        return await this.withInitialized(async db => {\n            const tx = db.transaction(AppStateStore, \"readwrite\");\n            let appState = await tx.store.get(0);\n            appState.accountinfo = accountInfo;\n            await tx.store.put(appState);\n            await tx.done;\n        });\n    }\n\n    async getAccountInfo(): Promise<AccountInfo> {\n        return await this.withInitialized(async db => {\n            const tx = db.transaction(AppStateStore, \"readonly\");\n            let appState = await tx.store.get(0);\n            return appState?.accountinfo;\n        });\n    }\n\n    async clearAccountInfo(): Promise<void> {\n        return await this.withInitialized(async db => {\n            const tx = db.transaction(AppStateStore, \"readwrite\");\n            let appState = await tx.store.get(0);\n            appState.accountinfo = null;\n            appState.accesstokens = [];\n            await tx.store.put(appState);\n            await tx.done;\n        });\n    }\n\n    async getZwischengespeicherteBezahlungen(): Promise<NeueBezahlungDbModel[]> {\n        return await this.withInitialized(async db => {\n            return (await db.getAll(NeueBezahlungenStore));\n        });\n    }\n\n    async getBezahlungAktion(kontokorrentId: string, bezahlungId: string): Promise<AktionDbModel> {\n        return await this.withInitialized(async db => {\n            var aktionen = db.getAllFromIndex(AktionenStore, \"kontokorrentId\", kontokorrentId);\n            return (await aktionen).find(a => a.bezahlung && a.bezahlung.id == bezahlungId);\n        });\n    }\n\n    async getBearbeitungsStatus(kontokorrentId: string, bezahlungId: string): Promise<{ aktion: AktionDbModel, status: BearbeitungsStatus }> {\n        return await this.withInitialized(async db => {\n            let aktionen: AktionDbModel[] = await db.getAllFromIndex(AktionenStore, \"kontokorrentId\", kontokorrentId);\n            let aktion = aktionen.find(a => a.bezahlung && a.bezahlung.id == bezahlungId);\n            if (!aktion) {\n                let neueBezahlungen: NeueBezahlungDbModel[] = await db.getAllFromIndex(NeueBezahlungenStore, \"kontokorrentId\", kontokorrentId);\n                let neueBezahlung = neueBezahlungen.find(a => a.id == bezahlungId);\n                if (neueBezahlung) {\n                    return { aktion: null, status: BearbeitungsStatus.Zwischengespeichert };\n                }\n                return { aktion: null, status: BearbeitungsStatus.NichtGefunden };\n            }\n            let bearbeitendeAktion = aktionen.find(a => a.bearbeiteteBezahlungId == bezahlungId);\n            if (null != bearbeitendeAktion) {\n                return { aktion: aktion, status: BearbeitungsStatus.Bearbeitet };\n            }\n            let loeschendeAktion = aktionen.find(a => a.geloeschteBezahlungId == bezahlungId);\n            if (null != loeschendeAktion) {\n                return { aktion: aktion, status: BearbeitungsStatus.Geloescht };\n            }\n            return { aktion: aktion, status: BearbeitungsStatus.Bearbeitbar };\n        });\n    }\n\n    async getZwischengespeicherteBezahlungenForKontokorrent(kontokorrentId: string): Promise<NeueBezahlungDbModel[]> {\n        return await this.withInitialized(async db => {\n            return await db.getAllFromIndex(NeueBezahlungenStore, \"kontokorrentId\", kontokorrentId);\n        });\n    }\n\n    async bezahlungZwischenspeichern(m: NeueBezahlungDbModel) {\n        return await this.withInitialized(async db => {\n            db.add(NeueBezahlungenStore, m);\n        });\n    }\n\n    async zwischengespeicherteBezahlungErledigt(id: string) {\n        await this.withInitialized(async db => {\n            db.delete(NeueBezahlungenStore, id);\n        });\n    }\n}\n","import { Store } from \"../Store\";\nimport { RoutingActionCreator, routingActionCreatorFactory } from \"./RoutingActionCreator\";\nimport { testFeatures } from \"../../lib/testFeatures\";\nimport { AccountActionCreator, accountActionCreatorFactory } from \"./AccountActionCreator\";\nimport { Router } from \"route-it/dist/router\";\nimport { KontokorrentListenActionCreator, kontokorrentListenActionCreatorFactory } from \"./KontokorrentListenActionCreator\";\nimport { ServiceLocator } from \"../../ServiceLocator\";\nimport { Paths } from \"../../routing/KontokorrentRouteResolver\";\nimport { KontokorrentDatabase } from \"../../lib/KontokorrentDatabase\";\nimport { NeueBezahlungBackgroundSyncTag } from \"../../sw.constants\";\n\nexport class InitializationActionCreator {\n\n    constructor(private store: Store,\n        private db: KontokorrentDatabase,\n        private routingActionCreator: RoutingActionCreator,\n        private accountActionCreator: AccountActionCreator,\n        private kontokorrentsActionCreator: KontokorrentListenActionCreator,\n        private router: Router<unknown>) {\n\n    }\n\n    async initializeApplication() {\n        if (!(await testFeatures()).allPassed) {\n            this.router.run();\n            this.routingActionCreator.navigateFeaturesRequired();\n            return;\n        }\n        let initialized = await this.accountActionCreator.initializeAccount();\n        this.router.run();\n        if (initialized) {\n            await this.kontokorrentsActionCreator.syncKontokorrentListe();\n            if (\"requestIdleCallback\" in window) {\n                window.requestIdleCallback(() => {\n                    this.zwischengespeicherteSynchronisieren();\n                });\n            }\n            else {\n                this.zwischengespeicherteSynchronisieren();\n            }\n        }\n    }\n\n    private async zwischengespeicherteSynchronisierenAsync(): Promise<void> {\n        if (\"serviceWorker\" in navigator && \"SyncManager\" in window) {\n            let reg = await navigator.serviceWorker.ready;\n            if ((await this.db.getZwischengespeicherteBezahlungen()).length) {\n                await reg.sync.register(NeueBezahlungBackgroundSyncTag);\n                console.log(\"background sync scheduled\");\n            }\n        }\n    }\n\n    private zwischengespeicherteSynchronisieren() {\n        this.zwischengespeicherteSynchronisierenAsync()\n            .catch(err => console.error(err));\n    }\n}\n\nexport function initializationActionCreatorFactory(serviceLocator: ServiceLocator) {\n    return serviceLocator.get(\"InitializationActionCreator\",\n        serviceLocator => new InitializationActionCreator(serviceLocator.store,\n            serviceLocator.db,\n            routingActionCreatorFactory(serviceLocator),\n            accountActionCreatorFactory(serviceLocator),\n            kontokorrentListenActionCreatorFactory(serviceLocator),\n            serviceLocator.router));\n}","import { Reducer } from \"../lib/Reducer\";\nimport { BeschreibungVorschlagState } from \"../State\";\nimport { ActionNames } from \"../actions/ActionNames\";\nimport { BeschreibungVorschlagActions } from \"../actions/BeschreibungVorschlagActionCreator\";\n\nexport class BeschreibungVorschlagReducer implements Reducer<BeschreibungVorschlagState, BeschreibungVorschlagActions> {\n    onDispatch(action: BeschreibungVorschlagActions, updateStore: (a: (s: BeschreibungVorschlagState) => BeschreibungVorschlagState) => void): void {\n        switch (action.type) {\n            case ActionNames.BeschreibungsVorschlaege: {\n                updateStore(s => {\n                    return {\n                        ...s,\n                        kontokorrentId: action.kontokorrentId,\n                        vorschlaege: action.vorschlaege\n                    };\n                })\n            }\n                break;\n        }\n    }\n}","import { Router, BodyChildRouteRenderer } from \"route-it\";\nimport { KontokorrentRouteResolver } from \"./routing/KontokorrentRouteResolver\";\nimport { Store } from \"./state/Store\";\nimport { ServiceLocator } from \"./ServiceLocator\";\nimport { AccountInfoStore } from \"./lib/AccountInfoStore\";\nimport { ApiClient } from \"./api/ApiClient\";\nimport { AccountReducer } from \"./state/reducers/AccountReducer\";\nimport { KontokorrentsReducer } from \"./state/reducers/KontokorrentsReducer\";\nimport \"./styles.scss\";\nimport { AsyncRouteResolver } from \"route-it/dist/router\";\nimport { KontokorrentDatabase } from \"./lib/KontokorrentDatabase\";\nimport { initializationActionCreatorFactory } from \"./state/actions/InitializationActionCreator\";\nimport { ServiceWorkerActions } from \"./state/actions/ServiceWorkerActions\";\nimport { BeschreibungVorschlagReducer } from \"./state/reducers/BeschreibungVorschlaegeReducer\";\n\nif (\"serviceWorker\" in navigator) {\n    window.addEventListener(\"load\", async () => {\n        navigator.serviceWorker.register(\"./sw.js\").then(registration => {\n        }).catch(registrationError => {\n            console.log('SW registration failed: ', registrationError);\n        });\n    });\n}\n\nasync function run() {\n    const store = new Store(() => {\n        return {\n            account: {\n                accountCreated: false,\n                accountCreating: false,\n                accountCreationFailed: false,\n                loginExpired: false,\n                accountInfo: null\n            },\n            kontokorrents: {\n                hinzufuegen: false,\n                hinzufuegenFailed: null,\n                creating: false,\n                creationFailed: null,\n                kontokorrents: {},\n                listeLaden: false,\n                activeKontokorrentId: null,\n                nichtGefunden: null\n            },\n            beschreibungVorschlaege: {\n                vorschlaege: [],\n                kontokorrentId: null\n            }\n        }\n    });\n    if (\"serviceWorker\" in navigator) {\n        navigator.serviceWorker.addEventListener(\"message\", ev => {\n            if (ev.data?.type == \"statedispatch\") {\n                let msg = ev.data.msg as ServiceWorkerActions;\n                store.dispatch(msg);\n            }\n        });\n    }\n    const routeResolver = new KontokorrentRouteResolver(store);\n    const router = new Router(routeResolver as AsyncRouteResolver<HTMLElement>, new BodyChildRouteRenderer());\n    const db = new KontokorrentDatabase();\n    store.addReducer(\"account\", new AccountReducer());\n    store.addReducer(\"kontokorrents\", new KontokorrentsReducer());\n    store.addReducer(\"beschreibungVorschlaege\", new BeschreibungVorschlagReducer());\n\n    const accountInfoStore = new AccountInfoStore(db);\n    const apiClient = new ApiClient(accountInfoStore);\n\n    const serviceLocator = new ServiceLocator(store,\n        router,\n        apiClient,\n        db,\n        accountInfoStore);\n    routeResolver.setServiceLocator(serviceLocator);\n\n    await initializationActionCreatorFactory(serviceLocator).initializeApplication();\n}\n\nrun().catch(err => console.error(err));","export enum AccountType {\n    google = \"google\",\n    anonym = \"anonym\"\n};\n","import { KontokorrentDatabase } from \"./KontokorrentDatabase\";\n\nimport { v4 as uuid } from \"uuid\";\n\nexport function testFeatures(): Promise<{ allPassed: boolean }> {\n    return new Promise((resolve, reject) => {\n        let indexedDBEnabled = \"indexedDB\" in window;\n        if (indexedDBEnabled) {\n            const testdbname = uuid();\n            let res = window.indexedDB.open(testdbname, 1);\n            res.onsuccess = () => {\n                resolve({\n                    allPassed: true\n                });\n                res.result.close();\n                window.indexedDB.deleteDatabase(testdbname);\n            };\n            res.onerror = () => {\n                resolve({\n                    allPassed: false\n                });\n            }\n        } else {\n            resolve({\n                allPassed: false\n            });\n        }\n    });\n}","import template from \"./FeaturesRequired.html\";\nimport { ServiceLocator } from \"../../ServiceLocator\";\nimport { RoutingActionCreator, routingActionCreatorFactory } from \"../../state/actions/RoutingActionCreator\";\nimport { testFeatures } from \"../../lib/testFeatures\";\nexport class FeaturesRequired extends HTMLElement {\n    private routingActionCreator: RoutingActionCreator;\n\n    constructor() {\n        super();\n    }\n\n    addServices(serviceLocator: ServiceLocator) {\n        this.routingActionCreator = routingActionCreatorFactory(serviceLocator);\n    }\n\n    connectedCallback() {\n        this.innerHTML = template;\n        testFeatures().then(t => {\n            if (t.allPassed) {\n                this.routingActionCreator.navigateHomeWithPageRefresh();\n            }\n        });\n    }\n\n\n    disconnectedCallback() {\n    }\n}\n\ncustomElements.define('app-features-required', FeaturesRequired);","// Module\nvar code = \"<h1>Speicherzugriff benötigt</h1> Kontokorrent speichert die Zahlungen und weitere Informationen im lokalen Speicher dieses Geräts. Auf diese Weise kann man für einige Tage eingeloggt bleiben, und die Anwendung auch verwenden, wenn die Internetverbindung schlecht ist. In den meisten Browsern (Chrome, Edge) muss dazu der Webseite erlaubt werden <strong>Cookies</strong> zu speichern. Nachdem die Berechtigung erteilt wurde die Webseite neu laden.\";\n// Exports\nexport default code;","import { Router } from \"route-it\";\nimport { ServiceLocator } from \"../ServiceLocator\";\nimport \"../components/FeaturesRequired/FeaturesRequired\";\nimport { FeaturesRequired } from \"../components/FeaturesRequired/FeaturesRequired\";\nimport { Store } from \"../state/Store\";\nimport { AsyncRouteResolver } from \"route-it/dist/router\";\n\nexport const OeffentlicherNameParam = \"oeffentlicherName\";\n\n\nexport enum Paths {\n    Login = \"login\",\n    Info = \"info\",\n    Home = \"\",\n    FeaturesRequired = \"features-required\",\n    CreateEvent = \"create-event\",\n    BezahlungEintragen = \"eintragen\",\n    MultiBezahlungEintragen = \"multi-eintragen\",\n    DatabaseDebug = \"database-debug\",\n    NichtGefunden = \"nicht-gefunden\"\n}\n\nfunction matchOeffentlicherKontokorrentRoute(route: string) {\n    let oeffentlicherKontokorrentRoute = /^kontokorrents\\/o\\/([a-zA-Z0-9\\-]+)$/.exec(route);\n    if (oeffentlicherKontokorrentRoute) {\n        let oeffentlicherName: string = oeffentlicherKontokorrentRoute[1];\n        return {\n            oeffentlicherName: oeffentlicherName\n        };\n    }\n    return null;\n}\n\nfunction matchOeffentlicherKontokorrentAusgleichRoute(route: string) {\n    let routeMatcher = /^kontokorrents\\/o\\/([a-zA-Z0-9\\-]+)\\/ausgleich-erstellen$/.exec(route);\n    if (routeMatcher) {\n        let oeffentlicherName: string = routeMatcher[1];\n        return {\n            oeffentlicherName: oeffentlicherName\n        };\n    }\n    return null;\n}\n\nexport class KontokorrentRouteResolver implements AsyncRouteResolver<HTMLElement> {\n    constructor(private store: Store) {\n    }\n\n    serviceLocator: ServiceLocator;\n    setServiceLocator(serviceLocator: ServiceLocator) {\n        this.serviceLocator = serviceLocator;\n    }\n\n    private async getKontokorrentPageComponent() {\n        const { KontokorrentPage } = await import(\"../components/KontokorrentPage/KontokorrentPage\");\n        let component = new KontokorrentPage();\n        component.addServices(this.serviceLocator);\n        return component;\n    }\n\n    async resolve(lastRoute: string, currentRoute: string, router: Router<HTMLElement>) {\n        switch (currentRoute) {\n            case Paths.Info:\n                const { Info } = await import(\"../components/Info/info\");\n                let component = new Info();\n                component.addServices(this.serviceLocator);\n                return component;\n            case Paths.FeaturesRequired: {\n                let component = new FeaturesRequired();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n            case Paths.Login: {\n                const { Login } = await import(\"../components/Login/Login\");\n                let component = new Login();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n            case Paths.CreateEvent: {\n                const { CreateKontokorrent } = await import(\"../components/CreateKontokorrent/CreateKontokorrent\");\n                let component = new CreateKontokorrent();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n        }\n        if (!this.store.state.account.accountCreated) {\n            let oeffentlicher = matchOeffentlicherKontokorrentRoute(currentRoute);\n            if (oeffentlicher) {\n                let p = new URLSearchParams();\n                p.set(OeffentlicherNameParam, oeffentlicher.oeffentlicherName);\n                router.navigate(`${Paths.Login}?${p}`, null, true);\n            }\n            else {\n                router.navigate(`${Paths.Login}`, null, true);\n            }\n            return false;\n        }\n        switch (currentRoute) {\n            case Paths.BezahlungEintragen: {\n                const { BezahlungEintragenPage } = await import(\"../components/BezahlungEintragenPage/BezahlungEintragenPage\");\n                let component = new BezahlungEintragenPage();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n            case Paths.MultiBezahlungEintragen: {\n                const { MultiBezahlungEintragenPage } = await import(\"../components/MultiBezahlungEintragenPage/MultiBezahlungEintragenPage\");\n                let component = new MultiBezahlungEintragenPage();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n            case Paths.DatabaseDebug: {\n                const { DatabaseDebug } = await import(\"../components/DatabaseDebug/DatabaseDebug\");\n                let component = new DatabaseDebug();\n                component.addServices(this.serviceLocator);\n                return component;\n            }\n        }\n        if (currentRoute.startsWith(Paths.NichtGefunden)) {\n            const { KontokorrentNichtGefunden } = await import(\"../components/KontokorrentNichtGefunden/KontokorrentNichtGefunden\");\n            let component = new KontokorrentNichtGefunden();\n            component.addServices(this.serviceLocator);\n            return component;\n        }\n        let oeffentlicherKontokorrentRouteMatch = matchOeffentlicherKontokorrentRoute(currentRoute);\n        if (oeffentlicherKontokorrentRouteMatch) {\n            let component = await this.getKontokorrentPageComponent();\n            component.setRouteParameters(oeffentlicherKontokorrentRouteMatch.oeffentlicherName);\n            return component;\n        }\n        let ausgleichMatch = matchOeffentlicherKontokorrentAusgleichRoute(currentRoute);\n        if (ausgleichMatch) {\n            const { AusgleichErstellen } = await import(\"../components/AusgleichErstellen/AusgleichErstellen\");\n            let component = new AusgleichErstellen();\n            component.addServices(this.serviceLocator);\n            component.setRouteParameters(ausgleichMatch.oeffentlicherName);\n            return component;\n        }\n        let oeffentlicherKontokorrentBezahlungRoute = /^kontokorrents\\/o\\/([a-zA-Z0-9\\-]+)\\/bezahlungen\\/([a-zA-Z0-9\\-]+)$/.exec(currentRoute);\n        if (oeffentlicherKontokorrentBezahlungRoute) {\n            let oeffentlicherName = oeffentlicherKontokorrentBezahlungRoute[1];\n            let bezahlungId = oeffentlicherKontokorrentBezahlungRoute[2];\n            const { BezahlungPage } = await import(\"../components/BezahlungPage/BezahlungPage\");\n            let component = new BezahlungPage();\n            component.addServices(this.serviceLocator);\n            component.setRouteParameters(oeffentlicherName, bezahlungId);\n            return component;\n        }\n        let component = await this.getKontokorrentPageComponent();\n        component.addServices(this.serviceLocator);\n        return component;\n    }\n}\n","import { AccountInfo } from \"../lib/AccountInfo\";\nimport { KontokorrentAusgleich } from \"../lib/ausgleich/KontokorrentAusgleich\";\nimport { BearbeitungsStatus } from \"../lib/BearbeitungsStatus\";\n\nexport interface AccountState {\n    accountCreated: boolean,\n    accountCreating: boolean,\n    accountCreationFailed: boolean\n    loginExpired: boolean;\n    accountInfo: AccountInfo\n}\n\nexport interface KontokorrentsState {\n    kontokorrents: { [id: string]: KontokorrentState };\n    hinzufuegen: boolean;\n    listeLaden: boolean;\n    hinzufuegenFailed: {\n        kontokorrentNotFound: boolean\n    }\n    creating: boolean;\n    creationFailed: { exists: boolean };\n    activeKontokorrentId: string;\n    nichtGefunden: {\n        oeffentlicherName: string\n    }\n}\n\nexport interface Person {\n    name: string;\n    id: string;\n    balance: number;\n}\n\nexport enum BezahlungStatus {\n    Zwischengespeichert = \"zwischengespeichert\",\n    Speichern = \"speichern\",\n    Gespeichert = \"gespeichert\"\n}\n\nexport interface Bezahlung {\n    id: string;\n    zeitpunkt: Date;\n    bezahlendePersonId: string;\n    empfaengerIds: string[];\n    wert: number;\n    beschreibung: string;\n    status: BezahlungStatus\n}\n\nexport const enum RequestStatus {\n    InProgress,\n    Success,\n    Failed\n}\n\nexport interface AngezeigteBezahlungState {\n    bearbeitungsStatus: BearbeitungsStatus;\n    updateStatus?: RequestStatus;\n    deleteStatus?: RequestStatus;\n}\n\nexport interface KontokorrentState {\n    id: string;\n    name: string;\n    oeffentlicherName: string;\n    personen: Person[];\n    bezahlungen: Bezahlung[];\n    synchronisieren: boolean;\n    bezahlungAnlegen: RequestStatus;\n    angezeigteBezahlung: { [id: string]: AngezeigteBezahlungState }\n    ausgleichBerechnen: boolean;\n    ausgleich: KontokorrentAusgleich;\n}\n\nexport interface BeschreibungVorschlagState {\n    kontokorrentId: string;\n    vorschlaege: string[];\n}\n\nexport interface State {\n    account: AccountState\n    kontokorrents: KontokorrentsState;\n    beschreibungVorschlaege: BeschreibungVorschlagState;\n}\n","import { Store } from \"../Store\";\nimport { ApiClient } from \"../../api/ApiClient\";\nimport { Action } from \"../lib/Action\";\nimport { AccountInfoStore } from \"../../lib/AccountInfoStore\";\nimport { v4 as uuid } from \"uuid\";\nimport { AccountType } from \"../../lib/AccountType\";\nimport { RoutingActionCreator, routingActionCreatorFactory } from \"./RoutingActionCreator\";\nimport { TokenRenewFailedException } from \"../../api/TokenRenewFailedException\";\nimport { InteractionRequiredException } from \"../../api/InteractionRequiredException\";\nimport { AccountInfo } from \"../../lib/AccountInfo\";\nimport { KontokorrentDatabase } from \"../../lib/KontokorrentDatabase\";\nimport { ServiceLocator } from \"../../ServiceLocator\";\nimport { ActionNames } from \"./ActionNames\";\n\n\nexport class AccountCreating implements Action {\n    readonly type = ActionNames.AccountCreating;\n    constructor() {\n\n    }\n}\n\nexport class AccountCreationFailed implements Action {\n    readonly type = ActionNames.AccountCreationFailed;\n    constructor() {\n\n    }\n}\n\nexport class AccountCreated implements Action {\n    readonly type = ActionNames.AccountCreated;\n    constructor(public info: AccountInfo) {\n\n    }\n}\n\nexport class AccountInitialized implements Action {\n    readonly type = ActionNames.AccountInitialized;\n    constructor(public info: AccountInfo) {\n\n    }\n}\n\nexport class LoggedOut implements Action {\n    readonly type = ActionNames.LoggedOut;\n    constructor() {\n\n    }\n}\n\nexport class LoginExpired implements Action {\n    readonly type = ActionNames.LoginExpired;\n    constructor() {\n\n    }\n}\n\nexport type AccountActions = AccountInitialized\n    | AccountCreating\n    | AccountCreated\n    | AccountCreationFailed\n    | LoggedOut\n    | LoginExpired;\n\nexport class AccountActionCreator {\n\n    constructor(private store: Store,\n        private apiClient: ApiClient,\n        private accountInfoStore: AccountInfoStore,\n        private routingActionCreator: RoutingActionCreator,\n        private db: KontokorrentDatabase) {\n    }\n\n    async initializeAccount(): Promise<boolean> {\n        let info = await this.accountInfoStore.get();\n        if (!info) {\n            return false;\n        }\n        this.store.dispatch(new AccountInitialized(info));\n        this.getUserInfo();\n        return true;\n    }\n\n    async getUserInfo() {\n        try {\n            let userInfo = await this.apiClient.getUserInfo();\n        }\n        catch (e) {\n            if (e instanceof TokenRenewFailedException) {\n                let accountInfo = await this.accountInfoStore.get();\n                if (!e.networkError && accountInfo.type == AccountType.anonym) {\n                    // anonymer token renew failed - wir haben ein ernstes problem\n                    // reset and duck out\n                    await this.accountInfoStore.clear();\n                    window.location.reload();\n                }\n            }\n            else if (e instanceof InteractionRequiredException) {\n                this.store.dispatch(new LoginExpired());\n            }\n        }\n    }\n\n    async ensureAccount() {\n        if (!this.store.state.account.accountCreated) {\n            let accountInfo = {\n                id: uuid(),\n                secret: uuid(),\n                type: AccountType.anonym\n            };\n            this.store.dispatch(new AccountCreating());\n            let res = await this.apiClient.neuerBenutzer(accountInfo.id, accountInfo.secret);\n            if (!res.success) {\n                this.store.dispatch(new AccountCreationFailed());\n            }\n            else {\n                this.store.dispatch(new AccountCreated(accountInfo));\n                await this.accountInfoStore.set(accountInfo);\n            }\n            return res.success;\n        }\n        return true;\n    }\n\n    async logout() {\n        await this.accountInfoStore.clear();\n        await this.db.clear();\n        this.store.dispatch(new LoggedOut());\n        this.routingActionCreator.navigateLogin();\n    }\n}\n\nexport function accountActionCreatorFactory(serviceLocator: ServiceLocator) {\n    return serviceLocator.get(\"AccountActionCreator\",\n        serviceLocator => new AccountActionCreator(serviceLocator.store,\n            serviceLocator.apiClient,\n            serviceLocator.accountInfoStore,\n            routingActionCreatorFactory(serviceLocator),\n            serviceLocator.db\n        ));\n}","import { Store } from \"../Store\";\nimport { ApiClient } from \"../../api/ApiClient\";\nimport { Action } from \"../lib/Action\";\nimport { KontokorrentInfo } from \"../../api/KontokorrentInfo\";\nimport { KontokorrentDatabase } from \"../../lib/KontokorrentDatabase\";\nimport { InteractionRequiredException } from \"../../api/InteractionRequiredException\";\nimport { RoutingActionCreator, routingActionCreatorFactory } from \"./RoutingActionCreator\";\nimport { ServiceLocator } from \"../../ServiceLocator\";\nimport { ActionNames } from \"./ActionNames\";\n\nexport class KontokorrentListeLaden implements Action {\n    readonly type = ActionNames.KontokorrentListeLaden;\n    constructor() {\n\n    }\n}\n\nexport class KontokorrentListe implements Action {\n    readonly type = ActionNames.KontokorrentListe;\n    constructor(public kontokorrents: KontokorrentInfo[]) {\n\n    }\n}\n\nexport class KontokorrentListeLadenFailed implements Action {\n    readonly type = ActionNames.KontokorrentListeLadenFailed;\n    constructor(public interactionRequired: boolean) {\n\n    }\n}\n\nexport type KontokorrentListenActions =\n    | KontokorrentListeLaden\n    | KontokorrentListeLadenFailed\n    | KontokorrentListe;\n\nexport class KontokorrentListenActionCreator {\n    constructor(private store: Store,\n        private apiClient: ApiClient,\n        private routingActionCreator: RoutingActionCreator,\n        private db: KontokorrentDatabase) {\n\n    }\n\n    async navigiereZuLetztGesehenem(replace?: boolean) {\n        let id = await this.db.getZuletztGesehenerKontokorrentId();\n        if (id) {\n            await this.routingActionCreator.navigateKontokorrentById(id, replace);\n            return true;\n        }\n        return false;\n    }\n\n    async syncKontokorrentListe() {\n        this.store.dispatch(new KontokorrentListeLaden());\n        const listenTask = this.apiClient.kontokorrentsAuflisten();\n\n        let kontokorrents = await this.db.getKontokorrents();\n        this.store.dispatch(new KontokorrentListe(kontokorrents));\n        try {\n            let liste = await listenTask;\n            await this.db.setKontokorrents(liste.map(e => {\n                return {\n                    id: e.id,\n                    name: e.name,\n                    personen: e.personen,\n                    oeffentlicherName: e.oeffentlicherName\n                }\n            }));\n            this.store.dispatch(new KontokorrentListe(liste));\n        }\n        catch (e) {\n            if (e instanceof InteractionRequiredException) {\n                this.store.dispatch(new KontokorrentListeLadenFailed(true));\n            }\n            else {\n                this.store.dispatch(new KontokorrentListeLadenFailed(false));\n            }\n        }\n    }\n}\n\nexport function kontokorrentListenActionCreatorFactory(serviceLocator: ServiceLocator) {\n    return serviceLocator.get(\"KontokorrentListenActionCreator\",\n        serviceLocator => new KontokorrentListenActionCreator(\n            serviceLocator.store,\n            serviceLocator.apiClient,\n            routingActionCreatorFactory(serviceLocator),\n            serviceLocator.db\n        ));\n}","import { Router } from \"route-it\";\nimport { KontokorrentDatabase } from \"../../lib/KontokorrentDatabase\";\nimport { OeffentlicherNameParam, Paths } from \"../../routing/KontokorrentRouteResolver\";\nimport { ServiceLocator } from \"../../ServiceLocator\";\nimport { Store } from \"../Store\";\nexport class RoutingActionCreator {\n    constructor(private router: Router<HTMLElement>, private db: KontokorrentDatabase,\n        private store: Store) {\n    }\n\n    navigateHomeWithPageRefresh() {\n        this.router.destroy();\n        window.location.href = \"\";\n    }\n\n    navigateHome() {\n        this.router.navigate(Paths.Home, null);\n    }\n    navigateLogin(replace?: boolean) {\n        this.router.navigate(Paths.Login, null, replace);\n    }\n    navigateNichtGefunden(oeffentlicherName: string) {\n        let p = new URLSearchParams();\n        p.set(OeffentlicherNameParam, oeffentlicherName);\n        this.router.navigate(`${Paths.NichtGefunden}?${p}`, null, true);\n    }\n    navigateFeaturesRequired() {\n        this.router.navigate(Paths.FeaturesRequired, null);\n    }\n    navigate(path: string) {\n        this.router.navigate(path, null);\n    }\n    async navigateKontokorrentById(id: string, replace?: boolean) {\n        let kk = await this.db.getKontokorrent(id);\n        if (kk.oeffentlicherName) {\n            this.navigateKontokorrentByOeffentlicherName(kk.oeffentlicherName, replace);\n            return;\n        }\n        throw new Error(\"Cannot navigate to private Kontokorrent: not yet implemented\");\n    }\n\n    navigateKontokorrentByOeffentlicherName(oeffentlicherName: string, replace?: boolean) {\n        this.router.navigate(`kontokorrents/o/${oeffentlicherName}`, null, replace);\n    }\n\n    navigateBezahlung(kontokorrentId: string, id: string, replace?: boolean) {\n        let kk = this.store.state.kontokorrents.kontokorrents[kontokorrentId];\n        if (kk.oeffentlicherName) {\n            this.router.navigate(`kontokorrents/o/${kk.oeffentlicherName}/bezahlungen/${id}`, null, replace);\n            return;\n        }\n        throw new Error(\"Cannot navigate to private Kontokorrent Bezahlung: not yet implemented\");\n    }\n}\n\nexport function routingActionCreatorFactory(serviceLocator: ServiceLocator) {\n    return serviceLocator.get(\"RoutingActionCreator\",\n        serviceLocator => new RoutingActionCreator(serviceLocator.router, serviceLocator.db, serviceLocator.store));\n}\n","export const NeueBezahlungBackgroundSyncTag = \"NeueBezahlungBackgroundSync\";","export function sortByAlphabetically<T, P extends keyof T>(collection: T[], keySelector: (x: T) => string): T[] {\n    return collection.sort((a, b) => keySelector(a).toLowerCase().localeCompare(keySelector(b).toLowerCase()));\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + {\"41\":\"604e0a4458a1fb0ae788\",\"57\":\"2dc701d406b87acee6b4\",\"81\":\"1d25cb401564445d7ad8\",\"90\":\"48fb7c2f304b1d02c65e\",\"182\":\"ef766ce421840f41fd1f\",\"215\":\"0fb19ba11a0ccf6d6d5c\",\"416\":\"aa65eb70992f751766e4\",\"426\":\"627dcd4a6dde53a37878\",\"468\":\"e21c5ee30208b4d4a155\",\"502\":\"3600848cce0a165c0fbf\",\"539\":\"6522267a31a485ffc4f5\",\"614\":\"90f2b8f81a2928058ab0\",\"639\":\"5f2324b1f21a88f034da\",\"895\":\"a00e6890e9e878b4171f\"}[chunkId] + \".bundle.js\";\n};","// This function allow to reference all chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + {\"41\":\"126ece22113028461d65\",\"57\":\"8c5b220bf6f482881a90\",\"90\":\"5663e5679086c0b02d3d\",\"182\":\"9b1627dd16c4f280ffca\",\"215\":\"ef1870a281d608c8697a\",\"426\":\"256b426c38ecc9e0056e\",\"468\":\"321291a696fc4746510f\",\"502\":\"58cd5cac4d95c868efd1\",\"539\":\"5cf040536825e560c5ac\",\"895\":\"312b298740086c9e1385\"}[chunkId] + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/v2/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t826: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkkontokorrent\"] = self[\"webpackChunkkontokorrent\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [820,119], function() { return __webpack_require__(5134); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","inProgress","dataWebpackPrefix","loadStylesheet","installedCssChunks","InteractionRequiredException","TokenRenewFailedException","constructor","networkError","Store","initState","this","subscriptions","reducerSubscriptions","state","subscribe","area","call","sub","push","splice","indexOf","addReducer","reducer","dispatch","action","updatedAreas","s","applyUpdateFn","cb","onDispatch","err","console","error","type","length","ServiceLocator","store","router","apiClient","db","accountInfoStore","services","get","name","factoryFunction","AccountInfoStore","accountInfo","setAccountInfo","getAccountInfo","clearAccountInfo","tokenType","getAccessToken","value","lastTimeStamp","updateAccessTokenIfNewer","async","postJson","url","body","token","init","method","headers","JSON","stringify","fetch","ApiException","API_URL","environment","NeueBezahlungFailedException","BezahlungBearbeitenFailedException","BezahlungLoeschenFailedException","baseUrl","ApiClient","id","secret","ok","success","res","getAuthHeader","json","oeffentlicherName","einladungsCode","params","encodeURIComponent","status","request","exists","kontokorrentId","ab","query","notfound","aktionen","mapAktionen","a","bezahlung","zeitpunkt","Date","aktion","bezahlungId","info","Error","AccountType","tokenResponse","tokenInfo","expires","parse","timestamp","AccountReducer","updateStore","accountCreating","accountCreationFailed","accountCreated","loginExpired","interactionRequired","KontokorrentsReducer","listeLaden","kontokorrents","extendMap","hinzufuegen","hinzufuegenFailed","kontokorrentNotFound","notFound","creating","creationFailed","nichtGefunden","kontokorrent","synchronisieren","personen","map","p","balance","bezahlungen","bezahlungAnlegen","angezeigteBezahlung","ausgleich","ausgleichBerechnen","activeKontokorrentId","updateKontokorrentStatus","extendPersonenInfo","Object","entries","e","updateAngezeigteBezahlung","bearbeitungsStatus","upsertBezahlung","updateStatus","bearbeiteteBezahlungId","removeBezahlung","deleteStatus","geloeschteBezahlungId","updateKontokorrentStatusFn","ks","update","b","existing","find","d","personenInfo","personenMap","Map","set","Array","from","values","kk","k","v","KontokorrentsStore","AppStateStore","AktionenStore","NeueBezahlungenStore","KontokorrentDatabase","upgrade","oldVersion","newVersion","createObjectStore","keyPath","createIndex","put","zuletztGesehenerKontokorrentId","accesstokens","accountinfo","objectStoreNames","contains","deleteObjectStore","close","withInitialized","sortBy","getAll","mapped","unwrapped","Promise","resolve","reject","tx","transaction","onerror","oncomplete","objectStore","add","ev","log","laufendeNummer","preventDefault","stopPropagation","appState","kks","getKontokorrents","filter","some","delete","newIds","ex","combined","getFromIndex","getAllFromIndex","clear","t","durability","done","m","InitializationActionCreator","routingActionCreator","accountActionCreator","kontokorrentsActionCreator","testFeatures","allPassed","run","navigateFeaturesRequired","initialized","initializeAccount","syncKontokorrentListe","window","requestIdleCallback","zwischengespeicherteSynchronisieren","navigator","reg","serviceWorker","ready","getZwischengespeicherteBezahlungen","sync","register","zwischengespeicherteSynchronisierenAsync","catch","BeschreibungVorschlagReducer","vorschlaege","addEventListener","then","registration","registrationError","account","beschreibungVorschlaege","data","msg","routeResolver","KontokorrentRouteResolver","serviceLocator","setServiceLocator","initializationActionCreatorFactory","initializeApplication","testdbname","indexedDB","open","onsuccess","result","deleteDatabase","FeaturesRequired","HTMLElement","super","addServices","connectedCallback","innerHTML","navigateHomeWithPageRefresh","disconnectedCallback","customElements","define","OeffentlicherNameParam","Paths","matchOeffentlicherKontokorrentRoute","route","oeffentlicherKontokorrentRoute","exec","KontokorrentPage","component","lastRoute","currentRoute","Info","Login","CreateEvent","CreateKontokorrent","oeffentlicher","URLSearchParams","navigate","BezahlungEintragen","BezahlungEintragenPage","MultiBezahlungEintragen","MultiBezahlungEintragenPage","DatabaseDebug","startsWith","NichtGefunden","KontokorrentNichtGefunden","oeffentlicherKontokorrentRouteMatch","getKontokorrentPageComponent","setRouteParameters","ausgleichMatch","routeMatcher","matchOeffentlicherKontokorrentAusgleichRoute","AusgleichErstellen","oeffentlicherKontokorrentBezahlungRoute","BezahlungPage","BezahlungStatus","AccountCreating","AccountCreationFailed","AccountCreated","AccountInitialized","LoggedOut","LoginExpired","AccountActionCreator","getUserInfo","location","reload","neuerBenutzer","navigateLogin","accountActionCreatorFactory","KontokorrentListeLaden","KontokorrentListe","KontokorrentListeLadenFailed","KontokorrentListenActionCreator","replace","getZuletztGesehenerKontokorrentId","navigateKontokorrentById","listenTask","kontokorrentsAuflisten","liste","setKontokorrents","kontokorrentListenActionCreatorFactory","RoutingActionCreator","destroy","href","navigateHome","navigateNichtGefunden","path","getKontokorrent","navigateKontokorrentByOeffentlicherName","navigateBezahlung","routingActionCreatorFactory","NeueBezahlungBackgroundSyncTag","sortByAlphabetically","collection","keySelector","sort","toLowerCase","localeCompare","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","O","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","keys","every","key","r","n","getter","__esModule","definition","o","defineProperty","enumerable","f","chunkId","all","reduce","promises","u","miniCssF","g","globalThis","Function","obj","prop","prototype","hasOwnProperty","l","script","needAttach","scripts","document","getElementsByTagName","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","setTimeout","bind","target","head","appendChild","Symbol","toStringTag","fullhref","existingLinkTags","dataHref","tag","rel","existingStyleTags","findStylesheet","linkTag","errorType","realHref","code","createStylesheet","miniCss","baseURI","self","installedChunks","installedChunkData","promise","realSrc","message","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}