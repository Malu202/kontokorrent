(self.webpackJsonp=self.webpackJsonp||[]).push([[1],Array(33).concat([function(e,t,n){"use strict";function a(e,t){e.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),t.navigate(e.getAttribute("href"))})})}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(e,t,n){this.listElement=e,this.keySelector=t,this.createElement=n,this.keyToElement=new Map,this.elementToKey=new WeakMap}update(e,t){let n=new Map,a=e=>n.get(e)||(()=>{let t=this.keySelector(e);return n.set(e,t),t})();for(let n of Array.from(this.listElement.children)){let s=n,r=e.find(e=>this.elementToKey.get(s)==a(e));r?t(s,r):this.listElement.removeChild(s)}let s=null,r=new Map;for(let n of e){let e=a(n),i=this.keyToElement.get(e);i||(i=this.createElement(n),t(i,n),this.elementToKey.set(i,e)),r.set(e,i),null==s&&i!=this.listElement.firstElementChild?this.listElement.prepend(i):null!=s&&s.nextElementSibling!=i&&s.insertAdjacentElement("afterend",i),s=i}this.keyToElement=r}}},function(e,t,n){"use strict";class a extends HTMLElement{constructor(){super(),this.popupShown=!1,this.keyListener=this.keyListener.bind(this),this.clickListener=this.clickListener.bind(this)}connectedCallback(){this.updateStyles()}keyListener(e){"Escape"==e.key&&this.hide()}clickListener(e){this.contains(event.target)||this.hide()}hide(){this.popupShown&&(document.removeEventListener("keydown",this.keyListener),document.removeEventListener("click",this.clickListener),this.popupShown=!1,this.updateStyles())}show(){this.popupShown||(document.addEventListener("keydown",this.keyListener),document.addEventListener("click",this.clickListener),this.popupShown=!0,this.updateStyles())}updateStyles(){this.style.display=this.popupShown?"block":"none"}toggle(){this.popupShown?this.hide():this.show()}disconnectedCallback(){this.hide()}}customElements.define("app-popup",a)},function(e,t){e.exports='<header class=app-bar> <kontokorrent-select class=app-bar__kontokorrent-select></kontokorrent-select> <nav class=app-bar__links> <button id=logout-button class=app-bar__link title=Logout> <span class=material-icons> exit_to_app </span> </button> <a href=info class=app-bar__link title="Informationen über diese App"> <span class=material-icons> info </span> </a> </nav> </header> <app-popup id=logout-dialog> <div class=dialog__backdrop></div> <div class=dialog> <p> Wirklich aus allen Kontokorrents ausloggen? </p> <div class=dialog__button-pane> <button id=abort-logout class=button>Abbrechen</button> <button id=confirm-logout class=button>Ausloggen</button> </div> </div> </app-popup>'},function(e,t,n){},function(e,t){e.exports='<div class=kontokorrent-select-wrapper> <div class=kontokorrent-select> <h1 data-ref=kontokorrent-name class=kontokorrent-select__name>Kontokorrent</h1> <button class=kontokorrent-select__choose title="anderen Kontokorrent wählen"> <span class=material-icons> arrow_drop_down </span> </button> </div> <app-popup class=kontokorrent-select__popup> <kontokorrent-select-list></kontokorrent-select-list> <div class=kontokorrent-select__buttons> <button id=add-kontokorrent class=button>weiteren hinzufügen</button> </div> </app-popup> </div>'},function(e,t,n){},function(e,t){e.exports="<ol data-ref=list class=kontokorrent-select-list> </ol>"},function(e,t,n){},function(e,t){e.exports="<a data-ref=link class=kontokorrent-select-list__entry> <span data-ref=name></span> </a>"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(36),s=n.n(a),r=(n(37),n(0)),i=n(33),o=n(38),l=n.n(o),c=(n(39),n(40)),h=n.n(c),u=(n(41),n(9)),d=n(34),p=n(42),b=n.n(p);class k extends HTMLElement{constructor(){super(),this.innerHTML=b.a,this.name=this.querySelector('[data-ref="name"]'),this.link=this.querySelector('[data-ref="link"]'),this.clickEvent=this.clickEvent.bind(this)}connectedCallback(){this.link.addEventListener("click",this.clickEvent)}clickEvent(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("gotokontokorrent",{detail:this.kontokorrent.id,bubbles:!0}))}disconnectedCallback(){this.link.removeEventListener("click",this.clickEvent)}update(e,t){this.kontokorrent=e,this.name.innerText=e.name,this.link.href="kontokorrents/"+e.id,this.link.classList.toggle("kontokorrent-select-list__entry--active",t)}}customElements.define("kontokorrent-select-list-entry",k);class g extends HTMLElement{constructor(){super(),this.innerHTML=h.a,this.list=this.querySelector('[data-ref="list"]'),this._kontokorrents=[],this.kontokorrentsRenderer=new d.a(this.list,e=>e.id,()=>{let e=document.createElement("li");return e.appendChild(new k),e})}connectedCallback(){}disconnectedCallback(){}update(){this.kontokorrentsRenderer.update(this._kontokorrents,(e,t)=>{e.firstChild.update(t,this._activeKontokorrentId==t.id)})}set kontokorrents(e){this._kontokorrents=Object(u.a)(e,e=>e.name),this.update()}set activeKontokorrentId(e){this._activeKontokorrentId=e,this.update()}}customElements.define("kontokorrent-select-list",g);n(35);class m extends HTMLElement{constructor(){super(),this.innerHTML=l.a,this.kontokorrentName=this.querySelector('[data-ref="kontokorrent-name"]'),this.kontokorrentSelectList=this.querySelector("kontokorrent-select-list"),this.addButton=this.querySelector("#add-kontokorrent"),this._kontokorrents=null}connectedCallback(){this.popup=this.querySelector("app-popup"),this.updateAttributes(),this.addEventListener("click",e=>{this.popup.contains(event.target)||(this.popup.toggle(),e.stopPropagation())}),this.addButton.addEventListener("click",e=>{this.dispatchEvent(new CustomEvent("addkontokorrent"))}),this.kontokorrentSelectList.addEventListener("gotokontokorrent",()=>{this.popup.hide()})}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.activeKontokorrentId=this.getAttribute("active-kontokorrent-id"),this.kontokorrentSelectList.activeKontokorrentId=this.activeKontokorrentId,this.updatesStyle()}static get observedAttributes(){return["active-kontokorrent-id"]}set kontokorrents(e){this.kontokorrentSelectList.kontokorrents=e,this._kontokorrents=e,this.updatesStyle()}updatesStyle(){if(this._kontokorrents&&this._kontokorrents.length){let e=this._kontokorrents.find(e=>e.id==this.activeKontokorrentId);this.kontokorrentName.innerText=e?e.name:"(Kontokorrent wählen)"}}}customElements.define("kontokorrent-select",m);var f=n(7),v=function(e,t,n,a){return new(n||(n=Promise))((function(s,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};class y extends HTMLElement{constructor(){super(),this.innerHTML=s.a,this.kontokorrentSelect=this.querySelector("kontokorrent-select"),this.logoutDialog=this.querySelector("#logout-dialog")}connectedCallback(){document.body.classList.add("body--app-bar"),this.querySelector("#logout-button").addEventListener("click",e=>{this.logoutDialog.toggle(),e.stopPropagation()}),this.querySelector("#confirm-logout").addEventListener("click",()=>v(this,void 0,void 0,(function*(){yield this.accountActionCreator.logout()}))),this.querySelector("#abort-logout").addEventListener("click",()=>{this.logoutDialog.hide()}),Object(i.a)(this.querySelectorAll("a"),this.routingActionCreator),this.subscription=this.store.subscribe(null,e=>this.applyStoreState(e)),this.applyStoreState(this.store.state),this.kontokorrentSelect.addEventListener("addkontokorrent",()=>{this.routingActionCreator.navigateLogin()})}applyStoreState(e){this.kontokorrentSelect.kontokorrents=Object.values(e.kontokorrents.kontokorrents),this.kontokorrentSelect.setAttribute("active-kontokorrent-id",e.kontokorrents.activeKontokorrentId)}addServices(e){this.store=e.store,this.routingActionCreator=r.a.locate(e),this.accountActionCreator=f.a.locate(e)}disconnectedCallback(){document.body.classList.remove("body--app-bar"),this.subscription()}}const w="app-bar";customElements.define(w,y)},,,,,,,,,function(e,t){e.exports='<app-bar></app-bar> <div style=display:none id=login-expired>Google-Login abgelaufen: zum Synchronisieren neu anmelden</div> <balance-anzeige id=balance-anzeige></balance-anzeige> <div class=kontokorrentpage-menu> <a id=eintragen-desktop class="floating-action-button floating-action-button--embed" href=eintragen> <span class=material-icons> add </span> eintragen </a> <span class=kontokorrentpage-menu__sync-display id=spinner style=display:none> <div class=spinner></div> synchronisieren </span> </div> <bezahlungen-view id=bezahlungen-view></bezahlungen-view> <a id=eintragen-mobile class="floating-action-button floating-action-button--fixed" href=eintragen> <span class=material-icons> add </span> eintragen </a>'},function(e,t){e.exports="<div class=balance-anzeige-element__graphic-container> <div class=balance-anzeige-element__bar data-ref=bar></div> <div class=balance-anzeige-element__horizontal-line></div> <span class=balance-anzeige-element__balance data-ref=balance-container> <span data-ref=balance-text></span>€ </span> </div> <div class=balance-anzeige-element__text-container> <span data-ref=person-name class=balance-anzeige-element__name></span> </div>"},function(e,t,n){},function(e,t){e.exports="<div class=balance-anzeige-element__graphic-container> <div class=balance-anzeige-element__bar data-ref=bar></div> <div class=balance-anzeige-element__horizontal-line></div> <span class=balance-anzeige-element__balance data-ref=balance-container> <span data-ref=balance-text></span>€ </span> </div> <div class=balance-anzeige-element__text-container> <span data-ref=person-name class=balance-anzeige-element__name></span> </div>"},function(e,t){e.exports="<div id=bezahlungen-container> </div> <button id=show-more class=button>Mehr anzeigen</button>"},function(e,t,n){},function(e,t){e.exports="<div class=bezahlung-card__beschreibung> <div data-ref=beschreibung></div> <div class=bezahlung-card__personen> <span data-ref=bezahlende-person></span> für <span data-ref=empfaenger></span> </div> </div> <div class=bezahlung-card__wert> <span data-ref=wert></span>€ </div>"},function(e,t,n){},function(e,t){e.exports="<h3 data-ref=title class=bezahlungen-group__title>Gruppe</h3> <div class=bezahlungen-group__container data-ref=container></div>"},function(e,t,n){},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"KontokorrentPage",(function(){return q}));var a=n(52),s=n.n(a),r=n(0),i=n(33),o=n(8),l=n(43),c=n(53),h=n.n(c);n(54);function u(e){var t,n,a,s,r,i=""+(t=2,n=e.toString(),a=n.indexOf("E"),s=n.indexOf("e"),r=0,s>-1?(r=parseFloat(n.substring(s+1)),n=n.substring(0,s)):a>-1&&(r=parseFloat(n.substring(a+1)),n=n.substring(0,a)),Number(Math.round(Number(n+"e"+(r+t)))+"e-"+t)),o=i.toString().indexOf(".");return-1!=o&&1==i.toString().length-(o+1)&&(i+="0"),i}class d extends HTMLElement{constructor(){super(),this.innerHTML=h.a,this.personNameElement=this.querySelector('[data-ref="person-name"]'),this.balanceTextElement=this.querySelector('[data-ref="balance-text"]'),this.balanceContainerElement=this.querySelector('[data-ref="balance-container"]'),this.barElement=this.querySelector('[data-ref="bar"]')}connectedCallback(){requestAnimationFrame(()=>{this.barElement.style.transform="scaleY(0)",this.updatesStyle()})}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){this.personName=this.getAttribute("person-name"),this.balance=parseFloat(this.getAttribute("balance")),this.balanceRange=Math.max(2,parseFloat(this.getAttribute("balance-range"))),this.updatesStyle()}static get observedAttributes(){return["person-name","balance","balance-range"]}updatesStyle(){requestAnimationFrame(()=>{this.personNameElement.innerText=this.personName,this.balanceTextElement.innerText=u(this.balance);let e=Math.sign(this.balance)*Math.abs(this.balance)/this.balanceRange,t=1.9*e;this.barElement.style.transform=`scaleY(${e})`,this.balanceContainerElement.style.transform=Math.sign(this.balance)<0?`translateY(calc(${t}em - 150%))`:`translateY(calc(${t}em + 50%))`,e>0?(this.barElement.classList.add("balance-anzeige-element__bar--negative"),this.barElement.classList.remove("balance-anzeige-element__bar--positive")):(this.barElement.classList.remove("balance-anzeige-element__bar--negative"),this.barElement.classList.add("balance-anzeige-element__bar--positive"))})}}customElements.define("balance-anzeige-element",d);var p=n(55),b=n.n(p),k=n(34);class g extends HTMLElement{constructor(){super(),this.innerHTML=b.a,this.personenRenderer=new k.a(this,e=>e.id,e=>new d)}connectedCallback(){}disconnectedCallback(){}setBalance(e){this.personen=e,this.balanceRange=Math.max(...Object.values(e).map(e=>Math.abs(e.balance))),this.updatesStyle()}updatesStyle(){this.personenRenderer.update(this.personen,(e,t)=>{e.setAttribute("person-name",t.name),e.setAttribute("balance",""+t.balance),e.setAttribute("balance-range",""+this.balanceRange)})}}customElements.define("balance-anzeige",g);var m=n(56),f=n.n(m),v=(n(57),n(58)),y=n.n(v);n(59);class w extends HTMLElement{constructor(){super(),this.attributeStore={beschreibung:null,bezahlendePerson:null,empfaenger:null,wert:null},this.innerHTML=y.a,this.beschreibungElement=this.querySelector('[data-ref="beschreibung"]'),this.bezahlendePersonElement=this.querySelector('[data-ref="bezahlende-person"]'),this.empfaengerElement=this.querySelector('[data-ref="empfaenger"]'),this.wertElement=this.querySelector('[data-ref="wert"]')}connectedCallback(){}disconnectedCallback(){}attributeChangedCallback(){this.updateAttributes()}checkChanged(e,t){let n=t();return this.attributeStore[e]!=n&&(this.attributeStore[e]=n,!0)}updateAttributes(){[this.checkChanged("bezahlendePerson",()=>this.getAttribute("bezahlende-person")),this.checkChanged("beschreibung",()=>this.getAttribute("beschreibung")),this.checkChanged("wert",()=>parseFloat(this.getAttribute("wert"))),this.checkChanged("empfaenger",()=>this.getAttribute("empfaenger"))].some(e=>e)&&this.updatesStyle()}static get observedAttributes(){return["beschreibung","bezahlende-person","wert","empfaenger"]}updatesStyle(){this.beschreibungElement.innerText=this.attributeStore.beschreibung,this.bezahlendePersonElement.innerText=this.attributeStore.bezahlendePerson,this.wertElement.innerText=u(this.attributeStore.wert),this.empfaengerElement.innerText=this.attributeStore.empfaenger}}function E(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function S(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function _(e){S(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function z(e){S(1,arguments);var t=_(e);return t.setHours(0,0,0,0),t}function L(e,t){S(1,arguments);var n=t||{},a=n.locale,s=a&&a.options&&a.options.weekStartsOn,r=null==s?0:E(s),i=null==n.weekStartsOn?r:E(n.weekStartsOn);if(!(i>=0&&i<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var o=_(e),l=o.getDay(),c=(l<i?7:0)+l-i;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function C(e,t){const n=new Map;return e.forEach(e=>{const a=e[t],s=n.get(a);s?s.push(e):n.set(a,[e])}),n}customElements.define("bezahlung-card",w);var A=n(60),x=n.n(A);class M extends HTMLElement{constructor(){super(),this.innerHTML=x.a,this.container=this.querySelector('[data-ref="container"]'),this.titleElement=this.querySelector('[data-ref="title"]'),this.bezahlungenRenderer=new k.a(this.container,e=>e.id,e=>new w)}connectedCallback(){}disconnectedCallback(){}setBezahlungen(e){this.bezahlungenRenderer.update(e,(e,t)=>{e.setAttribute("beschreibung",t.beschreibung),e.setAttribute("wert",""+t.wert),e.setAttribute("bezahlende-person",t.bezahlendePersonName),e.setAttribute("empfaenger",t.empfaenger)})}set title(e){this.titleElement.innerText=e}}customElements.define("bezahlungen-group",M);class T extends HTMLElement{constructor(){super(),this.minTage=3,this.minEintraege=20,this.all=!1,this.innerHTML=f.a,this.bezahlungenContainer=this.querySelector("#bezahlungen-container"),this.showMoreButton=this.querySelector("#show-more"),this.showMoreClick=this.showMoreClick.bind(this),this.groupRenderer=new k.a(this.bezahlungenContainer,e=>""+e[0],()=>new M)}connectedCallback(){this.showMoreButton.addEventListener("click",this.showMoreClick)}disconnectedCallback(){}setShowMoreButtonDisplay(){this.bezahlungen&&(this.showMoreButton.style.display=this.bezahlungen.length>this.anzahlEintraege?"inline":"none")}showMoreClick(){let e=this.bezahlungenContainer.lastElementChild;this.anzahlEintraege+=20,e&&e.scrollIntoView(),this.setShowMoreButtonDisplay()}formatEmpfaenger(e,t){return e.empfaengerIds.length==t.length?"alle":e.empfaengerIds.map(e=>t.find(t=>t.id==e).name).join(", ")}setBezahlungen(e,t){this.bezahlungen=e,this.personen=t,this.setShowMoreButtonDisplay(),this.render()}render(){let e=this.bezahlungen.sort((e,t)=>+t.zeitpunkt-+e.zeitpunkt),t=e;this.all||(t=e.filter(e=>e.zeitpunkt>function(e,t){S(2,arguments);var n=_(e),a=E(t);return isNaN(a)?new Date(NaN):a?(n.setDate(n.getDate()+a),n):n}(z(Date.now()),-this.minTage)),t.length<this.minEintraege&&(t=e.slice(0,this.minEintraege)));let n=t.map(e=>({bezahlendePersonName:this.personen.find(t=>t.id==e.bezahlendePersonId).name,wert:e.wert,beschreibung:e.beschreibung,empfaenger:this.formatEmpfaenger(e,this.personen),tag:+z(e.zeitpunkt),id:e.id,woche:+L(e.zeitpunkt)})),a=!1,s=Array.of(...C(n,"tag").entries());s.reduce((e,t)=>e+t[1].length,0)/s.length<3&&(s=Array.of(...C(n,"woche").entries()),a=!0);let r=s.sort((e,t)=>t[0]-e[0]);this.groupRenderer.update(r,(e,t)=>{e.setBezahlungen(t[1]),e.title=a?this.formatWeek(new Date(t[0])):this.formatDay(new Date(t[0]))})}get anzahlEintraege(){return this.minEintraege}set anzahlEintraege(e){this.minEintraege=e,this.render()}formatWeek(e){let t,n=function(e,t){S(1,arguments);var n=t||{},a=n.locale,s=a&&a.options&&a.options.weekStartsOn,r=null==s?0:E(s),i=null==n.weekStartsOn?r:E(n.weekStartsOn);if(!(i>=0&&i<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var o=_(e),l=o.getDay(),c=6+(l<i?-7:0)-(l-i);return o.setDate(o.getDate()+c),o.setHours(23,59,59,999),o}(e);const a=e=>new Intl.DateTimeFormat(["de-AT"],{day:"numeric",month:"long"}).format(e);return t=n.getMonth()==e.getMonth()?`${new Intl.DateTimeFormat(["de-AT"],{day:"numeric"}).format(e)}. - ${a(n)}`:`${a(e)} - ${a(n)}`,t}formatDay(e){return new Intl.DateTimeFormat(["de-AT"],{weekday:"short",year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}}customElements.define("bezahlungen-view",T);n(61);class q extends HTMLElement{constructor(){super(),this.innerHTML=s.a,this.appBar=this.querySelector(l.a),this.balanceAnzeige=this.querySelector("#balance-anzeige"),this.bezahlungenView=this.querySelector("#bezahlungen-view"),this.kontokorrentSpinner=this.querySelector("#spinner")}addServices(e){this.store=e.store,this.routingActionCreator=r.a.locate(e),this.kontokorrentsActionCreator=o.a.locate(e),this.appBar.addServices(e)}connectedCallback(){this.subscription=this.store.subscribe(null,e=>this.applyStoreState(e)),this.appBar.addEventListener("gotokontokorrent",e=>{this.routingActionCreator.navigateKontokorrent(e.detail)}),Object(i.a)(this.querySelectorAll("#eintragen-desktop, #eintragen-mobile"),this.routingActionCreator)}applyStoreState(e){this.kontokorrent=e.kontokorrents.kontokorrents[e.kontokorrents.activeKontokorrentId],this.kontokorrent&&(document.title=this.kontokorrent.name+" - Kontokorrent",this.kontokorrent.personen&&(this.balanceAnzeige.setBalance(this.kontokorrent.personen),this.bezahlungenView.setBezahlungen(this.kontokorrent.bezahlungen,this.kontokorrent.personen)),this.kontokorrentSpinner.style.display=this.kontokorrent.synchronisieren?"flex":"none")}setKontokorrentId(e){this.kontokorrentsActionCreator.kontokorrentOeffnen(e)}disconnectedCallback(){this.subscription()}}customElements.define("kontokorrent-page",q)}])]);
//# sourceMappingURL=1.26cd8be44ba2cfc8c1fa.bundle.js.map