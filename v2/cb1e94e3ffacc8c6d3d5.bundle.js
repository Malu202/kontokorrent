"use strict";(self.webpackChunkkontokorrent=self.webpackChunkkontokorrent||[]).push([[426],{2824:function(e,t,n){n.r(t),n.d(t,{KontokorrentNichtGefunden:function(){return a}}),n(3948),n(285);var o=n(6047),r=n(9773),i=n(2639),s=n(6604);class a extends HTMLElement{constructor(){super(),this.rendered=!1}addServices(e){this.store=e.store,this.routingActionCreator=(0,r.b)(e),this.kontokorrentHinzufuegenActionCreator=(0,s.Jj)(e),this.serviceLocator=e}connectedCallback(){if(!this.rendered){this.rendered=!0,this.innerHTML='<app-bar></app-bar> <div class="kontokorrent-hinzufuegen-section"> Möchtest du den öffentlichen Kontokorrent zur Liste deiner Kontokorrents <strong><span id="oeffentlicher-name"></span></strong> hinzufügen? </div> <div class="kontokorrent-hinzufuegen-section"> <div id="notFoundError" class="alert alert--error" style="display:none">Kontokorrent wurde nicht gefunden</div> <button class="button button--raised" id="hinzufuegen-btn"> hinzufügen </button> </div> <div class="hinzufuegen__progress" id="hinzufuegen__progress"> <span class="spinner"></span> <span>wird hinzugefügt</span> </div>',this.oeffentlicherKontokorrentLabel=this.querySelector("#oeffentlicher-name"),this.hinzufuegenBtn=this.querySelector("#hinzufuegen-btn"),this.notFoundError=this.querySelector("#notFoundError"),this.processing=this.querySelector("#hinzufuegen__progress"),this.appBar=this.querySelector(i.W),this.appBar.addServices(this.serviceLocator);let e=new URLSearchParams(window.location.search);e.has(o.Cc)&&(this.oeffentlicherName=e.get(o.Cc).toLowerCase(),this.oeffentlicherKontokorrentLabel.innerText=this.oeffentlicherName)}this.appBar.addEventListener("gotokontokorrent",(async e=>{await this.routingActionCreator.navigateKontokorrentById(e.detail)})),this.hinzufuegenClickListener=()=>this.hinzufuegen(),this.hinzufuegenBtn.addEventListener("click",this.hinzufuegenClickListener),this.subscription=this.store.subscribe(null,(e=>this.applyStoreState(e))),this.applyStoreState(this.store.state),this.kontokorrentHinzufuegenActionCreator.nichtGefundenPageGeoeffnet()}async hinzufuegen(){let e=await this.kontokorrentHinzufuegenActionCreator.kontokorrentHinzufuegen(this.oeffentlicherName);e&&await this.routingActionCreator.navigateKontokorrentById(e)}applyStoreState(e){this.notFoundError.style.display=!e.kontokorrents.hinzufuegen&&e.kontokorrents.hinzufuegenFailed&&e.kontokorrents.hinzufuegenFailed.kontokorrentNotFound?"block":"none";let t=e.kontokorrents.hinzufuegen||e.account.accountCreating;this.processing.style.display=t?"flex":"none",this.hinzufuegenBtn.style.display=t?"none":"inline-flex"}disconnectedCallback(){this.subscription(),this.hinzufuegenBtn.removeEventListener("click",this.hinzufuegenClickListener)}}customElements.define("kontokorrent-nicht-gefunden",a)},6604:function(e,t,n){n.d(t,{Jj:function(){return f}});var o=n(886);class r{constructor(e){this.exists=e,this.type=7}}class i{constructor(){this.type=8}}class s{constructor(e){this.kontokorrent=e,this.type=21}}class a{constructor(e){this.notFound=e,this.type=9}}class h{constructor(){this.type=10}}class c{constructor(e){this.kontokorrents=e,this.type=20}}class u{constructor(){this.type=18}}class l{constructor(){this.type=37}}class d{constructor(e,t,n){this.store=e,this.apiClient=t,this.db=n}loginPageGeoeffnet(){this.store.dispatch(new u)}nichtGefundenPageGeoeffnet(){this.store.dispatch(new l)}async kontokorrentErstellen(e,t,n,a){let h={name:t,id:e,oeffentlicherName:n,personen:a.map((e=>({name:e,id:(0,o.Z)()})))};this.store.dispatch(new i);let c=await this.apiClient.neuerKontokorrent(h);return c.success?(await this.db.addKontokorrent({id:e,name:t,personen:h.personen,oeffentlicherName:n}),this.store.dispatch(new s({id:e,name:t,personen:h.personen,oeffentlicherName:n})),!0):(this.store.dispatch(new r(c.exists)),!1)}async kontokorrentHinzufuegen(e){let t=await this.db.getPerOeffentlichName(e);if(null!=t)return t.id;this.store.dispatch(new h);try{let t=await this.apiClient.kontokorrentHinzufuegen(e,null);if(null!=t){let e=await this.db.setKontokorrents(t.map((e=>({id:e.id,name:e.name,personen:e.personen,oeffentlicherName:e.oeffentlicherName}))));return this.store.dispatch(new c(t)),e[0]}this.store.dispatch(new a(!0))}catch(e){this.store.dispatch(new a(!1))}return!1}}function f(e){return e.get("KontokorrentHinzufuegenActionCreator",(e=>new d(e.store,e.apiClient,e.db)))}}}]);
//# sourceMappingURL=cb1e94e3ffacc8c6d3d5.bundle.js.map